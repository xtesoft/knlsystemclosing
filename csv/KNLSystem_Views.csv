"schema_name","view_name","created","last_modified","definition","comments"
dbo,ACO_APPROVED_CONTRIBUTIONS_VW,2010-06-12 14:53:01.147,2012-06-30 11:17:28.473,"CREATE VIEW [dbo].[ACO_APPROVED_CONTRIBUTIONS_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    CASE WHEN SUM(a.programmed_amount) > sum(a.kna_disbursed) THEN SUM(a.programmed_amount) ELSE sum(a.kna_disbursed) END as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT
			kna.kna_id,
			kna.ops_id_opus,
			kna.kna_approved_amount AS kna_amount,
            (select sum(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY and AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_DELETED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 1 union all select sum(debit_amount) - sum(credit_amount) as total_amount from (select  sum (bio.bio_item_cost) as debit_amount, 0 as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_DEBIT' and bio.yea_id_year = knp.yea_year union select  0 as debit_amount, sum (bio.bio_item_cost) as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_CREDIT' and bio.yea_id_year = knp.yea_year ) as a UNION ALL select max(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (  select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE UNION ALL   select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_LATEST' and  out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE ) as A group by A.OUT_ID_OUTCOME ) as B) as programmed_Amount,
            (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed
		FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'CON' AND
			kna.kna_deleted_date IS NULL AND
            kpd.kpd_deleted_date is null AND
			kna.kna_approved_flag = 1 AND
			knp.yea_year = YEAR(GETDATE()) AND
			knp.dep_id_department NOT IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,ACT_ACTIVITIES_VW,2010-07-16 20:18:43.330,2020-11-04 16:47:31.333,"CREATE VIEW [dbo].[ACT_ACTIVITIES_VW] AS 
select kna.kna_id as activityID,  
    (select sec.sec_id from Unt_Unit_tb unt2, Dep_Department_tb dep, Sec_Section_tb sec where unt2.unt_id = knd.unt_id_unit and dep.dep_id = unt2.dep_id_department and sec.sec_id = dep.sec_id_section) as secId,
    (select sec.sec_name from Unt_Unit_tb unt2, Dep_Department_tb dep, Sec_Section_tb sec where unt2.unt_id = knd.unt_id_unit and dep.dep_id = unt2.dep_id_department and sec.sec_id = dep.sec_id_section) as secName,
    (select dep.dep_name from Unt_Unit_tb unt2, Dep_Department_tb dep where unt2.unt_id = knd.unt_id_unit and dep.dep_id = unt2.dep_id_department) as depName,
    (select dep.dep_id from Unt_Unit_tb unt2, Dep_Department_tb dep where unt2.unt_id = knd.unt_id_unit and dep.dep_id = unt2.dep_id_department) as depId,
    (select unt.unt_name from Unt_Unit_tb unt where unt.unt_id = knd.unt_id_unit) as unit,
    (select unt.unt_id from Unt_Unit_tb unt where unt.unt_id = knd.unt_id_unit) as unitId,
    knp.yea_year,
    (select tal.tal_description from Tal_Taxonomy_Language_tb tal where tal.tax_id = kpd.tax_id_type and tal.lng_id = 1) as componentType,
    kpd.kpd_name as deliverableName,
    kna.kna_name as activityName,
    kna.kna_deliverables as activityOutputs,
    kna.kna_estimated_participant as activityParticipants,
    ops.ops_activity_code as activityBK,
    isNull(kna.kna_unit_amount,0) as unitAmount,
    isNull(kna.kna_knl_amount,0) as knlAmount,
    isNull(kna.kna_other_amount,0) as otherAmount,
    isNull(kna.kna_unit_amount,0) + isNull(kna.kna_knl_amount,0) + isNull(kna.kna_other_amount,0) as activityAmount,
    kna.kna_other_entity as otherEntity,
    dbo.getKNLOfficersByKnlActivity(kna.kna_id) as knlOfficer,
    (select count(*) from Out_Outcome_tb out, Aao_Available_Activity_Outcome_tb aao where aao.out_id_outcome = out.out_id and aao.kna_id_activity = kna.kna_id /*and out.out_deleted_flag = 0*/) as outputCount,
    isnull((select sum(sof.sof_amount)
    from Aao_Available_Activity_Outcome_tb aao,
        Out_Outcome_tb o,
        Sof_Source_Of_Funding_tb sof,
        Sac_Source_Of_Funding_Account_tb sac
    where aao.kna_id_activity = kna.kna_id
        and aao.out_id_outcome = o.out_id
        and o.out_id = sof.out_id_outcome
        and sof.sof_type = 'SOF_BY_ACCOUNT'
        --and sof.sof_deleted_flag = 0
        /*and o.out_deleted_flag = 0*/
        and sac.sof_id = sof.sof_id
        and sac.bou_id_budget_org_unit not in (select bou.bou_id from Bou_Budget_Org_Unit_tb bou where bou.bou_active_flag = 1 and bou.bou_name like 'KNL002%')),0) as unit_programmed_amount,
    cast((SELECT isNull(SUM(total_amount),0) AS total_amount   FROM   (  SELECT      isnull(SUM( CASE WHEN out.out_budget_officer_closed_flag = 1 THEN sof.sof_executed_amount ELSE sof.sof_amount END),0) AS total_amount       FROM      Sof_Source_Of_Funding_tb sof,      Sat_Source_Of_Funding_Activity_tb sat,      Out_Outcome_tb OUT      WHERE      sof.sof_id = sat.sof_id AND      sof.sof_deleted_flag = 0 AND      sof.out_id_outcome = OUT.out_id /*AND      OUT.out_deleted_flag = 0*/ AND      sat.kna_id_knl_administrative_plan = KNA.KNA_ID     UNION       ALL SELECT         SUM(a.debit_amount) - SUM(a.credit_amount) AS total_amount         FROM         ( SELECT           SUM (bio.bio_item_cost) AS debit_amount,           0                       AS credit_amount           FROM           Bio_Budget_Item_Obligated bio,           Bip_Budget_Item_Plan_Activity_tb bip           WHERE           bip.bio_id = bio.bio_id AND           bio.bio_deleted_date IS NULL AND           bio.bio_accounting_type = 'BIO_DEBIT' AND           bip.kna_id = KNA.KNA_ID          UNION           ALL SELECT             0                       AS debit_amount,             SUM (bio.bio_item_cost) AS credit_amount             FROM             Bio_Budget_Item_Obligated bio,             Bip_Budget_Item_Plan_Activity_tb bip             WHERE             bip.bio_id = bio.bio_id AND             bio.bio_deleted_date IS NULL AND             bio.bio_accounting_type = 'BIO_CREDIT' AND             bip.kna_id = KNA.KNA_ID         )         AS a    )   AS b) as decimal(15,2)) as latestTotalCostAmount,
    CAST((SELECT
			isnull(SUM( 
                    CASE 
                        WHEN OUT.out_budget_officer_closed_flag = 1 
                        THEN sof.sof_executed_amount 
                        ELSE sof.sof_amount 
                    END),0) AS total_amount 
		FROM
			Sof_Source_Of_Funding_tb sof,
			Sat_Source_Of_Funding_Activity_tb sat,
			Out_Outcome_tb OUT,
            Aao_Available_Activity_Outcome_tb aao
		WHERE
			sof.sof_id = sat.sof_id AND
            aao.out_id_outcome = OUT.out_id AND
            aao.kna_id_activity = sat.kna_id_knl_administrative_plan AND
			--sof.sof_deleted_flag = 0 AND
			sof.out_id_outcome = OUT.out_id AND
			/*OUT.out_deleted_flag = 0 AND*/
			sat.kna_id_knl_administrative_plan = KNA.KNA_ID) AS DECIMAL(15,5)) AS PROGRAMMED_ASSOCIATED,
    CAST((SELECT
			isnull(SUM( 
                    CASE 
                        WHEN OUT.out_budget_officer_closed_flag = 1 
                        THEN sof.sof_executed_amount 
                        ELSE sof.sof_amount 
                    END),0) AS total_amount 
		FROM
			Sof_Source_Of_Funding_tb sof,
			Sat_Source_Of_Funding_Activity_tb sat,
			Out_Outcome_tb OUT,
            Aao_Available_Activity_Outcome_tb aao
		WHERE
			sof.sof_id = sat.sof_id AND
            aao.out_id_outcome = OUT.out_id AND
            aao.kna_id_activity <> sat.kna_id_knl_administrative_plan AND
			--sof.sof_deleted_flag = 0 AND
			sof.out_id_outcome = OUT.out_id AND
			/*OUT.out_deleted_flag = 0 AND*/
			aao.kna_id_activity = KNA.KNA_ID) AS DECIMAL(15,5)) AS PROGRAMMED_FINANCED,
    CAST((SELECT
			SUM(a.debit_amount) - SUM(a.credit_amount) AS total_amount 
		FROM
		(	SELECT
				SUM (bio.bio_item_cost) AS debit_amount,
				0                       AS credit_amount 
			FROM
				Bio_Budget_Item_Obligated bio,
				Bip_Budget_Item_Plan_Activity_tb bip 
			WHERE
				bip.bio_id = bio.bio_id AND
				--bio.bio_deleted_date IS NULL AND
				bio.bio_accounting_type = 'BIO_DEBIT' AND
				bip.kna_id = KNA.KNA_ID 
			UNION ALL 
            SELECT
				0                       AS debit_amount,
				SUM (bio.bio_item_cost) AS credit_amount 
			FROM
				Bio_Budget_Item_Obligated bio,
                Bip_Budget_Item_Plan_Activity_tb bip 
			WHERE
				bip.bio_id = bio.bio_id AND
				--bio.bio_deleted_date IS NULL AND
				bio.bio_accounting_type = 'BIO_CREDIT' AND
				bip.kna_id = KNA.KNA_ID 
			)AS a) AS DECIMAL(15,2)) AS PROGRAMMED_CHARGES,
    cast((SELECT
			ISNULL(SUM(B.TOTAL_AMOUNT),0) AS TOTAL_AMOUNT 
		FROM
			(	SELECT SUM(SOF.sof_executed_amount) TOTAL_AMOUNT
				FROM Sof_Source_Of_Funding_tb SOF,
				    Sat_Source_Of_Funding_Activity_tb SAT,
                    Out_Outcome_tb o
				WHERE /*SOF.sof_deleted_flag = 0
				    AND */SAT.sof_id = SOF.sof_id
                    AND O.OUT_ID = SOF.OUT_ID_OUTCOME
                    /*AND O.OUT_DELETED_FLAG = 0*/
				    AND SAT.kna_id_knl_administrative_plan = kna.kna_id 
					
		UNION ALL
		SELECT
			SUM(A.DEBIT_AMOUNT) - SUM(A.CREDIT_AMOUNT) AS TOTAL_AMOUNT 
		FROM
			(	SELECT
					SUM (BIO.BIO_ITEM_COST) AS DEBIT_AMOUNT,
					0                       AS CREDIT_AMOUNT 
				FROM
					BIO_BUDGET_ITEM_OBLIGATED BIO,
					BIP_BUDGET_ITEM_PLAN_ACTIVITY_TB BIP 
				WHERE
					BIP.BIO_ID = BIO.BIO_ID AND
					--BIO.BIO_DELETED_DATE IS NULL AND
					BIO.BIO_ACCOUNTING_TYPE = 'BIO_DEBIT' AND
					BIP.KNA_ID = kna.kna_id
				UNION ALL
		        SELECT
		            0                       AS DEBIT_AMOUNT,
		            SUM (BIO.BIO_ITEM_COST) AS CREDIT_AMOUNT 
		        FROM
		            BIO_BUDGET_ITEM_OBLIGATED BIO,
		            BIP_BUDGET_ITEM_PLAN_ACTIVITY_TB BIP 
		        WHERE
		            BIP.BIO_ID = BIO.BIO_ID AND
		            --BIO.BIO_DELETED_DATE IS NULL AND
		            BIO.BIO_ACCOUNTING_TYPE = 'BIO_CREDIT' AND
		            BIP.KNA_ID = kna.kna_id
		        ) AS A 
			) AS B) as decimal(15,2)) as disbursedAmount,
        cast((SELECT
			ISNULL(SUM(B.TOTAL_AMOUNT),0) AS TOTAL_AMOUNT 
		FROM
			(	SELECT
			SUM(A.DEBIT_AMOUNT) - SUM(A.CREDIT_AMOUNT) AS TOTAL_AMOUNT 
		FROM
			(	
                select 0 AS DEBIT_AMOUNT, SUM(BIO.bio_item_cost) AS CREDIT_AMOUNT
                from Aao_Available_Activity_Outcome_tb aao,
                    Out_Outcome_tb O,
                    Obg_Outcome_Budget_tb obg,
                    Obc_Outcome_Budget_Category_tb obc,
                    Boo_Budget_Item_Operational boo,
                    Bio_Budget_Item_Obligated bio
                where aao.out_id_outcome = obg.out_id_outcome
                    AND AAO.out_id_outcome = o.out_id
                    and obg.obg_id = obc.obg_id_outcome_budget
                    and obc.obc_id = boo.obc_id_outcome_budget_category
                    and bio.bio_id = boo.bio_id
                    and obg.obg_entry_type = 'OBG_EXECUTED'
                    and BIO.bio_accounting_type = 'BIO_CREDIT'
                    /*and o.out_deleted_flag = 0*/
                    --and bio.bio_deleted_date is null
                    and aao.kna_id_activity = kna.kna_id
                UNION all
                select SUM(BIO.bio_item_cost) AS DEBIT_AMOUNT, 0 AS CREDIT_AMOUNT
                from Aao_Available_Activity_Outcome_tb aao,
                    Out_Outcome_tb O,
                    Obg_Outcome_Budget_tb obg,
                    Obc_Outcome_Budget_Category_tb obc,
                    Boo_Budget_Item_Operational boo,
                    Bio_Budget_Item_Obligated bio
                where aao.out_id_outcome = obg.out_id_outcome
                    AND AAO.out_id_outcome = o.out_id
                    and obg.obg_id = obc.obg_id_outcome_budget
                    and obc.obc_id = boo.obc_id_outcome_budget_category
                    and bio.bio_id = boo.bio_id
                    and obg.obg_entry_type = 'OBG_EXECUTED'
                    and BIO.bio_accounting_type = 'BIO_DEBIT'
                    /*and o.out_deleted_flag = 0*/
                    --and bio.bio_deleted_date is null
                    and aao.kna_id_activity = kna.kna_id
               union all
               SELECT
					SUM (BIO.BIO_ITEM_COST) AS DEBIT_AMOUNT,
					0                       AS CREDIT_AMOUNT 
				FROM
					BIO_BUDGET_ITEM_OBLIGATED BIO,
					BIP_BUDGET_ITEM_PLAN_ACTIVITY_TB BIP 
				WHERE
					BIP.BIO_ID = BIO.BIO_ID AND
					--BIO.BIO_DELETED_DATE IS NULL AND
					BIO.BIO_ACCOUNTING_TYPE = 'BIO_DEBIT' AND
					BIP.KNA_ID = kna.kna_id
				UNION ALL
		        SELECT
		            0                       AS DEBIT_AMOUNT,
		            SUM (BIO.BIO_ITEM_COST) AS CREDIT_AMOUNT 
		        FROM
		            BIO_BUDGET_ITEM_OBLIGATED BIO,
		            BIP_BUDGET_ITEM_PLAN_ACTIVITY_TB BIP 
		        WHERE
		            BIP.BIO_ID = BIO.BIO_ID AND
		            --BIO.BIO_DELETED_DATE IS NULL AND
		            BIO.BIO_ACCOUNTING_TYPE = 'BIO_CREDIT' AND
		            BIP.KNA_ID = kna.kna_id
            ) AS A 
			) AS B) as decimal(15,2)) as budgetItemsObligatedAmount,
        cast((SELECT
			ISNULL(SUM(B.TOTAL_AMOUNT),0) AS TOTAL_AMOUNT 
		FROM
			(	SELECT
			SUM(A.DEBIT_AMOUNT) - SUM(A.CREDIT_AMOUNT) AS TOTAL_AMOUNT 
		FROM
			(	
                select 0 AS DEBIT_AMOUNT, SUM(BIE.bie_item_cost) AS CREDIT_AMOUNT
                from Aao_Available_Activity_Outcome_tb aao,
                    Out_Outcome_tb O,
                    Obg_Outcome_Budget_tb obg,
                    Obc_Outcome_Budget_Category_tb obc,
                    Boo_Budget_Item_Operational boo,
                    Bio_Budget_Item_Obligated bio,
                    Bie_Budget_Item_Executed bie
                where aao.out_id_outcome = obg.out_id_outcome
                    AND AAO.out_id_outcome = o.out_id
                    and obg.obg_id = obc.obg_id_outcome_budget
                    and obc.obc_id = boo.obc_id_outcome_budget_category
                    and bio.bio_id = boo.bio_id
          			and bio.bio_id = bie.bio_id_budget_item_obligated
                    and obg.obg_entry_type = 'OBG_EXECUTED'
                    and BIE.bie_accounting_type = 'BIE_CREDIT'
                    /*and o.out_deleted_flag = 0*/
                    /*and bio.bio_deleted_date is null
                    and bie.bie_deleted_date is null*/
                    and aao.kna_id_activity = kna.kna_id
                UNION all
                select SUM(BIE.bie_item_cost) AS DEBIT_AMOUNT, 0 AS CREDIT_AMOUNT
                from Aao_Available_Activity_Outcome_tb aao,
                    Out_Outcome_tb O,
                    Obg_Outcome_Budget_tb obg,
                    Obc_Outcome_Budget_Category_tb obc,
                    Boo_Budget_Item_Operational boo,
                    Bio_Budget_Item_Obligated bio,
                    Bie_Budget_Item_Executed bie
                where aao.out_id_outcome = obg.out_id_outcome
                    AND AAO.out_id_outcome = o.out_id
                    and obg.obg_id = obc.obg_id_outcome_budget
                    and obc.obc_id = boo.obc_id_outcome_budget_category
                    and bio.bio_id = boo.bio_id
                    and bio.bio_id = bie.bio_id_budget_item_obligated
                    and obg.obg_entry_type = 'OBG_EXECUTED'
                    and BIE.bie_accounting_type = 'BIE_DEBIT'
                    /*and o.out_deleted_flag = 0*/
                    /*and bio.bio_deleted_date is null
                    and bie.bie_deleted_date is null*/
                    and aao.kna_id_activity = kna.kna_id
               union all
               SELECT
					SUM (BIe.BIe_ITEM_COST) AS DEBIT_AMOUNT,
					0                       AS CREDIT_AMOUNT 
				FROM
					BIO_BUDGET_ITEM_OBLIGATED BIO,
                    Bie_Budget_Item_Executed bie,
					BIP_BUDGET_ITEM_PLAN_ACTIVITY_TB BIP 
				WHERE
					BIP.BIO_ID = BIO.BIO_ID AND
					bio.bio_id = bie.bio_id_budget_item_obligated AND
                    /*BIO.BIO_DELETED_DATE IS NULL AND
                    bie.bie_deleted_date is null AND*/
					BIE.bie_accounting_type = 'BIE_DEBIT' AND
					BIP.KNA_ID = kna.kna_id
				UNION ALL
		        SELECT
		            0                       AS DEBIT_AMOUNT,
		            SUM (BIE.BIE_ITEM_COST) AS CREDIT_AMOUNT 
		        FROM
		            BIO_BUDGET_ITEM_OBLIGATED BIO,
		            Bie_Budget_Item_Executed bie,
					BIP_BUDGET_ITEM_PLAN_ACTIVITY_TB BIP 
		        WHERE
		            BIP.BIO_ID = BIO.BIO_ID AND
		            bio.bio_id = bie.bio_id_budget_item_obligated AND
                    /*BIO.BIO_DELETED_DATE IS NULL AND
		            bie.bie_deleted_date is null AND*/
					BIe.bie_accounting_type = 'BIE_CREDIT' AND
					BIP.KNA_ID = kna.kna_id
            ) AS A 
			) AS B) as decimal(15,2)) as budgetItemsExecutedAmount,
    CASE WHEN (select tal.tal_description from Tal_Taxonomy_Language_tb tal where tal.tax_id = kpd.tax_id_type and tal.lng_id = 1) <> 'Need' and kna.kna_knl_analisys_status = 'KNA_KNL_APPROVED' THEN 'KNL Approved' 
         WHEN (select tal.tal_description from Tal_Taxonomy_Language_tb tal where tal.tax_id = kpd.tax_id_type and tal.lng_id = 1) <> 'Need' and kna.kna_knl_analisys_status <> 'KNA_KNL_APPROVED' THEN 'KNL Pending Approval'
         ELSE '' 
    END as knlStatus,
    isNUll(kna.kna_approved_amount,0) as knlApprovedAmount,
    isNull((select tal.tal_description from Tal_Taxonomy_Language_tb tal where tal.tax_id = kna.tax_id_source_funding and tal.lng_id = 1),'--') as sourceOfFunding,
 (	SELECT
		CASE 
			WHEN tag.tag_code = 'NEE' AND
			kna.kna_selected_flag = 1 
			THEN 'Approved' 
			WHEN tag.tag_code = 'NEE' AND
			kna.kna_selected_flag = 0 
			THEN 'Pending Approval' 
			WHEN (tag.tag_code = 'CON' OR
			tag.tag_code = 'KCP') AND
			kna.kna_approved_flag = 1 
			THEN 'Approved' 
			WHEN (tag.tag_code = 'CON' OR
			tag.tag_code = 'KCP') AND
			kna.kna_approved_flag = 0 
			THEN 'Pending Approval' 
		END AS activity_status 
	FROM		
		Tag_Taxonomy_Group_tb tag
	WHERE  	
		tag.tax_id_group_header = kpd.tax_id_type 
)
AS activity_status,
isNull(
    (select sum(kai_amount) from Kpa_Knl_Plan_Allocation_tb kpa, Kai_Knl_Plan_Allocation_Item_tb kai
        where kai.kpa_id_allocation = kpa.kpa_id and
                kai.kai_active_flag = 1 and 
                kpa.yea_year = knp.yea_year and 
                kpa.dep_id_department = knp.dep_id_department) ,0) as departmentAllocatedFund,
knd.knd_id,
knp.knp_id,
kpd.kpd_id,
(SELECT tag.tag_code FROM Tag_Taxonomy_Group_tb tag WHERE  tag.tax_id_group_header = kpd.tax_id_type ) as kndType
from Kna_Knl_Plan_Activity_tb kna,
    Kpd_Knl_Plan_Deliverable_tb kpd,
    Knd_Knl_Plan_Division_tb knd,
    knp_knl_plan_department_tb knp,
    Ops_Opus_tb ops
where kna.kpd_id_deliverable = kpd.kpd_id
    and kpd.knd_id_division = knd.knd_id
    and knd.knp_id_plan_department = knp.knp_id
    and kna.ops_id_opus = ops.ops_id
    and knp.yea_year >=2010
    /*and kna.kna_deleted_date is null
    and kpd.kpd_deleted_date is null
    and kna.kna_selected_flag = 1*/",
dbo,ACT_ACTIVITIES_VW_2013,2013-07-25 13:03:28.370,2013-07-26 10:19:46.277,"CREATE VIEW [dbo].[ACT_ACTIVITIES_VW_2013]
AS 
SELECT [activityID], [yea_year],       [secName],        [depName],        [unit],        [componentType],
			       [deliverableName],       [activityBK],       [activity_status],       
			       [activityName],       [unitAmount], [knlAmount], [otherAmount], [activityAmount], 
			       [otherEntity],        [knlOfficer],        [outputCount], [latestTotalCostAmount], [disbursedAmount],
			       [knlStatus], [knlApprovedAmount], [sourceOfFunding],
				    PROGRAMMED_ASSOCIATED,
				    PROGRAMMED_FINANCED,
				    PROGRAMMED_CHARGES
			FROM ACT_ACTIVITIES_VW
			WHERE yea_year = 2013",
dbo,ADB_ADMINISTRATIVE_BUDGET_VW,2010-05-14 15:08:11.343,2020-11-19 10:41:38.110,"CREATE VIEW [dbo].[ADB_ADMINISTRATIVE_BUDGET_VW]
AS 
select 
    bio.bio_id as obligation_id,
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select top 1 per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select top 1 per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select top 1 ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    consultant_id =
    case 
     when (select top 1 usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select top 1 usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
    adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
    CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select top 1 per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select top 1 per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator, 
    --- EXECUTION
    bie.bie_id as execution_id,
    CASE 
        when bie.bie_accounting_type = 'BIE_CREDIT' then (bie.bie_item_cost * -1)
        else bie.bie_item_cost 
    END as execution_amount,
    bie.bie_invoice_date as execution_invoce_date,
    bie.bie_epay_flag as execution_epay_flag,
    bie.bie_description as execution_description,
    (select top 1 bip.kna_id from Bip_Budget_Item_Plan_Activity_tb bip where bip.bio_id  = bio.bio_id) as execution_plan_activity,
    (select top 1 dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as execution_plan_activity_department,
    (select top 1 unt.unt_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as execution_plan_activity_unit,
    (select top 1 case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'CON')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id = bio.bio_id) as execution_plan_activity_status,
    (select top 1 case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select  top 1 isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id  = bio.bio_id) as execution_plan_activity_approved_amount,
    CASE
        WHEN (select top 1 dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select top 1 tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal, Bip_Budget_Item_Plan_Activity_tb bip where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = bip.kna_id and bip.bio_id = bio.bio_id)
    END as execution_plan_activity_type,
    (select top 1 tal1.tal_description from Tal_Taxonomy_Language_tb tal1 where tal1.tax_id = bie.tax_id_classification) as execution_classification,
    bie.bie_entry_date as execution_entry_date,
    (select top 1 per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bie.per_id_creator) as execution_creator,
    bie.bie_last_updated_date as execution_last_updated_date,
    (select top 1 per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3 where per3.per_id = bie.per_id_updator) as execution_last_updator,
     bio.bio_lawson_date as lawson_date
from Bio_Budget_Item_Obligated bio left outer join  Bie_Budget_Item_Executed bie on bio.bio_id = bie.bio_id_budget_item_obligated,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type not in ('BIO_OPERATIONAL')
    /*and bio.bio_deleted_date is null
    and bie.bie_deleted_date is null*/;",
dbo,AKC_APPROVED_KCPS_VW,2010-06-12 14:54:00.427,2012-06-30 11:17:28.480,"CREATE VIEW [dbo].[AKC_APPROVED_KCPS_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    CASE WHEN SUM(a.programmed_amount) > sum(a.kna_disbursed) THEN SUM(a.programmed_amount) ELSE sum(a.kna_disbursed) END as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT
			kna.kna_id,
			kna.ops_id_opus,
			kna.kna_approved_amount AS kna_amount,
            (select sum(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY and AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_DELETED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 1 union all select sum(debit_amount) - sum(credit_amount) as total_amount from (select  sum (bio.bio_item_cost) as debit_amount, 0 as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_DEBIT' and bio.yea_id_year = knp.yea_year union select  0 as debit_amount, sum (bio.bio_item_cost) as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_CREDIT' and bio.yea_id_year = knp.yea_year ) as a UNION ALL select max(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (  select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE UNION ALL   select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_LATEST' and  out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE ) as A group by A.OUT_ID_OUTCOME ) as B) as programmed_Amount,
            (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed
		FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'KCP' AND
			kna.kna_deleted_date IS NULL AND
            kpd.kpd_deleted_date is null AND
			kna.kna_approved_flag = 1 AND
			knp.yea_year = YEAR(GETDATE()) AND
			knp.dep_id_department NOT IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,ALL_DEP_OUTPUTS_BASIC_INFO_VW ,2017-06-07 17:52:20.063,2017-06-07 17:52:20.063,"CREATE VIEW [dbo].[ALL_DEP_OUTPUTS_BASIC_INFO_VW ]
AS 
SELECT
	* 
FROM
	ALL_OUTPUTS_BASIC_INFO_VW 
WHERE
	OUTPUTID IN (	SELECT
						DISTINCT OUTPUTID 
					FROM
						DBO.DEP_ALL_REGISTRATIONS)",
dbo,ALL_LNG_OUTPUTS_BASIC_INFO_VW,2017-04-26 11:50:33.450,2017-06-05 10:24:23.347,"CREATE VIEW [dbo].[ALL_LNG_OUTPUTS_BASIC_INFO_VW ]
AS 
SELECT
	* 
FROM
	ALL_OUTPUTS_BASIC_INFO_VW 
WHERE
	OUTPUTID IN (	SELECT
						DISTINCT OUTPUTID 
					FROM
						DBO.LNG_LANGUAGE_ALL_REGISTRATIONS )",
dbo,ALL_OUTPUTS_BASIC_INFO_VW,2017-04-26 11:48:02.287,2017-11-28 14:51:30.860,"CREATE VIEW [dbo].[ALL_OUTPUTS_BASIC_INFO_VW]
AS 
SELECT
	OUT.OUT_ID                                                           AS 
	OUTPUTID,
	DBO.KNLPORTALSERVICES_GETOPSACTIVITYCODEBYOPSIDOPUS(OUT.OPS_ID_OPUS) AS 
	OPUSCODE ,
	DBO.KNLPORTALSERVICES_GETOPLDESCRIPTIONBYOPSIDANDLNGID(OUT.OPS_ID_OPUS,
	1)                                                                   AS 
	OPUSDESCRIPTION,
	DBO.KNLPORTALSERVICES_GETDURATIONBYOUTID(OUT.OUT_ID)                 AS 
	DURATION,
	DBO.KNLPORTALSERVICES_GETLANGUAGESBYOUTID(OUT.OUT_ID)                AS 
	LENGUAGES,
	DBO.KNLPORTALSERVICES_GETTARGETAUDIENCEBYOUTID(OUT.OUT_ID)           AS 
	TARGETAUDIENCE,
	DBO.KNLPORTALSERVICES_GETLOCDESCRIPTIONBYLOCID(OUT.LOC_ID_LOCATION)  AS 
	LOCATION,
	DBO.KNLPORTALSERVICES_GETLOCATIONCITYBYLOCID(OUT.LOC_ID_LOCATION)    AS CITY 
	,
	ISNULL(OUT.OUT_OBJECTIVES,'')                                        AS 
	OBJECTIVES,
	'KNA-'+ CAST(AAO.KNA_ID_ACTIVITY AS VARCHAR)                         AS 
	ACTIVITYCODE,
	DBO.KNLPORTALSERVICES_GETTOPICSBYOUTID(OUT.OUT_ID)                   AS 
	TOPICS 
FROM
	OUT_OUTCOME_TB OUT--,
    --AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO	 
    LEFT JOIN
    AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO ON OUT.out_id = AAO.out_id_outcome
WHERE
    --OUT.out_id = AAO.out_id_outcome AND
	OUT.OUT_DELETED_FLAG=0 AND
	OUT.OUT_DELETED_DATE IS NULL",
dbo,ANB_APPROVED_NEEDS_BWP_VW,2010-06-12 14:56:09.880,2012-06-30 11:17:28.490,"CREATE VIEW [dbo].[ANB_APPROVED_NEEDS_BWP_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    CASE WHEN SUM(a.programmed_amount) > sum(a.kna_disbursed) THEN SUM(a.programmed_amount) ELSE sum(a.kna_disbursed) END as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT kna.kna_id,
			   kna.ops_id_opus,
               (SELECT isNull((kna.kna_knl_percentage * SUM(kpb.kpb_item_cost))/100,0) FROM Kpb_Knl_Plan_Budget_tb kpb WHERE kpb.kna_id = kna.kna_id) AS kna_amount,
               (select sum(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY and AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_DELETED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 1 union all select sum(debit_amount) - sum(credit_amount) as total_amount from (select  sum (bio.bio_item_cost) as debit_amount, 0 as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_DEBIT' and bio.yea_id_year = knp.yea_year union select  0 as debit_amount, sum (bio.bio_item_cost) as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_CREDIT' and bio.yea_id_year = knp.yea_year ) as a UNION ALL select max(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (  select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE UNION ALL   select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_LATEST' and  out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE ) as A group by A.OUT_ID_OUTCOME ) as B) as programmed_Amount,
               (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed		
        FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'NEE' AND
			kna.kna_deleted_date IS NULL AND
            kpd.kpd_deleted_date is null AND
			kna.kna_selected_flag = 1 AND
			knp.yea_year = YEAR(GETDATE()) AND
			knp.dep_id_department IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,ANE_APPROVED_NEEDS_VW,2010-06-12 14:50:41.233,2012-06-30 11:17:28.470,"CREATE VIEW [dbo].[ANE_APPROVED_NEEDS_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    CASE WHEN SUM(a.programmed_amount) > sum(a.kna_disbursed) THEN SUM(a.programmed_amount) ELSE sum(a.kna_disbursed) END as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT kna.kna_id,
			   kna.ops_id_opus,
               (select sum(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY and AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_DELETED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 1 union all select sum(debit_amount) - sum(credit_amount) as total_amount from (select  sum (bio.bio_item_cost) as debit_amount, 0 as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_DEBIT' and bio.yea_id_year = knp.yea_year union select  0 as debit_amount, sum (bio.bio_item_cost) as credit_amount from Bio_Budget_Item_Obligated bio, Bip_Budget_Item_Plan_Activity_tb bip where  bip.bio_id = bio.bio_id and bip.kna_id = kna.kna_id and bio.bio_deleted_date is null and bio.bio_accounting_type = 'BIO_CREDIT' and bio.yea_id_year = knp.yea_year ) as a UNION ALL select max(TOTAL_AMOUNT) as TOTAL_AMOUNT FROM (  select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and OBG.OBG_ENTRY_TYPE = 'OBG_EXECUTED' and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE UNION ALL   select ISNULL(sum(OBG.OBG_KNL_AMOUNT), 0) as TOTAL_AMOUNT, OBG.OUT_ID_OUTCOME, OBG.OBG_ENTRY_TYPE from OBG_OUTCOME_BUDGET_TB OBG, OUT_OUTCOME_TB out, AAO_AVAILABLE_ACTIVITY_OUTCOME_TB AAO where KNA.KNA_ID = AAO.KNA_ID_ACTIVITY AND AAO.OUT_ID_OUTCOME = out.OUT_ID AND out.OUT_ID = OBG.OUT_ID_OUTCOME and out.OUT_BUDGET_OFFICER_CLOSED_FLAG = 0 and OBG.OBG_ENTRY_TYPE = 'OBG_LATEST' and  out.OUT_DELETED_FLAG = 0 group by OBG.OUT_ID_OUTCOME, OBG_ENTRY_TYPE ) as A group by A.OUT_ID_OUTCOME ) as B) as programmed_Amount,
               (SELECT isNull((kna.kna_knl_percentage * SUM(kpb.kpb_item_cost))/100,0) FROM Kpb_Knl_Plan_Budget_tb kpb WHERE kpb.kna_id = kna.kna_id) AS kna_amount,
               (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed		
        FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'NEE' AND
            kpd.kpd_deleted_date is null AND
			kna.kna_deleted_date IS NULL AND
			kna.kna_selected_flag = 1 AND
			knp.yea_year = YEAR(GETDATE()) AND
			knp.dep_id_department NOT IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,AOB_ADMINISTRATIVE_OBLIGATED_BUDGET_VW,2010-05-21 15:20:15.183,2012-06-30 11:17:28.320,"CREATE VIEW [dbo].[AOB_ADMINISTRATIVE_OBLIGATED_BUDGET_VW]
AS 
select 
    bio.bio_id as obligation_id,
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
	consultant_id =
    case 
     when (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
    adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
    CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator,
    (select bip.kna_id from Bip_Budget_Item_Plan_Activity_tb bip where bip.bio_id  = bio.bio_id) as obligation_plan_activity,
    (select dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as obligation_plan_activity_department,
    (select unt.unt_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as obligation_plan_activity_unit,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id = bio.bio_id) as obligation_plan_activity_status,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id  = bio.bio_id) as obligation_plan_activity_approved_amount,
    CASE
        WHEN (select dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal, Bip_Budget_Item_Plan_Activity_tb bip where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = bip.kna_id and bip.bio_id = bio.bio_id)
    END as obligation_plan_activity_type,
     bio.bio_lawson_date as lawson_date
from Bio_Budget_Item_Obligated bio,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type not in ('BIO_OPERATIONAL')
    and bio.bio_deleted_date is null",
dbo,BEE_BUD_E_EXECUTION_2014_VW,2015-11-06 10:40:25.427,2015-11-06 10:40:25.427,"CREATE VIEW [dbo].[BEE_BUD_E_EXECUTION_2014_VW]
AS 
select *    
from BUD_BUDE_INFORMATION_VW b left outer join EXC_EXECUTION_VW e on b.bud_id = e.bud_e_id
where b.yea_year in (year(getDate()), year(getDate())-1)",
dbo,BFH_BALANCE_FHL_VW,2012-11-16 11:36:31.947,2013-01-07 11:18:55.940,"CREATE VIEW [dbo].[BFH_BALANCE_FHL_VW]
AS 
select o.obligation_year as YEAR, o.obligation_org_unit_code AS ORG_UNIT, o.obligation_opus_code AS OPUS_CODE,
    '('+o.obligation_account_code+') '+o.obligation_account_name as ACCOUNT,
    o.obligation_vendor as VENDOR,
    o.obligation_description as DESCRIPTION,
    DATENAME(month, o.obligation_entry_date) as MONTH,
    COUNT(*) AS BUDGET_LINES,
    SUM(O.obligation_amount) - SUM(O.executed_amount) as BALANCE
from OBL_OBLIGATED_VW o
where o.obligation_org_unit_code IN ('KNLFHL-KNX','KNLFHL-ADS','KNLFHL-ITM')    
group by o.obligation_year,o.obligation_org_unit_code, o.obligation_opus_code, '('+o.obligation_account_code+') '+o.obligation_account_name, o.obligation_vendor,o.obligation_description, DATENAME(month, o.obligation_entry_date)",
dbo,BIR_BUDGET_ITEM_OUTPUT_RELATION_VW,2010-07-19 18:27:05.250,2012-06-30 11:17:28.660,"CREATE VIEW [dbo].[BIR_BUDGET_ITEM_OUTPUT_RELATION_VW]
AS 
SELECT A.BIO_ID,
    A.OUT_ID,
    A.KNA_ID,
    A.OUT_NAME,
    A.BIO_ENTRY_DATE,
    A.BIO_ITEM_COST,
    A.BIE_ITEM_COST,
    A.BIO_ITEM_COST - A.BIE_ITEM_COST AS BALANCE,
    A.obligation_vendor,
    A.BIO_DESCRIPTION,
    A.YEA_ID_YEAR,
    A.ADC_CODE,
    A.BOU_CODE,
    A.OPS_ACTIVITY_CODE,
    A.BIO_ITEM_TYPE,
    A.BIO_ITEM_TYPE_VALUE
FROM(
select bio.bio_id,
    out.out_id,
    isNull((select aao.kna_id_activity from Aao_Available_Activity_Outcome_tb aao where aao.out_id_outcome = out.out_id),0) as kna_id,
    out.out_name,
    bio.bio_entry_date,
    bio.yea_id_year,
    CASE WHEN bio.bio_accounting_type = 'BIO_CREDIT' then bio.bio_item_cost * (-1) else bio.bio_item_cost end as bio_item_cost,
    (select isNull(sum(CASE WHEN bie.bie_accounting_type = 'BIE_CREDIT' then bie.bie_item_cost * (-1) else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie where bie.bio_id_budget_item_obligated = bio.bio_id and bie.bie_deleted_date is null) as bie_item_cost,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    bio.bio_description,
    adc.adc_code,
    bou.bou_code,
    ops.ops_activity_code,
    bio.bio_item_type,
    bio.bio_item_type_value
from Bio_Budget_Item_Obligated bio,
    Boo_Budget_Item_Operational boo,
    Obc_Outcome_Budget_Category_tb obc,
    Obg_Outcome_Budget_tb obg,
    Out_Outcome_tb out,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops
where bio.bio_id = boo.bio_id
    and ops.ops_id = bio.ops_id_opus
    and boo.obc_id_outcome_budget_category = obc.obc_id
    and obc.obg_id_outcome_budget = obg.obg_id
    and obg.out_id_outcome = out.out_id
    and bio.bio_deleted_date is null
    and adc.adc_id = bio.adc_id_administrative_account
    and bou.bou_id = bio.bou_id_budget_org_unit
UNION ALL
select bio.bio_id,
    0 as out_id,
    kna.kna_id,
    kna.kna_name,
    bio.bio_entry_date,
    bio.yea_id_year,
    CASE WHEN bio.bio_accounting_type = 'BIO_CREDIT' then bio.bio_item_cost * (-1) else bio.bio_item_cost end as bio_item_cost,
    (select isNull(sum(CASE WHEN bie.bie_accounting_type = 'BIE_CREDIT' then bie.bie_item_cost * (-1) else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie where bie.bio_id_budget_item_obligated = bio.bio_id and bie.bie_deleted_date is null) as bie_item_cost,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    bio.bio_description,
    adc.adc_code,
    bou.bou_code,
    ops2.ops_activity_code,
    bio.bio_item_type,
    bio.bio_item_type_value
from Bio_Budget_Item_Obligated bio,
    Bip_Budget_Item_Plan_Activity_tb bip,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Kna_Knl_Plan_Activity_tb kna,
    Ops_Opus_tb ops,
    Ops_Opus_tb ops2
where 
    ops2.ops_id = bio.ops_id_opus
    and bio.bio_deleted_date is null
    and adc.adc_id = bio.adc_id_administrative_account
    and bou.bou_id = bio.bou_id_budget_org_unit
    and ops.ops_id = kna.ops_id_opus
    and bip.bio_id = bio.bio_id
    and bip.kna_id = kna.kna_id) A",
dbo,BIR_BUDGET_ITEM_OUTPUT_RELATION_VW_2013,2013-03-18 15:31:27.410,2013-03-18 15:31:27.410,"CREATE VIEW [dbo].[BIR_BUDGET_ITEM_OUTPUT_RELATION_VW_2013]
AS 
SELECT A.BIO_ID,
    A.OUT_ID,
    A.KNA_ID,
    A.OUT_NAME,
    A.BIO_ENTRY_DATE,
    A.BIO_ITEM_COST,
    A.BIE_ITEM_COST,
    A.BIO_ITEM_COST - A.BIE_ITEM_COST AS BALANCE,
    A.obligation_vendor,
    A.BIO_DESCRIPTION,
    A.YEA_ID_YEAR,
    A.ADC_CODE,
    A.BOU_CODE,
    A.OPS_ACTIVITY_CODE,
    A.BIO_ITEM_TYPE,
    A.BIO_ITEM_TYPE_VALUE
FROM(
select bio.bio_id,
    out.out_id,
    isNull((select aao.kna_id_activity from Aao_Available_Activity_Outcome_tb aao where aao.out_id_outcome = out.out_id),0) as kna_id,
    out.out_name,
    bio.bio_entry_date,
    bio.yea_id_year,
    CASE WHEN bio.bio_accounting_type = 'BIO_CREDIT' then bio.bio_item_cost * (-1) else bio.bio_item_cost end as bio_item_cost,
    (select isNull(sum(CASE WHEN bie.bie_accounting_type = 'BIE_CREDIT' then bie.bie_item_cost * (-1) else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie where bie.bio_id_budget_item_obligated = bio.bio_id and bie.bie_deleted_date is null) as bie_item_cost,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    bio.bio_description,
    adc.adc_code,
    bou.bou_code,
    ops.ops_activity_code,
    bio.bio_item_type,
    bio.bio_item_type_value
from Bio_Budget_Item_Obligated bio,
    Boo_Budget_Item_Operational boo,
    Obc_Outcome_Budget_Category_tb obc,
    Obg_Outcome_Budget_tb obg,
    Out_Outcome_tb out,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops
where bio.bio_id = boo.bio_id
    and ops.ops_id = bio.ops_id_opus
    and boo.obc_id_outcome_budget_category = obc.obc_id
    and obc.obg_id_outcome_budget = obg.obg_id
    and obg.out_id_outcome = out.out_id
    and bio.bio_deleted_date is null
    and adc.adc_id = bio.adc_id_administrative_account
    and bou.bou_id = bio.bou_id_budget_org_unit
    and bio.yea_id_year=2013
UNION ALL
select bio.bio_id,
    0 as out_id,
    kna.kna_id,
    kna.kna_name,
    bio.bio_entry_date,
    bio.yea_id_year,
    CASE WHEN bio.bio_accounting_type = 'BIO_CREDIT' then bio.bio_item_cost * (-1) else bio.bio_item_cost end as bio_item_cost,
    (select isNull(sum(CASE WHEN bie.bie_accounting_type = 'BIE_CREDIT' then bie.bie_item_cost * (-1) else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie where bie.bio_id_budget_item_obligated = bio.bio_id and bie.bie_deleted_date is null) as bie_item_cost,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    bio.bio_description,
    adc.adc_code,
    bou.bou_code,
    ops2.ops_activity_code,
    bio.bio_item_type,
    bio.bio_item_type_value
from Bio_Budget_Item_Obligated bio,
    Bip_Budget_Item_Plan_Activity_tb bip,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Kna_Knl_Plan_Activity_tb kna,
    Ops_Opus_tb ops,
    Ops_Opus_tb ops2
where 
    ops2.ops_id = bio.ops_id_opus
    and bio.bio_deleted_date is null
    and bio.yea_id_year=2013
    and adc.adc_id = bio.adc_id_administrative_account
    and bou.bou_id = bio.bou_id_budget_org_unit
    and ops.ops_id = kna.ops_id_opus
    and bip.bio_id = bio.bio_id
    and bip.kna_id = kna.kna_id) A",
dbo,BPV_BUSINESS_PARTNERS_VW,2015-08-18 10:36:38.340,2015-08-18 14:22:38.793,"CREATE VIEW [dbo].[BPV_BUSINESS_PARTNERS_VW]
AS 
SELECT sec.sec_name, dep.dep_name, unt.unt_name, uap.unt_id, unt.unt_active_date,
    uap.contactName, uap.contactUserName, uap.contactUnit, uap.contactType
FROM Dep_Department_tb dep,
    Sec_Section_tb sec,
    Unt_Unit_tb unt left outer join 
        (select unt.unt_id,
            per.per_first_name + ' '+ isNull(per.per_middle_name,'') + ' ' + per.per_last_name as contactName, 
            usr.usr_pcmail as contactUserName, usr.usr_title as contactTitle, unt2.unt_name as contactUnit, 
            case when uap.uap_person_type = 0 then 'No Contact (Only KnlSystem Access)'
                 when uap.uap_person_type = 1 then 'Business Partner Senior'
                 when uap.uap_person_type = 2 then 'Business Partner Junior'
                 when uap.uap_person_type = 3 then 'Coordinator Contact 1'
                 when uap.uap_person_type = 4 then 'Coordinator Contact 2'
                 when uap.uap_person_type = 5 then 'Coordinator Contact (For more than two coordinators)'
            end as contactType
        from Uap_Unit_Assigned_Person_tb uap,
            Per_Person_tb per,
            Unt_Unit_tb unt,
            Usr_User_tb usr,
            Unt_Unit_tb unt2
        where uap.per_id_person = per.per_id
            and unt.unt_id = uap.unt_id
            and usr.per_id_person = per.per_id
            and unt2.unt_id = usr.unt_id_unit
            and uap.uap_active_flag = 1
            and uap.tax_id_type = 75
            and unt.unt_active_flag = 1
            and usr.usr_active_flag = 1) as uap on uap.unt_id = unt.unt_id
where unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    and unt.unt_active_flag = 1",
dbo,BUD_BUDE_INFORMATION_VW,2011-07-18 10:32:09.263,2015-12-01 10:41:07.947,"CREATE VIEW [dbo].[BUD_BUDE_INFORMATION_VW]
AS 
select bud.bud_id,
    bud.yea_year,
    bou.bou_code,
    ops.ops_activity_code,
    adc.adc_code,
    bud.bud_lawson_date,
    bud.bud_doc_type,
    bud.bud_accounting_type,
    bud.bud_amount,
    case when bud.bud_accounting_type = 'BUD_DEBIT' then bud.bud_amount else -1*bud.bud_amount end as bud_amount1,
    (SELECT isNull(SUM(case when bie.bie_accounting_type = 'BIE_DEBIT' then BIE.bie_item_cost else BIE.bie_item_cost* -1 end),0)  FROM Bie_Budget_Item_Executed BIE WHERE BIE.bud_e_id = bud.bud_id and bie.bie_deleted_date is null) as bud_executed,
    bud.bud_description,
    bud.bud_status,
    bud.bud_error_type,
    bud.bud_doc_num,
    bud.bud_invoice_description,
    bud.bud_for_fix_me,
    bud.bud_creation_date,
    bud.bud_update_date,
    per.per_first_name + ' ' + isnull(per.per_middle_name,'') + per.per_last_name as updator,
    bud.bud_comment,
    bud.bud_fnd,
    bud.bud_func_area,
    bud.bud_assigned_wbs_element,
    bud.bud_ref_doc_txt,
    bud.bud_vendor,
    bud.bud_vendor_number,
    bud.bud_ref_doc_txt2
from Bud_Bud_E_tb bud,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops,
    Per_Person_tb per
where bud.adc_id_account = adc.adc_id
    and bou.bou_id = bud.bou_id_budget_org_unit
    and ops.ops_id = bud.ops_id_opus
    and per.per_id = bud.per_updator_id",
dbo,CBV_CONSOLIDATED_BUDGET_VW,2010-11-09 15:23:20.463,2012-06-30 11:17:28.707,"CREATE VIEW [dbo].[CBV_CONSOLIDATED_BUDGET_VW]
AS 
SELECT
	-- IDS
    ACT.ACTIVITYID             AS KNA_ID,
	OUA.OUT_ID              AS OUT_ID,
	OBL.OBLIGATION_ID          AS BIO_ID,
	EXC.EXECUTION_ID           AS BIE_ID,

    -- BKS GROUPED
	ACT.ACTIVITYBK             AS KNA_OPUS_CODE,
	OUA.ACTIVITY_CODE          AS OUT_OPUS_CODE,
	OBL.OBLIGATION_OPUS_CODE   AS BIO_OPUS_CODE,   

	-- ACTIVITY INFORMATION
    ACT.DEPNAME,
	ACT.UNIT                   AS UNIT_NAME,
	ACT.YEA_YEAR               AS KNA_YEAR,
	ACT.COMPONENTTYPE,
	ACT.DELIVERABLENAME,
	ACT.ACTIVITYNAME           AS KNA_NAME,
	ACT.ACTIVITY_STATUS        AS KNA_STATUS,
    ACT.KNLSTATUS AS KNA_KNL_STATUS,
    ACT.KNLAPPROVEDAMOUNT AS KNA_KNL_APPROVED_AMOUNT,
	ACT.ACTIVITYPARTICIPANTS   AS KNA_PARTICIPANTS,
	ACT.ACTIVITYCOST           AS KNA_TOTAL_AMOUNT_APPROVED_BY_MANAGER,
	ACT.KNLPERCENTAGE          AS KNA_REQUESTED_AMOUNT_TO_KNL_FUND,
	ACT.EXECUTEDAMOUNT         AS KNA_PROGRAMMED_AMOUNT,
	ACT.DISBURSEDAMOUNT        AS KNA_DISBURSED_AMOUNT,
	ACT.ACTIVITYBK             AS KNA_OPUS_ACTIVITY_CODE,
	ACT.OUTPUTCOUNT,
	ACT.KNLOFFICER,
    -- OUTPUT INFORNMATION
    OUA.OUT_NAME,
    OUA.OUTPUT_TYPE AS OUT_TYPE,
    OUA.START_DATE AS OUT_START_DATE,
    OUA.END_DATE AS OUT_END_DATE,
	OUA.OUT_BUDGET_OFFICER_CLOSED_FLAG,	
    OUA.OBG_KNL_AMOUNT	AS OUT_REVISED_AMOUNT, 
    OUA.OBLIGATED_AMOUNT AS OUTPUT_PROGRAMMED_AMMOUNT,
	-- OBLIGATED INFORMATION
    OBL.OUTPUT_BUDGET_CATEGORY,
	OBL.OUTPUT_BUDGET_CATEGORY_AMOUNT,
    OBL.OBLIGATION_YEAR,
	OBL.OBLIGATION_ENTRY_TYPE,
	OBL.OBLIGATION_VENDOR,
	OBL.OBLIGATION_ACCOUNT_CODE,
	OBL.OBLIGATION_ACCOUNT_NAME,
	OBL.OBLIGATION_ORG_UNIT_CODE,
	OBL.OBLIGATION_DESCRIPTION,
	OBL.OBLIGATION_ITEM_TYPE,
	OBL.OBLIGATION_ITEM_VALUE,
	OBL.OBLIGATION_AMOUNT,
	OBL.OBLIGATION_ENTRY_DATE,
	OBL.OBLIGATION_CREATOR,
	OBL.OBLIGATION_LAST_UPDATED_DATE,
	OBL.CONSULTANT_ID,
	OBL.LAWSON_DATE,
    --- EXECUTED INFORMATION
	EXC.EXECUTION_CLASSIFICATION,
	EXC.EXECUTION_DESCRIPTION,
	EXC.EXECUTION_AMOUNT,
	EXC.EXECUTION_INVOCE_DATE,
	EXC.EXECUTION_EPAY_FLAG,
	EXC.EXECUTION_ENTRY_DATE,
	EXC.EXECUTION_CREATOR,
	EXC.EXECUTION_LAST_UPDATED_DATE,
	EXC.EXECUTION_LAST_UPDATOR 
FROM
	ACT_ACTIVITIES_VW ACT 
		LEFT OUTER  JOIN OUA_OUTCOME_ACTIVITY_VW OUA 
		ON ACT.ACTIVITYID = OUA.KNA_ID_ACTIVITY 
			LEFT OUTER  JOIN OBL_OBLIGATED_VW OBL 
			ON OUA.OUT_ID = OBL.OUTPUT_ID 
				LEFT OUTER JOIN EXC_EXECUTION_VW EXC 
				ON OBL.OBLIGATION_ID = EXC.OBLIGATION_ID
WHERE
	ACT.YEA_YEAR = YEAR(GETDATE())",
dbo,CMI_COURSE_METADATA_VIVISIMO_VW,2013-11-06 16:40:55.163,2013-12-10 13:57:00.343,"CREATE VIEW [dbo].[CMI_COURSE_METADATA_VIVISIMO_VW]
AS 
SELECT
	OUT.OUT_ID event_id,
	OUT.NAME event_name,
    omd.omd_course_description as event_description,
    lng.lng_description metadata_language,
    out.OPUS_CODE opus_code,
    out.OPUS_NAME opus_name,
    dbo.getTargetAudienceByOutcomeAndLanguage(out.OUT_ID,1) target_audience_english,
    dbo.getTargetAudienceByOutcomeAndLanguage(out.OUT_ID,2) target_audience_spanish,
    out.MOODLE_ID moodle_id,
    out.LOCATION_NAME location,
    out.LOCATION_TYPE location_type,
    dbo.getLanguagesByOutput(out.OUT_ID) event_languages,
	OUT.START_DATE start_date,
	OUT.END_DATE end_date,
	OUT.DEADLINE registration_deadline,
	OUT.MODALITY modality,
    out.PRIVATE_REGISTRATION private_event,
	omd.omd_abstract abstract,
	omd.omd_workload workload,
	omd.omd_cost_scholarship scholarship,
	dbo.udf_StripHTML(omd.omd_cost_scholarship) scholarship_plain,
	omd.omd_methodology methodology,
	dbo.udf_StripHTML(omd.omd_methodology) methodology_plain,
	omd.omd_course_edition course_edition,
	omd.omd_requirements requirements,
	dbo.udf_StripHTML(omd.omd_requirements) requirements_plain,
	OUT.OBJECTIVES objectives,
	omd.omd_course_modules course_modules,
	dbo.udf_StripHTML(omd.omd_course_modules) course_modules_plain,
	omd.omd_participant_profile participant_profile,
	dbo.udf_StripHTML(omd.omd_participant_profile) participant_profile_plain,
	omd.omd_enrollment_url enrollment_url,
	dbo.getFacilitatorsByOutputIdAndRole(OUT.OUT_ID,'RFT_COORDINATOR') AS coordinators,
    dbo.getFacilitatorsByOutputIdAndRole(OUT.OUT_ID,'RFT_INSTRUCTOR_TUTOR') AS teachers,
    dbo.getFacilitatorsByOutputIdAndRole(OUT.OUT_ID,'RFT_FACILITATOR') AS facilitators,
    dbo.getFacilitatorsByOutputIdAndRole(OUT.OUT_ID,'RFT_OBSERVER') AS observers,
    dbo.getFacilitatorsByOutputIdAndRole(OUT.OUT_ID,'RFT_SPEAKER') AS speakers,
	dbo.getFacilitatorsIDByOutputIdAndRole(OUT.OUT_ID,'RFT_COORDINATOR') AS coordinatorsID,
    dbo.getFacilitatorsIDByOutputIdAndRole(OUT.OUT_ID,'RFT_INSTRUCTOR_TUTOR') AS teachersID,
    dbo.getFacilitatorsIDByOutputIdAndRole(OUT.OUT_ID,'RFT_FACILITATOR') AS facilitatorsID,
    dbo.getFacilitatorsIDByOutputIdAndRole(OUT.OUT_ID,'RFT_OBSERVER') AS observersID,
    dbo.getFacilitatorsIDByOutputIdAndRole(OUT.OUT_ID,'RFT_SPEAKER') AS speakersID,
	dbo.getRelatedOutcomesByOutomeId(OUT.OUT_ID)                            AS events_related_ids,
    dbo.getRelatedOutcomesNamesByOutomeId(OUT.OUT_ID)                       AS events_related_names,
	dbo.getOutcomeMetadataProgramsByOutcomeId(OUT.OUT_ID,1)                 AS programs_english,
	dbo.getOutcomeMetadataProgramsByOutcomeId(OUT.OUT_ID,2)                 AS programs_spanish,
	dbo.getOutcomeMetadataTopicsByOutomeId(OUT.OUT_ID)                      AS topics,
    'http://indes.iadb.org/webservice/images/outcomeMetadataFiles/'+omd.omd_image_thumbnail as event_thumbnail,
    'http://indes.iadb.org/webservice/images/outcomeMetadataFiles/'+omd.omd_image_logo as event_logo,
dbo.getOutcomeMetadataProgramsPairsByOutcomeId(out.OUT_ID, 1, 2) as programs_pair
FROM
	OUT_OUTPUT_VW OUT,
	Omd_Output_Metadata_tb omd ,
    Lng_Language_tb lng
WHERE
	OUT.OUT_ID = omd.out_id AND
    omd.lng_id_language = lng.lng_id AND
	omd.omd_status = 'OMD_PUBLISHED'",
dbo,DAS_OUTPUTS_DASHBOARD_VW,2015-12-05 04:52:13.813,2015-12-05 05:03:17.500,"CREATE VIEW [dbo].[DAS_OUTPUTS_DASHBOARD_VW]
AS 
select  
    kna.kna_id,
    tax.tal_description,
    kna.kna_name,
    kpd.kpd_name,
    dep.dep_name,
    unt.unt_name,
    knp.yea_year,
    o.OUT_ID,
    o.NAME,
    o.OBJECTIVES,
    o.COMMENTS,
    o.MODALITY,
    o.PRESENTATION_TYPE,
    o.OPUS_CODE,
    o.OPUS_NAME,
    o.OUT_TYPE,
    o.LOCATION_CITY,
    o.START_DATE,
    o.END_DATE,
    MONTH(o.START_DATE) as OUT_START_DATE_MONTH,
    o.TOTAL_DURATION,
    (select count(*) from REG_REGISTRATIONS_VW R where R.out_id = O.OUT_ID) AS TOTAL_REGISTRATIONS,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_gender = 'F' AND R.out_id = O.OUT_ID) AS TOTAL_GENDER_FEMALE,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_gender = 'M' AND R.out_id = O.OUT_ID) AS TOTAL_GENDER_MALE,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_gender NOT IN ('M','F') AND R.out_id = O.OUT_ID) AS TOTAL_GENDER_OTHER,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_type = 'STAFF' AND R.out_id = O.OUT_ID) AS TOTAL_TYPE_STAFF,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_type = 'CWF' AND R.out_id = O.OUT_ID) AS TOTAL_TYPE_CWF,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_work_location = 'HQ' AND R.out_id = O.OUT_ID) AS TOTAL_LOCATION_HQ,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_work_location = 'COF' AND R.out_id = O.OUT_ID) AS TOTAL_LOCATION_COF,
    (select count(*) from REG_REGISTRATIONS_VW R where R.reg_type = 'EMPLOYEE' AND R.out_id = O.OUT_ID) AS TOTAL_CATEGORY_EMPLOYEE,
    (select count(*) from REG_REGISTRATIONS_VW R where R.reg_type = 'GUEST' AND R.out_id = O.OUT_ID) AS TOTAL_CATEGORY_GUEST,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_career_track = 'Management' AND R.out_id = O.OUT_ID) AS TOTAL_TRACK_MANAGEMENT,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_career_track = 'Executive' AND R.out_id = O.OUT_ID) AS TOTAL_TRACK_EXECUTIVE,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_career_track = 'Technical' AND R.out_id = O.OUT_ID) AS TOTAL_TRACK_TECHNICAL,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_career_track = 'Support' AND R.out_id = O.OUT_ID) AS TOTAL_TRACK_SUPPORT,
    (select count(*) from REG_REGISTRATIONS_VW R where R.emp_career_track not in  ('Management','Support','Technical','Executive','CWF') AND R.out_id = O.OUT_ID) AS TOTAL_TRACK_OTHER    
from Kna_Knl_Plan_Activity_tb kna,
    Kpd_Knl_Plan_Deliverable_tb kpd,
    Knd_Knl_Plan_Division_tb knd,
    Knp_Knl_Plan_Department_tb knp,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Aao_Available_Activity_Outcome_tb aao,
    ODT_OUTPUT_DETAIL_VW o,
    Tal_Taxonomy_Language_tb tax
where o.OUT_ID = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and tax.tax_id = kpd.tax_id_type   
    and tax.lng_id = 1
    and kna.kpd_id_deliverable = kpd.kpd_id
    and kpd.knd_id_division = knd.knd_id
    and knd.knp_id_plan_department = knp.knp_id
    and knd.unt_id_unit = unt.unt_id
    and knp.dep_id_department = dep.dep_id",
dbo,DAS_REGISTRATIONS_DASHBOARD_VW,2015-12-05 04:57:47.540,2015-12-05 05:03:03.787,"CREATE VIEW [dbo].[DAS_REGISTRATIONS_DASHBOARD_VW]
AS 
select  
    kna.kna_id,
    tax.tal_description,
    kna.kna_name,
    kpd.kpd_name,
    dep.dep_name,
    unt.unt_name,
    knp.yea_year,
    o.OUT_ID,
    o.NAME,
    o.OBJECTIVES,
    o.COMMENTS,
    o.MODALITY,
    o.PRESENTATION_TYPE,
    o.OPUS_CODE,
    o.OPUS_NAME,
    o.OUT_TYPE,
    o.LOCATION_CITY,
    o.START_DATE,
    o.END_DATE,
    o.TOTAL_DURATION,
    MONTH(o.START_DATE) as OUT_START_DATE_MONTH,
    R.REG_ID,
    R.EMP_FIRST_NAME,
    R.EMP_LAST_NAME,
    R.EMP_MIDDLE_NAME,
    R.EMP_TITLE,
    R.EMP_TYPE,
    R.EMP_GENDER,
    R.EMP_EMAIL,
    R.EMP_CAREER_TRACK,
    R.EMP_CAREER_PATH,
    R.EMP_WORK_ROLE,
    R.EMP_WORK_LOCATION,
    R.EMP_WORK_COUNTRY,
    R.EMP_UNIT,
    R.EMP_DEPARTMENT,
    R.EMP_SECTION,
    R.EMP_ACTIVE_FLAG,
    R.REG_TYPE,
    R.GUEST_INSTITUTION,
    R.GUEST_INSTITUTION_TYPE,
    R.GUEST_COUNTRY,
    R.REG_CREATED_DATE,
    R.REG_MONTH
from Kna_Knl_Plan_Activity_tb kna,
    Kpd_Knl_Plan_Deliverable_tb kpd,
    Knd_Knl_Plan_Division_tb knd,
    Knp_Knl_Plan_Department_tb knp,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Aao_Available_Activity_Outcome_tb aao,
    ODT_OUTPUT_DETAIL_VW o,
    Tal_Taxonomy_Language_tb tax,
    REG_REGISTRATIONS_VW R
where o.OUT_ID = aao.out_id_outcome
    AND R.OUT_ID = O.OUT_ID
    and aao.kna_id_activity = kna.kna_id
    and tax.tax_id = kpd.tax_id_type   
    and tax.lng_id = 1
    and kna.kpd_id_deliverable = kpd.kpd_id
    and kpd.knd_id_division = knd.knd_id
    and knd.knp_id_plan_department = knp.knp_id
    and knd.unt_id_unit = unt.unt_id
    and knp.dep_id_department = dep.dep_id
    AND KNP.YEA_YEAR IN (YEAR(GETDATE())-1, YEAR(GETDATE()))",
dbo,Data_EmployeesReport2014_2016_vw,2017-02-16 11:27:29.670,2017-02-16 11:27:29.670,"CREATE VIEW [dbo].[Data_EmployeesReport2014_2016_vw]
AS 
select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType, iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode, opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    evt.evt_start_date as eventStartDate, evt.evt_end_date as eventEndDate, year(evt.evt_end_date) as eventYear,
    evt.evt_total_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS,
    tal.tal_description as plan_component_type
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Evt_Event_tb evt,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Tax_Taxonomy_tb tax,
    KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb OPS,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Reu_Registration_User_tb reu,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
       -- and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = evt.out_id
    and aao.kna_id_activity = kna.kna_id   
    and o.ops_id_opus = ops.ops_id
    and kna.kpd_id_deliverable = kpd.kpd_id
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and kpd.tax_id_type = tax.tax_id
    and tax.tax_id = tal.tax_id 
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and reu.reg_id = r.reg_id
    and reu.usr_id = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0   
    and year(evt.evt_end_date) between 2014 and 2016
UNION ALL
select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType,iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode,  opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    srv.srv_start_date as eventStartDate, srv.srv_end_date as eventEndDate,year(srv.srv_end_date) as eventYear,
    srv.srv_total_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS,
     tal.tal_description as plan_component_type
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Srv_Service_tb srv,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Tax_Taxonomy_tb tax,
    KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb ops,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Reu_Registration_User_tb reu,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
      --  and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = srv.out_id
    and aao.kna_id_activity = kna.kna_id   
    and kna.kpd_id_deliverable = kpd.kpd_id
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and kpd.tax_id_type = tax.tax_id
    and tax.tax_id = tal.tax_id 
    and o.ops_id_opus = ops.ops_id
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and reu.reg_id = r.reg_id
    and reu.usr_id = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1   
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0
    and year(srv.srv_end_date) between 2014 and 2016
UNION ALL
select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType, iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode,  opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    srv.srv_start_date as eventStartDate, srv.srv_end_date as eventEndDate,year(srv.srv_end_date) as eventYear,
    rsl.rsl_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS,
     tal.tal_description as plan_component_type
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Srv_Service_tb srv,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb ops,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Tax_Taxonomy_tb tax,
    KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Rsl_Service_Individual_Language_tb rsl,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
     --   and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = srv.out_id
    and aao.kna_id_activity = kna.kna_id   
    and kna.kpd_id_deliverable = kpd.kpd_id
    and ops.ops_id = o.ops_id_opus
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and kpd.tax_id_type = tax.tax_id
    and tax.tax_id = tal.tax_id 
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and rsl.reg_id = r.reg_id
    and rsl.usr_id_user = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0  
    and year(srv.srv_end_date) between 2014 and 2016
UNION ALL
select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType, iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode,  opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    ext.ext_start_date as eventStartDate, ext.ext_end_date as eventEndDate, year(ext.ext_end_date) as eventYear,
    ext.ext_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS,
     tal.tal_description as plan_component_type
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Ext_External_Event_tb ext,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Tax_Taxonomy_tb tax,
    KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb OPS,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Reu_Registration_User_tb reu,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
     --   and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = ext.out_id
    and aao.kna_id_activity = kna.kna_id   
    and o.ops_id_opus = ops.ops_id
    and kna.kpd_id_deliverable = kpd.kpd_id
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and kpd.tax_id_type = tax.tax_id
    and tax.tax_id = tal.tax_id 
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and reu.reg_id = r.reg_id
    and reu.usr_id = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1   
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')--,'ICF'
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0
    and year(ext.ext_end_date) between 2014 and 2016",
dbo,Data_Registrations_2012_2014_vw,2015-04-15 17:40:50.613,2015-04-15 17:42:02.853,"CREATE VIEW [dbo].[Data_Registrations_2012_2013_vw]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.OUT_ID, a.NAME, a.OBJECTIVES, a.COMMENTS, a.MODALITY, a.PRESENTATION_TYPE, a.SUBJECT_TYPE, a.OPUS_CODE, a.OUT_CREATED_DATE, a.OUT_CREATOR, a.OUT_DELETED_DATE, a.OUT_DELETOR,
    a.PUBLISHED_DATE, a.OUT_TYPE, a.LOCATION_NAME, a.LOCATION_TYPE, a.LOCATION_CITY, a.LOCATION_COUNTRY, a.OUT_STATUS_CODE, a.BUDGET_STATUS_CODE, a.BUDGET_OFFICER_CLOSED_DATE,
    a.CLOSER, a.LOGISTICS_FLAG, a.START_DATE, DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS START_DATE_MONTH,
    a.END_DATE, DATENAME(month, case when a.END_DATE is null then a.OUT_CREATED_DATE else a.END_DATE end) AS END_DATE_MONTH,
    a.DEADLINE, a.MAX_PARTICIPANTS, a.PRIVATE_REGISTRATION, a.TOTAL_DURATION, 
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS DURATION_TYPE,
    a.ONLINE_FLAG, a.FLOW_CODE, a.TEACHER, a.MOODLE_ID, a.SERVICE_ACTIVE_FLAG,
    a.REG_ID, DATENAME(month,a.REG_CREATED_DATE) AS REGISTRATION_MONTH, a.REG_CREATED_DATE,
    a.REGISTRATOR, a.SHOWUP_FLAG, a.REG_DELETED_DATE, a.REG_DELETOR, a.PARTICIPATION_TYPE, a.REG_STATUS_CODE,
    a.FIRST_NAME, a.MIDDLE_NAME, a.LAST_NAME, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    a.EMAIL, a.PCMAIL, a.EMPLOYEE_ID, a.LEFT_DATE, a.EMPLOYEE_TYPE, a.CAREER_TRACK, a.CAREER_PATH, a.WORK_ROLE, a.WORK_LOCATION, a.WORK_COUNTRY,
    a.TITLE, a.SUPERVISOR, a.UNIT, a.DEPARTMENT, a.REG_TYPE,
    case when substring(a.UNIT,5,1) = 'C' and a.WORK_COUNTRY <> 'USA' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT,
    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT,
    (SELECT USR2.usr_title FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TITLE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P, Usr_User_tb USR2 WHERE P.per_id = USR2.per_id_supervisor AND USR2.USR_ID = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_SUPERVISOR,
    (SELECT USR2.usr_type FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TYPE,
    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_LOCATION,
    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'USA' ELSE USR2.USR_WORK_LOCATION END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_COUNTRY,
    (SELECT USR2.usr_career_track FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_TRACK,
    (SELECT USR2.usr_career_path FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_PATH,
    (SELECT USR2.usr_work_role FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_ROLE,
    1 as DATA_COUNT,
    MONTH(GETDATE()-2) AS DATA_MONTH,
    YEAR(GETDATE()) AS DATA_YEAR,
    GETDATE() AS DATA_CREATED_DATE,
    A.UNIT_ID,
    A.DEPT_ID,
    (SELECT dep.dep_id FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_dept_id,
    (SELECT unt.unt_id FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit_id,
    (SELECT DEP.dep_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT_ID,
    (SELECT UNT.unt_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT_ID,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = a.PCMAIL) as emp_gender
from (
-- GENERAL EVENTS - REG USERS
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
    AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- GENERAL EVENTS - GUESTS
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
    AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
-- LANGUAGE GROUP EVENTS - REG USERS 
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
    AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- MOODLE EVENTS - REG USERS
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
    AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- MOODLE EVENTS - GUESTS
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
    AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- EXTERNAL EVENTS - REG USERS
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL  AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
    AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    --AND R.OUT_ID IN (13615,13685,13992,14138)
UNION ALL
-- GENERAL SERVICE - REG USERS
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
     AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
     AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- MOODLE SERVICE - GENERAL USERS
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, o.MOODLE_ID AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
     AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
     AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- MOODLE SERVICE - GUEST
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, o.MOODLE_ID AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
     AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
     AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- COLLABORATIVE LEARNING - REG USER
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
     AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
     AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
UNION ALL
-- LANGUAGE SERVICE - REG USER
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2014 23:59:59'
    AND O.DELETED_DATE IS NULL
    AND O.DELETOR IS NULL
    AND R.DELETED_DATE IS NULL
    AND R.DELETOR IS NULL
    AND R.SHOWUP_FLAG = 1
    AND R.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    ) a",
dbo,Data_Registrations_2016_total_vw,2017-01-05 15:33:12.613,2017-01-23 12:03:41.800,"CREATE VIEW Data_Registrations_2016_total_vw
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_2016_tb r
where r.data_month = 12
    and r.data_year = 2016
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2016' and '12/31/2016 23:59:59'",
dbo,Data_Registrations_2016_vw,2016-06-30 15:06:29.280,2016-10-28 13:12:51.597,"CREATE VIEW [dbo].[Data_Registrations_2016_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 9
    and r.data_year = 2016
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2016' and '09/30/2016 23:59:59'",
dbo,Data_Registrations_2017_total_vw,2017-10-27 23:05:51.987,2018-01-05 11:14:03.650,"CREATE VIEW Data_Registrations_2017_total_vw AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 12
    and r.data_year = 2017
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2017 ' and '12/31/2017 23:59:59'",
dbo,Data_Registrations_30NOV15_vw,2015-12-03 14:41:57.897,2015-12-03 14:41:57.897,"CREATE VIEW [dbo].[Data_Registrations_30NOV15_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 11
    and r.data_year = 2015
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2015' and '11/30/2015 23:59:59'",
dbo,Data_Registrations_31DIC16_vw,2017-01-05 15:53:25.850,2017-01-05 16:44:08.117,"CREATE VIEW Data_Registrations_31DIC16_vw
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 12
    and r.data_year = 2016
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2016' and '12/31/2016 23:59:59'",
dbo,Data_Registrations_9DEC14_temp_vw,2014-12-09 09:49:27.553,2014-12-09 09:49:27.553,"CREATE VIEW [dbo].[Data_Registrations_9DEC14_temp_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 11 
    and r.data_year = 2014
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2014' and '12/31/2014 23:59:59'",
dbo,Data_Registrations_Qbr1_2014_temp_vw,2013-10-03 11:55:20.380,2014-07-02 12:15:18.183,"CREATE VIEW [dbo].[Data_Registrations_Qr1_2014_temp_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 3 
    and r.data_year = 2014
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2014' and '03/31/2014 23:59:59'",
dbo,Data_Registrations_Qbr1_2015_temp_vw,2015-04-10 17:39:11.793,2015-04-10 17:39:11.793,"CREATE VIEW [dbo].[Data_Registrations_Qbr1_2015_temp_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 3 
    and r.data_year = 2015
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2015' and '03/31/2015 23:59:59'",
dbo,Data_Registrations_Qbr1_2016_vw,2016-04-06 17:53:24.490,2016-04-06 17:53:24.490,"CREATE VIEW [dbo].[Data_Registrations_Qbr1_2016_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 3
    and r.data_year = 2016
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2016' and '03/31/2016 23:59:59'",
dbo,Data_Registrations_Qbr2_2014_temp_vw,2014-07-02 12:15:01.787,2014-07-02 12:15:01.787,"CREATE VIEW [dbo].[Data_Registrations_Qbr2_2014_temp_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 6 
    and r.data_year = 2014
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2014' and '06/30/2014 23:59:59'",
dbo,Data_Registrations_Qbr2_2015_vw,2015-06-16 09:38:36.103,2015-06-16 09:38:36.103,"CREATE VIEW [dbo].[Data_Registrations_Qbr2_2015_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 6 
    and r.data_year = 2015
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2015' and '06/30/2015 23:59:59'",
dbo,Data_Registrations_Qbr3_2014_temp_vw,2014-10-01 15:43:43.250,2014-10-01 15:43:43.250,"CREATE VIEW [dbo].[Data_Registrations_Qbr3_2014_temp_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 9 
    and r.data_year = 2014
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2014' and '09/30/2014 23:59:59'",
dbo,Data_Registrations_Qbr3_2015_vw,2015-10-08 18:42:12.237,2015-10-08 18:42:12.237,"CREATE VIEW [dbo].[Data_Registrations_Qbr3_2015_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 9
    and r.data_year = 2015
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2015' and '09/30/2015 23:59:59'",
dbo,Data_Registrations_Qbr4_2014_temp_vw,2015-01-08 16:32:16.027,2015-01-08 16:32:16.027,"CREATE VIEW [dbo].[Data_Registrations_Qbr4_2014_temp_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 12 
    and r.data_year = 2014
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2014' and '12/31/2014 23:59:59'",
dbo,Data_Registrations_Qbr4_2015_vw,2016-01-07 09:15:46.647,2016-01-07 09:15:46.647,"CREATE VIEW [dbo].[Data_Registrations_Qbr4_2015_vw]
AS 
SELECT *,
    (select top 1 p.per_gender from Usr_User_tb u, Per_Person_tb p where u.per_id_person = p.per_id and u.usr_pcmail = r.emp_pcmail) as emp_gender
FROM Data_Registrations_tb r
where r.data_month = 12
    and r.data_year = 2015
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2015' and '12/31/2015 23:59:59'",
dbo,Data_Registrations_real_vw,2016-06-30 15:15:13.263,2016-06-30 15:15:13.263,"CREATE VIEW [dbo].[Data_Registrations_real_vw]
AS 
select 
				AAO.kna_id_activity, act.depName, act.unit, act.yea_year, act.kpd_id,
			    act.componentType, act.deliverableName, act.activityName, 
			    a.OUT_ID, a.NAME, a.OBJECTIVES, a.COMMENTS, a.MODALITY, a.PRESENTATION_TYPE, a.SUBJECT_TYPE, a.OPUS_CODE, a.OUT_CREATED_DATE, a.OUT_CREATOR, a.OUT_DELETED_DATE, a.OUT_DELETOR,
			    a.PUBLISHED_DATE, a.OUT_TYPE, a.LOCATION_NAME, a.LOCATION_TYPE, a.LOCATION_CITY, a.LOCATION_COUNTRY, a.OUT_STATUS_CODE, a.BUDGET_STATUS_CODE, a.BUDGET_OFFICER_CLOSED_DATE,
			    a.CLOSER, a.LOGISTICS_FLAG, a.START_DATE, DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS START_DATE_MONTH,
			    a.END_DATE, DATENAME(month, case when a.END_DATE is null then a.OUT_CREATED_DATE else a.END_DATE end) AS END_DATE_MONTH,
			    a.DEADLINE, a.MAX_PARTICIPANTS, a.PRIVATE_REGISTRATION, a.TOTAL_DURATION, 
			    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
			         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
			         WHEN a.total_duration >=24 THEN '>= 24'
			    END AS DURATION_TYPE,
			    a.ONLINE_FLAG, a.FLOW_CODE, a.TEACHER, a.MOODLE_ID, a.SERVICE_ACTIVE_FLAG,
			    a.REG_ID, DATENAME(month,a.REG_CREATED_DATE) AS REGISTRATION_MONTH, a.REG_CREATED_DATE,
			    a.REGISTRATOR, a.SHOWUP_FLAG, a.REG_DELETED_DATE, a.REG_DELETOR, a.PARTICIPATION_TYPE, a.REG_STATUS_CODE,
			    a.FIRST_NAME, a.MIDDLE_NAME, a.LAST_NAME, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
			    a.EMAIL, a.PCMAIL, a.EMPLOYEE_ID, a.LEFT_DATE, a.EMPLOYEE_TYPE, a.CAREER_TRACK, a.CAREER_PATH, a.WORK_ROLE, a.WORK_LOCATION, a.WORK_COUNTRY,
			    a.TITLE, a.GUEST_INSTITUTION, a.GUEST_INSTITUTION_TYPE, a.GUEST_COUNTRY, a.SUPERVISOR, a.UNIT as EMPLOYEE_UNIT, a.DEPARTMENT, a.REG_TYPE,
			    case when substring(a.UNIT,5,1) = 'C' and a.WORK_COUNTRY <> 'USA' then substring(a.UNIT,6,2)
			         else a.WORK_COUNTRY 
			    END as COF_COUNTRY,
			    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT,
			    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT,
			    (SELECT USR2.usr_title FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TITLE,
			    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P, Usr_User_tb USR2 WHERE P.per_id = USR2.per_id_supervisor AND USR2.USR_ID = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_SUPERVISOR,
			    (SELECT USR2.usr_type FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TYPE,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_LOCATION,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'USA' ELSE USR2.USR_WORK_LOCATION END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_COUNTRY,
			    (SELECT USR2.usr_career_track FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_TRACK,
			    (SELECT USR2.usr_career_path FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_PATH,
			    (SELECT USR2.usr_work_role FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_ROLE,
			    A.UNIT_ID,
			    A.DEPT_ID,
			    act.depId  AS plan_dept_id,
			    act.unitId AS plan_unit_id,
			    (SELECT DEP.dep_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT_ID,
			    (SELECT UNT.unt_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT_ID
			from (
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE, R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_GUEST_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE,  R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE,  R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_GUEST_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, 
			    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_EXTERNAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R  
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_GENERAL_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_MOODLE_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
			    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_COLLABORATIVE_LEARNING_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_SERVICE_VW O,
			    REG_LANGUAGE_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = year(getDate())
				) a LEFT OUTER JOIN Aao_Available_Activity_Outcome_tb aao ON aao.out_id_outcome = a.OUT_ID LEFT OUTER JOIN ACT_ACTIVITIES_VW act ON act.activityID = aao.kna_id_activity",
dbo,Data_Registrations_real_vw_2016,2017-01-05 15:29:06.400,2017-01-05 15:29:06.400,"CREATE VIEW Data_Registrations_real_vw_2016
AS 
select 
				AAO.kna_id_activity, act.depName, act.unit, act.yea_year, act.kpd_id,
			    act.componentType, act.deliverableName, act.activityName, 
			    a.OUT_ID, a.NAME, a.OBJECTIVES, a.COMMENTS, a.MODALITY, a.PRESENTATION_TYPE, a.SUBJECT_TYPE, a.OPUS_CODE, a.OUT_CREATED_DATE, a.OUT_CREATOR, a.OUT_DELETED_DATE, a.OUT_DELETOR,
			    a.PUBLISHED_DATE, a.OUT_TYPE, a.LOCATION_NAME, a.LOCATION_TYPE, a.LOCATION_CITY, a.LOCATION_COUNTRY, a.OUT_STATUS_CODE, a.BUDGET_STATUS_CODE, a.BUDGET_OFFICER_CLOSED_DATE,
			    a.CLOSER, a.LOGISTICS_FLAG, a.START_DATE, DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS START_DATE_MONTH,
			    a.END_DATE, DATENAME(month, case when a.END_DATE is null then a.OUT_CREATED_DATE else a.END_DATE end) AS END_DATE_MONTH,
			    a.DEADLINE, a.MAX_PARTICIPANTS, a.PRIVATE_REGISTRATION, a.TOTAL_DURATION, 
			    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
			         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
			         WHEN a.total_duration >=24 THEN '>= 24'
			    END AS DURATION_TYPE,
			    a.ONLINE_FLAG, a.FLOW_CODE, a.TEACHER, a.MOODLE_ID, a.SERVICE_ACTIVE_FLAG,
			    a.REG_ID, DATENAME(month,a.REG_CREATED_DATE) AS REGISTRATION_MONTH, a.REG_CREATED_DATE,
			    a.REGISTRATOR, a.SHOWUP_FLAG, a.REG_DELETED_DATE, a.REG_DELETOR, a.PARTICIPATION_TYPE, a.REG_STATUS_CODE,
			    a.FIRST_NAME, a.MIDDLE_NAME, a.LAST_NAME, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
			    a.EMAIL, a.PCMAIL, a.EMPLOYEE_ID, a.LEFT_DATE, a.EMPLOYEE_TYPE, a.CAREER_TRACK, a.CAREER_PATH, a.WORK_ROLE, a.WORK_LOCATION, a.WORK_COUNTRY,
			    a.TITLE, a.GUEST_INSTITUTION, a.GUEST_INSTITUTION_TYPE, a.GUEST_COUNTRY, a.SUPERVISOR, a.UNIT as EMPLOYEE_UNIT, a.DEPARTMENT, a.REG_TYPE,
			    case when substring(a.UNIT,5,1) = 'C' and a.WORK_COUNTRY <> 'USA' then substring(a.UNIT,6,2)
			         else a.WORK_COUNTRY 
			    END as COF_COUNTRY,
			    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT,
			    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT,
			    (SELECT USR2.usr_title FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TITLE,
			    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P, Usr_User_tb USR2 WHERE P.per_id = USR2.per_id_supervisor AND USR2.USR_ID = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_SUPERVISOR,
			    (SELECT USR2.usr_type FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TYPE,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_LOCATION,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'USA' ELSE USR2.USR_WORK_LOCATION END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_COUNTRY,
			    (SELECT USR2.usr_career_track FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_TRACK,
			    (SELECT USR2.usr_career_path FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_PATH,
			    (SELECT USR2.usr_work_role FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_ROLE,
			    A.UNIT_ID,
			    A.DEPT_ID,
			    act.depId  AS plan_dept_id,
			    act.unitId AS plan_unit_id,
			    (SELECT DEP.dep_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT_ID,
			    (SELECT UNT.unt_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT_ID
			from (
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE, R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_GUEST_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE,  R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE,  R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_GUEST_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, 
			    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_EXTERNAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R  
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_GENERAL_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_MOODLE_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
			    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_COLLABORATIVE_LEARNING_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_SERVICE_VW O,
			    REG_LANGUAGE_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2016
				) a LEFT OUTER JOIN Aao_Available_Activity_Outcome_tb aao ON aao.out_id_outcome = a.OUT_ID LEFT OUTER JOIN ACT_ACTIVITIES_VW act ON act.activityID = aao.kna_id_activity",
dbo,Data_Registrations_real_vw_2017,2017-04-19 23:20:42.847,2017-04-19 23:20:42.847,"CREATE VIEW Data_Registrations_real_vw_2017
AS 
select 
				AAO.kna_id_activity, act.depName, act.unit, act.yea_year, act.kpd_id,
			    act.componentType, act.deliverableName, act.activityName, 
			    a.OUT_ID, a.NAME, a.OBJECTIVES, a.COMMENTS, a.MODALITY, a.PRESENTATION_TYPE, a.SUBJECT_TYPE, a.OPUS_CODE, a.OUT_CREATED_DATE, a.OUT_CREATOR, a.OUT_DELETED_DATE, a.OUT_DELETOR,
			    a.PUBLISHED_DATE, a.OUT_TYPE, a.LOCATION_NAME, a.LOCATION_TYPE, a.LOCATION_CITY, a.LOCATION_COUNTRY, a.OUT_STATUS_CODE, a.BUDGET_STATUS_CODE, a.BUDGET_OFFICER_CLOSED_DATE,
			    a.CLOSER, a.LOGISTICS_FLAG, a.START_DATE, DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS START_DATE_MONTH,
			    a.END_DATE, DATENAME(month, case when a.END_DATE is null then a.OUT_CREATED_DATE else a.END_DATE end) AS END_DATE_MONTH,
			    a.DEADLINE, a.MAX_PARTICIPANTS, a.PRIVATE_REGISTRATION, a.TOTAL_DURATION, 
			    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
			         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
			         WHEN a.total_duration >=24 THEN '>= 24'
			    END AS DURATION_TYPE,
			    a.ONLINE_FLAG, a.FLOW_CODE, a.TEACHER, a.MOODLE_ID, a.SERVICE_ACTIVE_FLAG,
			    a.REG_ID, DATENAME(month,a.REG_CREATED_DATE) AS REGISTRATION_MONTH, a.REG_CREATED_DATE,
			    a.REGISTRATOR, a.SHOWUP_FLAG, a.REG_DELETED_DATE, a.REG_DELETOR, a.PARTICIPATION_TYPE, a.REG_STATUS_CODE,
			    a.FIRST_NAME, a.MIDDLE_NAME, a.LAST_NAME, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
			    a.EMAIL, a.PCMAIL, a.EMPLOYEE_ID, a.LEFT_DATE, a.EMPLOYEE_TYPE, a.CAREER_TRACK, a.CAREER_PATH, a.WORK_ROLE, a.WORK_LOCATION, a.WORK_COUNTRY,
			    a.TITLE, a.GUEST_INSTITUTION, a.GUEST_INSTITUTION_TYPE, a.GUEST_COUNTRY, a.SUPERVISOR, a.UNIT as EMPLOYEE_UNIT, a.DEPARTMENT, a.REG_TYPE,
			    case when substring(a.UNIT,5,1) = 'C' and a.WORK_COUNTRY <> 'USA' then substring(a.UNIT,6,2)
			         else a.WORK_COUNTRY 
			    END as COF_COUNTRY,
			    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT,
			    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT,
			    (SELECT USR2.usr_title FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TITLE,
			    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P, Usr_User_tb USR2 WHERE P.per_id = USR2.per_id_supervisor AND USR2.USR_ID = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_SUPERVISOR,
			    (SELECT USR2.usr_type FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TYPE,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_LOCATION,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'USA' ELSE USR2.USR_WORK_LOCATION END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_COUNTRY,
			    (SELECT USR2.usr_career_track FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_TRACK,
			    (SELECT USR2.usr_career_path FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_PATH,
			    (SELECT USR2.usr_work_role FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_ROLE,
			    A.UNIT_ID,
			    A.DEPT_ID,
			    act.depId  AS plan_dept_id,
			    act.unitId AS plan_unit_id,
			    (SELECT DEP.dep_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT_ID,
			    (SELECT UNT.unt_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT_ID
			from (
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE, R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_GUEST_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE,  R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE,  R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_GUEST_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, 
			    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_EXTERNAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R  
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_GENERAL_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_MOODLE_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
			    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_COLLABORATIVE_LEARNING_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_SERVICE_VW O,
			    REG_LANGUAGE_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
				) a LEFT OUTER JOIN Aao_Available_Activity_Outcome_tb aao ON aao.out_id_outcome = a.OUT_ID LEFT OUTER JOIN ACT_ACTIVITIES_VW act ON act.activityID = aao.kna_id_activity",
dbo,Data_Regs_2016_duplicates_to_1012_vw,2016-10-28 11:21:40.680,2016-10-28 11:25:20.120,"CREATE VIEW [dbo].[Data_Regs_2016_duplicates_to_1012_vw]
AS 
SELECT distinct r.reg_id
FROM Data_Registrations_tb r
where 
        r.data_year = 2016
    and r.out_deleted_date is null
    and r.out_deletor is null
    and r.reg_deleted_date is null
    and r.reg_deletor is null
    and r.reg_showup_flag = 1
    and r.reg_status_code = 'REG_SUPERVISOR_APPROVED'
    and r.out_start_date between '01/01/2016' and '10/12/2016 23:59:59'",
dbo,DEP_ALL_REGISTRATIONS,2017-06-07 17:45:45.627,2017-06-07 17:45:45.627,"CREATE VIEW [dbo].[DEP_ALL_REGISTRATIONS]
AS 
select * from dbo.REU_ALL_EMPLOYEE_REGISTRATIONS where  SUBSTRING(employeeUnit ,1 , 3 ) = 'HRD'",
dbo,DRV_DIVISION_REVIEWERS_VW,2015-08-18 10:37:46.593,2015-08-18 14:23:13.720,"CREATE VIEW [dbo].[DRV_DIVISION_REVIEWERS_VW]
AS 
SELECT sec.sec_name, dep.dep_name, unt.unt_name, uap.unt_id, unt.unt_active_date,
    uap.contactName, uap.contactUserName, uap.contactUnit, uap.contactType
FROM Dep_Department_tb dep,
    Sec_Section_tb sec,
    Unt_Unit_tb unt left outer join 
        (select unt.unt_id,
            per.per_first_name + ' '+ isNull(per.per_middle_name,'') + ' ' + per.per_last_name as contactName, 
            usr.usr_pcmail as contactUserName, usr.usr_title as contactTitle, unt2.unt_name as contactUnit, 
            case when uap.uap_person_type = 0 then 'No Contact (Only KnlSystem Access)'
                 when uap.uap_person_type = 1 then 'Business Partner Senior'
                 when uap.uap_person_type = 2 then 'Business Partner Junior'
                 when uap.uap_person_type = 3 then 'Coordinator Contact 1'
                 when uap.uap_person_type = 4 then 'Coordinator Contact 2'
                 when uap.uap_person_type = 5 then 'Coordinator Contact (For more than two coordinators)'
            end as contactType
        from Uap_Unit_Assigned_Person_tb uap,
            Per_Person_tb per,
            Unt_Unit_tb unt,
            Usr_User_tb usr,
            Unt_Unit_tb unt2
        where uap.per_id_person = per.per_id
            and unt.unt_id = uap.unt_id
            and usr.per_id_person = per.per_id
            and unt2.unt_id = usr.unt_id_unit
            and uap.uap_active_flag = 1
            and uap.tax_id_type = 76
            and unt.unt_active_flag = 1
            and usr.usr_active_flag = 1) as uap on uap.unt_id = unt.unt_id
where unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    and unt.unt_active_flag = 1",
dbo,EFH_EXECUTION_FHL_VW,2012-11-16 11:35:58.350,2013-01-07 11:19:20.013,"CREATE VIEW [dbo].[EFH_EXECUTION_FHL_VW]
AS
select o.obligation_year as YEAR, o.obligation_org_unit_code AS ORG_UNIT, o.obligation_opus_code AS OPUS_CODE,
    '('+o.obligation_account_code+') '+o.obligation_account_name as ACCOUNT,
    o.obligation_vendor AS VENDOR,
    o.obligation_description as DESCRIPTION,
    DATENAME(month, o.obligation_entry_date) as MONTH,
    COUNT(*) AS BUDGET_LINES,
    isnull(SUM(O.execution_amount),0) as AMOUNT
from EXC_EXECUTION_VW o
where o.obligation_org_unit_code IN ('KNLFHL-KNX','KNLFHL-ADS','KNLFHL-ITM')    
group by o.obligation_year, o.obligation_org_unit_code, o.obligation_opus_code, '('+o.obligation_account_code+') '+o.obligation_account_name, o.obligation_vendor, o.obligation_description, DATENAME(month, o.obligation_entry_date)",
dbo,EXC_EXECUTION_VW,2010-11-04 11:47:31.457,2015-11-06 10:39:02.510,"CREATE VIEW [dbo].[EXC_EXECUTION_VW]
AS 
select
    --- OUTPUT
    bio.bio_id as obligation_id,
    out.out_id as output_id,
    aao.kna_id_activity as activity_id,
    (select knp.yea_year from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) as activity_year,
    (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as activity_department,
    (select unt.unt_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where kna.kna_id  = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as activity_unit,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header ) as activity_status,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header) as activity_approved_amount,
    CASE
        WHEN (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = aao.kna_id_activity)
    END as activity_type,
    (select tal2.tal_description from Tal_Taxonomy_Language_tb tal2 where tal2.tax_id = out.tax_id_presentation_type) as output_presentation_type,
    output_modality =
	case
		when out.out_modality = 'OUT_FACE_TO_FACE' then 'Face to Face'
		when out.out_modality = 'OUT_WEBINAR' then 'Webinar'
		when out.out_modality = 'OUT_VIRTUAL' then 'Virtual'
		when out.out_modality = 'OUT_SELF_LEARNING' then 'Self-Learning'
		else out.out_modality
	end,
	(select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as output_opus_code,
    output_type =
	case
		when out.out_type = 'OUT_EXTERNAL_EVENT' then 'External Event'
		when out.out_type = 'OUT_GENERAL_EVENT' then 'General Event'
		when out.out_type = 'OUT_GENERAL_SERVICE' then 'General Service'
		when out.out_type = 'OUT_KNOWLEDGE_PRODUCT' then 'Knowledge Product'
        when out.out_type = 'OUT_LIBRARY_PRODUCT' then 'Library Product'
		else out.out_type
	end,
   (select unt.unt_name from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id and aao.out_id_outcome = out.out_id) as output_unit,
   out.out_created_date as output_created_date,
    obg.obg_knl_amount as output_reviewed_amount,
    (select tal3.tal_description from Tal_Taxonomy_Language_tb tal3 where tal3.tax_id = obc.tax_id_category) as output_budget_category,
    obc.obc_item_cost as output_budget_category_amount,
    --- OBLIGATION
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		when bio.bio_entry_type = 'BIO_OPERATIONAL' then 'Operative'
		else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    consultant_id =
    case 
     when (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
    adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
   CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    (SELECT isNull(SUM(case when bie.bie_accounting_type = 'BIE_DEBIT' then BIE.bie_item_cost else BIE.bie_item_cost* -1 end),0)  FROM Bie_Budget_Item_Executed BIE WHERE bio.bio_id = bie.bio_id_budget_item_obligated and bie.bie_deleted_date is null) as bio_executed,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator, 
    --- EXECUTION
     bie.bie_id as execution_id,
    CASE 
        when bie.bie_accounting_type = 'BIE_CREDIT' then (bie.bie_item_cost * -1)
        else bie.bie_item_cost 
    END as execution_amount,
    bie.bie_invoice_date as execution_invoce_date,
    bie.bie_epay_flag as execution_epay_flag,
    bie.bie_description as execution_description,
    --bie.bie_deleted_date as execution_deleted_date,
    --(select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3 where per3.per_id = bie.per_id_updator) as execution_deletor,
    (select tal1.tal_description from Tal_Taxonomy_Language_tb tal1 where tal1.tax_id = bie.tax_id_classification) as execution_classification,
    case when bie.bie_epay_date is null then bie.bie_entry_date else bie.bie_epay_date end as execution_entry_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bie.per_id_creator) as execution_creator,
    bie.bie_last_updated_date as execution_last_updated_date,
    (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3 where per3.per_id = bie.per_id_updator) as execution_last_updator,
     bio.bio_lawson_date as lawson_date,
     bie.bie_epay_date as bud_e_date,
    bie.bud_e_id 
from Bio_Budget_Item_Obligated bio left outer join  Bie_Budget_Item_Executed bie on bio.bio_id = bie.bio_id_budget_item_obligated,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops,
    Out_Outcome_tb out left outer join Aao_available_activity_outcome_tb aao on out.out_id = aao.out_id_outcome,
    Obg_Outcome_Budget_tb obg,
    Obc_Outcome_Budget_Category_tb obc,
    Boo_Budget_Item_Operational boo
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type in ('BIO_OPERATIONAL')
    and bio.bio_id = boo.bio_id
    and boo.obc_id_outcome_budget_category = obc.obc_id
    and obc.obg_id_outcome_budget = obg.obg_id
    and obg.out_id_outcome = out.out_id
    and obg.obg_entry_type = 'OBG_EXECUTED'
    and bio.bio_deleted_date is null
    and bie.bie_deleted_date is null
union all
select
    bio.bio_id as obligation_id,
    0 as output_id,
    (select bip.kna_id from Bip_Budget_Item_Plan_Activity_tb bip where bip.bio_id  = bio.bio_id) as activity_id,
    (select knp.yea_year from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) as activity_year,
    (select dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as activity_department,
    (select unt.unt_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as activity_unit,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'CON')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id = bio.bio_id) as activity_status,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id  = bio.bio_id) as activity_approved_amount,
    CASE
        WHEN (select dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal, Bip_Budget_Item_Plan_Activity_tb bip where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = bip.kna_id and bip.bio_id = bio.bio_id)
    END as activity_type,
    '' as output_presentation_type,
    '' as output_modality,
    '' as output_opus_code,
    '' as output_type,
    '' as output_unit,
    '' as output_created_date,
    0 as output_reviewed_amount,
    '' as output_budget_category,
    0 as output_budget_category_amount,
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    consultant_id =
    case 
     when (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
    adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
    CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    (SELECT isNull(SUM(case when bie.bie_accounting_type = 'BIE_DEBIT' then BIE.bie_item_cost else BIE.bie_item_cost* -1 end),0)  FROM Bie_Budget_Item_Executed BIE WHERE bio.bio_id = bie.bio_id_budget_item_obligated and bie.bie_deleted_date is null) as obligation_executed,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator, 
    --- EXECUTION
     bie.bie_id as execution_id,
    CASE 
        when bie.bie_accounting_type = 'BIE_CREDIT' then (bie.bie_item_cost * -1)
        else bie.bie_item_cost 
    END as execution_amount,
    bie.bie_invoice_date as execution_invoce_date,
    bie.bie_epay_flag as execution_epay_flag,
    bie.bie_description as execution_description,
    --bie.bie_deleted_date as execution_deleted_date,
    --(select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3 where per3.per_id = bie.per_id_updator) as execution_deletor,
    (select tal1.tal_description from Tal_Taxonomy_Language_tb tal1 where tal1.tax_id = bie.tax_id_classification) as execution_classification,
    case when bie.bie_epay_date is null then bie.bie_entry_date else bie.bie_epay_date end as execution_entry_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bie.per_id_creator) as execution_creator,
    bie.bie_last_updated_date as execution_last_updated_date,
    (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3 where per3.per_id = bie.per_id_updator) as execution_last_updator,
     bio.bio_lawson_date as lawson_date,
     bie.bie_epay_date as bud_e_date,
    bie.bud_e_id 
from Bio_Budget_Item_Obligated bio left outer join  Bie_Budget_Item_Executed bie on bio.bio_id = bie.bio_id_budget_item_obligated,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type not in ('BIO_OPERATIONAL')
    and bio.bio_deleted_date is null
    and bie.bie_deleted_date is null",
dbo,FCL_FACILITATOR_VW,2013-04-02 16:30:01.240,2013-04-02 16:30:01.240,"CREATE VIEW [dbo].[FCL_FACILITATOR_VW]
AS 
select rft.rft_id as FCL_ID, 
    CASE WHEN rft.rft_type = 'RFT_IDB_STAFF' THEN 'IDB Staff'
         WHEN rft.rft_type = 'RFT_EXTERNAL_FACILITATOR' THEN 'External Facilitator'
         ELSE rft.rft_type
    END AS FCL_TYPE,
    usr.usr_pcmail AS EMP_PCMAIL, per1.per_first_name as FCL_FIRST_NAME, per1.per_middle_name as FCL_MIDDLE_NAME, per1.per_last_name AS FCL_LAST_NAME, 
    per1.per_first_name + ISNULL(' ' + per1.per_middle_name,'') + ' ' + per1.per_last_name AS FCL_COMPLETE_NAME,
    usr.usr_title AS EMP_TITLE, unt.unt_name AS EMP_UNIT,  usr.usr_type AS EMP_TYPE ,
    usr.usr_career_track AS EMP_CAREER_TRACK, usr.usr_career_path AS EMP_CAREER_PATH, usr.usr_work_role AS EMP_WORK_ROLE, usr.usr_work_location AS EMP_WORK_LOCATION, usr.usr_left_date AS EMP_LEFT_DATE,
    rft.rft_hours_participation AS FCL_HOURS_PARTICIPATION, 
    CASE WHEN rft.rft_modality_participation = 'RFT_FACE_TO_FACE' THEN 'Face to Face'
         WHEN rft.rft_modality_participation = 'RFT_ONLINE' THEN 'Online'
         ELSE rft.rft_modality_participation
    END AS FCL_MODALITY, 
    CASE WHEN rft.rft_role = 'RFT_SPEAKER' THEN 'Speaker'
         WHEN rft.rft_role = 'RFT_FACILITATOR' THEN 'Facilitator'
         WHEN rft.rft_role = 'RFT_COORDINATOR' THEN 'Coordinator'
         WHEN rft.rft_role = 'RFT_OBSERVER' THEN 'Observer'
         WHEN rft.rft_role = 'RFT_INSTRUCTOR_TUTOR' THEN 'Instructor / Tutor'
         ELSE rft.rft_role
    END AS FCL_ROLE,
    rft.rft_registered_date AS FCL_REGISTERED_DATE, 
    per3.per_first_name + ISNULL(' ' + per3.per_middle_name,'') + ' ' + per3.per_last_name AS FCL_REGISTRATOR, 
    rft.rft_short_bio AS FCL_SHORT_BIO, 
    a.yea_year AS KNA_YEAR, a.activityID AS KNA_ID, a.depName AS KNA_DEPT, a.depId AS KNA_DEPT_ID, a.unit AS KNA_UNIT, a.unitId AS KNA_UNIT_ID, 
    a.componentType AS KNA_COMPONENT_TYPE, a.deliverableName AS KNA_NER_NAME, a.activityName AS KNA_NAME,
    o.OUT_ID, o.OUT_TYPE, o.NAME, o.OBJECTIVES, o.MODALITY, o.PRESENTATION_TYPE, o.OPUS_CODE, o.OPUS_NAME, o.LOCATION_TYPE, o.LOCATION_CITY, o.LOCATION_NAME,
    o.START_DATE, o.END_DATE, o.DEADLINE, o.MAX_PARTICIPANTS, o.PRIVATE_REGISTRATION, o.TOTAL_DURATION, o.ONLINE_FLAG, o.TEACHER, o.MOODLE_ID, o.SERVICE_ACTIVE_FLAG,
    unt.unt_id AS EMP_UNIT_ID
from Rft_Registration_Facilitator_tb rft,
    Usr_User_tb usr,
    Unt_Unit_tb unt,
    Per_Person_tb per1,
    Per_Person_tb per2,
    Per_Person_tb per3,
    OUT_OUTPUT_VW o,
    ACT_ACTIVITIES_VW a
where rft.usr_id_staff_facilitator = usr.usr_id
    and rft.rft_deleted_flag = 0
    --and a.yea_year = 2013
    and per3.per_id = rft.per_id_registrator
    and unt.unt_id = usr.unt_id_unit
    and usr.per_id_person = per1.per_id
    and rft.per_id_registrator = per2.per_id
    and o.OUT_ID = rft.out_id_outcome
    and a.activityID = o.KNA_ID
UNION ALL
select rft.rft_id, 
    CASE WHEN rft.rft_type = 'RFT_IDB_STAFF' THEN 'IDB Staff'
         WHEN rft.rft_type = 'RFT_EXTERNAL_FACILITATOR' THEN 'External Facilitator'
         ELSE rft.rft_type
    END AS FACILITATOR_TYPE,
    NULL, per.per_first_name, per.per_middle_name, per.per_last_name,
    per.per_first_name + ISNULL(' ' + per.per_middle_name,'') + ' ' + per.per_last_name,
    NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL,
    rft.rft_hours_participation, 
    CASE WHEN rft.rft_modality_participation = 'RFT_FACE_TO_FACE' THEN 'Face to Face'
         WHEN rft.rft_modality_participation = 'RFT_ONLINE' THEN 'Online'
         ELSE rft.rft_modality_participation
    END AS FACILITATOR_MODALITY, 
    CASE WHEN rft.rft_role = 'RFT_SPEAKER' THEN 'Speaker'
         WHEN rft.rft_role = 'RFT_FACILITATOR' THEN 'Facilitator'
         WHEN rft.rft_role = 'RFT_COORDINATOR' THEN 'Coordinator'
         WHEN rft.rft_role = 'RFT_OBSERVER' THEN 'Observer'
         WHEN rft.rft_role = 'RFT_INSTRUCTOR_TUTOR' THEN 'Instructor / Tutor'
         ELSE rft.rft_role
    END AS FACILITATOR_ROLE,
    rft.rft_registered_date, 
    per3.per_first_name + ISNULL(' ' + per3.per_middle_name,'') + ' ' + per3.per_last_name, 
    rft.rft_short_bio, 
    a.yea_year, a.activityID, a.depName, a.depId, a.unit, a.unitId, a.componentType, a.deliverableName, a.activityName,
    o.OUT_ID, o.OUT_TYPE, o.NAME, o.OBJECTIVES, o.MODALITY, o.PRESENTATION_TYPE, o.OPUS_CODE, o.OPUS_NAME, o.LOCATION_TYPE, o.LOCATION_CITY, o.LOCATION_NAME,
    o.START_DATE, o.END_DATE, o.DEADLINE, o.MAX_PARTICIPANTS, o.PRIVATE_REGISTRATION, o.TOTAL_DURATION, o.ONLINE_FLAG, o.TEACHER, o.MOODLE_ID, o.SERVICE_ACTIVE_FLAG, NULL
from Rft_Registration_Facilitator_tb rft,
    Per_Person_tb per,
    Per_Person_tb per3,
    OUT_OUTPUT_VW o,
    ACT_ACTIVITIES_VW a
where rft.per_id_external_facilitator = per.per_id
    and rft.rft_deleted_flag = 0
    --and a.yea_year = 2013
    and o.OUT_ID = rft.out_id_outcome
    and per3.per_id = rft.per_id_registrator
    and a.activityID = o.KNA_ID",
dbo,GDP_EMPLOYEES_2011,2012-01-11 17:20:04.113,2012-06-30 11:17:28.243,"CREATE VIEW [dbo].[GDP_EMPLOYEES_2011]
AS 
select USR.usr_employee_id AS EMPLOYEE_ID,
         DEP.dep_name AS DEPARTMENT,
         UNT.unt_name AS NAME,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name as EMPLOYEE_NAME,
         CASE WHEN usr.usr_type = 'STF' THEN
             CASE WHEN usr.usr_grade IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
                  ELSE
                  CASE WHEN ISNULL(usr.usr_payment_type,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                       WHEN ISNULL(usr.usr_payment_type,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                       ELSE 'OTHER'
                  END
             END
         ELSE 'OTHER'
         END as EMPLOYEE_TYPE,
         usr.usr_work_location AS WORK_LOCATION,
         USR.USR_career_track as CAREER_TRACK,
1 as COUNT,
(select COUNT(*)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2011 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2011 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2011 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2011') < '12/31/2011 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS REGISTRATIONS,
(select ISNULL(SUM(A.TOTAL_DURATION),0)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2011 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2011 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2011 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2011') < '12/31/2011 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS TOTAL_HOURS
from Usr_User_tb usr,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec,
    Per_Person_tb PER
where usr.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    --and sec.sec_name = 'VPC'
    AND USR.usr_active_flag = 1
    and per.per_type not in ('R')
    AND PER.per_id = USR.per_id_person
GROUP BY USR.usr_employee_id,
         DEP.dep_name,
         UNT.unt_name,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name,
         USR.usr_type,
         USR.usr_grade,
         USR.usr_payment_type,
         usr.usr_work_location,
         usr.usr_career_track",
dbo,GDP_EMPLOYEES_2012,2012-01-11 17:20:52.050,2013-06-10 17:22:38.087,"CREATE VIEW [dbo].[GDP_EMPLOYEES_2012]
AS 
select USR.usr_employee_id AS EMPLOYEE_ID,
         DEP.dep_name AS DEPARTMENT,
         UNT.unt_name AS NAME,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name as EMPLOYEE_NAME,
         PER.per_gender AS GENDER,
         CASE WHEN usr.usr_type = 'STF' THEN
             CASE WHEN usr.usr_grade IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
                  ELSE
                  CASE WHEN ISNULL(usr.usr_payment_type,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                       WHEN ISNULL(usr.usr_payment_type,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                       ELSE 'OTHER'
                  END
             END
         ELSE 'OTHER'
         END as EMPLOYEE_TYPE,
         usr.usr_work_location AS WORK_LOCATION,
         USR.USR_career_track as CAREER_TRACK,
         USR.USR_career_path as CAREER_PATH,
         USR.USR_WORK_ROLE as WORK_ROLE,
         USR.USR_CONTRACT_TYPE as CONTRACT_TYPE,
1 as COUNT,
(select COUNT(*)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2012 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2012 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2012 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2012') < '12/31/2012 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS REGISTRATIONS,
(select ISNULL(SUM(A.TOTAL_DURATION),0)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2012 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2012 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2012 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2012') < '12/31/2012 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS TOTAL_HOURS
from Usr_User_tb usr,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec,
    Per_Person_tb PER
where usr.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    --and sec.sec_name = 'VPC'
    AND USR.usr_active_flag = 1
    and per.per_type not in ('R')
    AND PER.per_id = USR.per_id_person
GROUP BY USR.usr_employee_id,
         DEP.dep_name,
         UNT.unt_name,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name,
         per.per_gender,
         USR.usr_type,
         USR.usr_grade,
         USR.usr_payment_type,
         usr.usr_work_location,
         usr.usr_career_track,
         usr.usr_career_path,
         usr.usr_work_role,
         usr.usr_contract_type",
dbo,GDP_EMPLOYEES_2013,2013-01-02 14:39:42.150,2013-06-10 16:46:25.477,"CREATE VIEW [dbo].[GDP_EMPLOYEES_2013]
AS 
select USR.usr_employee_id AS EMPLOYEE_ID,
         DEP.dep_name AS DEPARTMENT,
         UNT.unt_name AS NAME,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name as EMPLOYEE_NAME,
         PER.per_gender AS GENDER,
         CASE WHEN usr.usr_type = 'STF' THEN
             CASE WHEN usr.usr_grade IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
                  ELSE
                  CASE WHEN ISNULL(usr.usr_payment_type,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                       WHEN ISNULL(usr.usr_payment_type,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                       ELSE 'OTHER'
                  END
             END
         ELSE 'OTHER'
         END as EMPLOYEE_TYPE,
         usr.usr_work_location AS WORK_LOCATION,
         USR.USR_career_track as CAREER_TRACK,
         USR.USR_career_path as CAREER_PATH,
         USR.USR_WORK_ROLE as WORK_ROLE,
         USR.USR_CONTRACT_TYPE as CONTRACT_TYPE,
1 as COUNT,
(select COUNT(*)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2013 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2013 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2013 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2013') < '12/31/2013 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS REGISTRATIONS,
(select ISNULL(SUM(A.TOTAL_DURATION),0)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2013 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2013 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2013 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2013') < '12/31/2013 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS TOTAL_HOURS
from Usr_User_tb usr,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec,
    Per_Person_tb PER
where usr.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    --and sec.sec_name = 'VPC'
    AND USR.usr_active_flag = 1
    and per.per_type not in ('R')
    AND PER.per_id = USR.per_id_person
GROUP BY USR.usr_employee_id,
         DEP.dep_name,
         UNT.unt_name,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name,
         per.per_gender,
         USR.usr_type,
         USR.usr_grade,
         USR.usr_payment_type,
         usr.usr_work_location,
         usr.usr_career_track,
         usr.usr_career_path,
         usr.usr_work_role,
         usr.usr_contract_type",
dbo,GDP_EMPLOYEES_2014,2014-01-28 09:49:28.770,2014-06-16 10:26:27.240,"CREATE VIEW [dbo].[GDP_EMPLOYEES_2014]
AS 
select USR.usr_employee_id AS EMPLOYEE_ID,
         DEP.dep_name AS DEPARTMENT,
         UNT.unt_name AS NAME,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name as EMPLOYEE_NAME,
         PER.per_gender AS GENDER,
         usr.usr_work_location AS WORK_LOCATION,
         USR.USR_career_track as CAREER_TRACK,
         USR.USR_career_path as CAREER_PATH,
         USR.USR_WORK_ROLE as WORK_ROLE,
         USR.USR_CONTRACT_TYPE as CONTRACT_TYPE,
1 as COUNT,
(select COUNT(*)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2014 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2014 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2014 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2014') < '12/31/2014 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS TOTAL_HOURS
from Usr_User_tb usr,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec,
    Per_Person_tb PER
where usr.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    --and sec.sec_name = 'VPC'
    AND USR.usr_active_flag = 1
    and per.per_type not in ('R')
    AND PER.per_id = USR.per_id_person
GROUP BY USR.usr_employee_id,
         DEP.dep_name,
         UNT.unt_name,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name,
         per.per_gender,
         USR.usr_type,
         USR.usr_grade,
         USR.usr_payment_type,
         usr.usr_work_location,
         usr.usr_career_track,
         usr.usr_career_path,
         usr.usr_work_role,
         usr.usr_contract_type",
dbo,GDP_EMPLOYEES_2015,2015-06-16 09:40:02.333,2015-06-16 09:40:02.333,"CREATE VIEW [dbo].[GDP_EMPLOYEES_2015]
AS 
select USR.usr_employee_id AS EMPLOYEE_ID,
         DEP.dep_name AS DEPARTMENT,
         UNT.unt_name AS NAME,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name as EMPLOYEE_NAME,
         PER.per_gender AS GENDER,
         usr.usr_work_location AS WORK_LOCATION,
         USR.USR_career_track as CAREER_TRACK,
         USR.USR_career_path as CAREER_PATH,
         USR.USR_WORK_ROLE as WORK_ROLE,
         USR.USR_CONTRACT_TYPE as CONTRACT_TYPE,
1 as COUNT,
(select COUNT(*)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2015 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2015 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2015 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2014') < '12/31/2014 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS TOTAL_HOURS
from Usr_User_tb usr,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec,
    Per_Person_tb PER
where usr.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    --and sec.sec_name = 'VPC'
    AND USR.usr_active_flag = 1
    and per.per_type not in ('R')
    AND PER.per_id = USR.per_id_person
GROUP BY USR.usr_employee_id,
         DEP.dep_name,
         UNT.unt_name,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name,
         per.per_gender,
         USR.usr_type,
         USR.usr_grade,
         USR.usr_payment_type,
         usr.usr_work_location,
         usr.usr_career_track,
         usr.usr_career_path,
         usr.usr_work_role,
         usr.usr_contract_type",
dbo,GDP_EMPLOYEES_2016,2016-05-04 10:17:30.277,2016-05-04 10:19:56.407,"CREATE VIEW [dbo].[GDP_EMPLOYEES_2016]
AS 
select USR.usr_employee_id AS EMPLOYEE_ID,
         DEP.dep_name AS DEPARTMENT,
         UNT.unt_name AS NAME,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name as EMPLOYEE_NAME,
         PER.per_gender AS GENDER,
         usr.usr_work_location AS WORK_LOCATION,
         USR.USR_career_track as CAREER_TRACK,
         USR.USR_career_path as CAREER_PATH,
         USR.USR_WORK_ROLE as WORK_ROLE,
         USR.USR_CONTRACT_TYPE as CONTRACT_TYPE,
1 as COUNT,
(select COUNT(*)
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2016 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2016 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2016 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2016') < '12/31/2016 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
    and A.employee_id = usr.usr_employee_id) AS TOTAL_HOURS
from Usr_User_tb usr,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec,
    Per_Person_tb PER
where usr.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    --and sec.sec_name = 'VPC'
    AND USR.usr_active_flag = 1
    and per.per_type not in ('R')
    AND PER.per_id = USR.per_id_person
GROUP BY USR.usr_employee_id,
         DEP.dep_name,
         UNT.unt_name,
         PER.per_first_name + ' ' + ISNULL(PER.per_middle_name,'') + ' ' + PER.per_last_name,
         per.per_gender,
         USR.usr_type,
         USR.usr_grade,
         USR.usr_payment_type,
         usr.usr_work_location,
         usr.usr_career_track,
         usr.usr_career_path,
         usr.usr_work_role,
         usr.usr_contract_type",
dbo,GDP_GENERAL_DUMP_2009,2012-02-10 14:32:05.343,2012-06-30 11:17:28.540,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2009]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2009' AND '12/31/2009 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2009 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2009 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2009 23:59:59'
    AND a.SHOWUP_FLAG = 1
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_GENERAL_DUMP_2010,2012-02-10 15:33:56.480,2012-06-30 11:17:28.547,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2010]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2010' AND '12/31/2010 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2010 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2010 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2010 23:59:59'
    AND a.SHOWUP_FLAG = 1
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_GENERAL_DUMP_2011,2012-01-05 15:00:19.293,2012-06-30 11:17:28.720,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2011]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2011 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2011 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2011 23:59:59'
    AND a.SHOWUP_FLAG = 1
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_GENERAL_DUMP_2012,2012-01-11 17:07:38.630,2013-06-17 14:27:02.847,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2012]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY USR.USR_ID DESC)) AS LAST_DEPT,
    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY USR.USR_ID DESC)) AS LAST_UNIT,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2012 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2012 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2012 23:59:59'
    --AND a.SHOWUP_FLAG = 1
    --AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_GENERAL_DUMP_2013,2013-01-02 14:40:44.257,2013-06-10 16:35:47.310,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2013]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY USR.USR_ID DESC)) AS LAST_DEPT,
    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY USR.USR_ID DESC)) AS LAST_UNIT,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.GENDER,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2013 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2013 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2013 23:59:59'
    --AND a.SHOWUP_FLAG = 1
    --AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_GENERAL_DUMP_2014,2014-01-28 09:43:27.443,2014-06-16 10:25:53.190,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2014]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY USR.USR_ID DESC)) AS LAST_DEPT,
    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY USR.USR_ID DESC)) AS LAST_UNIT,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2014 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2014 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2014 23:59:59'
    --AND a.SHOWUP_FLAG = 1
    --AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_GENERAL_DUMP_2015,2015-06-16 09:41:17.753,2015-06-16 09:41:17.753,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2015]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY USR.USR_ID DESC)) AS LAST_DEPT,
    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY USR.USR_ID DESC)) AS LAST_UNIT,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2015 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2015 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2015 23:59:59'
    AND a.SHOWUP_FLAG = 1
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_GENERAL_DUMP_2016,2016-05-04 10:18:49.803,2016-05-04 10:18:49.803,"CREATE VIEW [dbo].[GDP_GENERAL_DUMP_2016]
AS 
select 
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = A.OUT_ID) AS activityID,
    (SELECT dep.dep_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) AS plan_depName,
    (SELECT unt.unt_name FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) AS plan_unit,
    (SELECT knp.yea_year FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) AS plan_year,
    (SELECT tal.tal_description FROM Aao_Available_Activity_Outcome_tb AAO, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal WHERE AAO.out_id_outcome = A.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and tal.lng_id = 1) AS COMPONENT_TYPE,
    a.*,
    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY USR.USR_ID DESC)) AS LAST_DEPT,
    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY USR.USR_ID DESC)) AS LAST_UNIT,
    CASE WHEN a.total_duration = 999 THEN 0 ELSE a.total_duration END as total_hours,
    1 as COUNT,
    DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS MONTH,
    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
         WHEN a.total_duration >=24 THEN '>= 24'
    END AS TYPE,
    CASE WHEN A.EMPLOYEE_TYPE = 'STAFF' THEN
         CASE WHEN A.GRADE IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
              ELSE
              CASE WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                   WHEN ISNULL(A.PAYMENT_TYPE,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                   ELSE 'OTHER'
              END
         END
         ELSE 'OTHER'
    END as STAFF_TYPE,
    a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
    case when substring(a.UNIT,5,1) = 'C' then substring(a.UNIT,6,2)
         else a.WORK_COUNTRY 
    END as COF_COUNTRY,
    isnull((select tjf.tjf_job_family from Tjf_Title_Job_Family_Matriz TJF where tjf.tjf_title = a.TITLE),a.TITLE) as JOB_FAMILY
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
    ) a
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2016 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2016 23:59:59') 
    AND a.REG_CREATED_DATE <= '12/31/2016 23:59:59'
    AND a.SHOWUP_FLAG = 1
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'",
dbo,GDP_UNIQUE_DATA_2011,2012-01-11 17:15:43.863,2012-06-30 11:17:28.750,"CREATE VIEW [dbo].[GDP_UNIQUE_DATA_2011]
AS 
select a.department AS DEPARTMENT, a.unit AS UNIT, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name as NAME, a.employee_id AS EMPLOYEE_ID,
    (SELECT CASE WHEN u.usr_type = 'STF' THEN
             CASE WHEN u.usr_grade IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
                  ELSE
                  CASE WHEN ISNULL(u.usr_payment_type,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                       WHEN ISNULL(u.usr_payment_type,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                       ELSE 'OTHER'
                  END
             END
         ELSE 'OTHER'
         END as EMPLOYEE_TYPE
FROM Usr_User_tb u
WHERE u.usr_entry_date = (
     SELECT     MAX(usr_entry_date)
     FROM Usr_User_tb u2
     WHERE u2.usr_employee_id = a.employee_id)
     and u.usr_employee_id = a.employee_id) as STAFF_TYPE,
     a.CAREER_TRACK as CAREER_TRACK,
     a.work_location AS WORK_LOCATION,
    count(a.reg_id) as REGISTRATIONS,
    a.total_duration as TOTAL_HOURS,
    1 as COUNT
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2011' AND '12/31/2011 23:59:59'
    ) a,
    Sec_Section_tb SEC,
    Dep_Department_tb DEP
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2011 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2011 23:59:59') 
    AND SEC.sec_id = DEP.sec_id_section
    AND DEP.dep_name = A.DEPARTMENT
    --AND SEC.sec_name = 'VPC'
    AND a.REG_CREATED_DATE <= '12/31/2011 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2011') < '12/31/2011 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
group by a.department, a.unit, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name, a.employee_id, a.work_location, a.career_track, a.total_duration",
dbo,GDP_UNIQUE_DATA_2012,2012-01-11 17:17:05.497,2013-06-10 17:24:11.737,"CREATE VIEW [dbo].[GDP_UNIQUE_DATA_2012]
as
select a.department AS DEPARTMENT, a.unit AS UNIT, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name as NAME, a.employee_id AS EMPLOYEE_ID,
    (SELECT CASE WHEN u.usr_type = 'STF' THEN
             CASE WHEN u.usr_grade IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
                  ELSE
                  CASE WHEN ISNULL(u.usr_payment_type,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                       WHEN ISNULL(u.usr_payment_type,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                       ELSE 'OTHER'
                  END
             END
         ELSE 'OTHER'
         END as EMPLOYEE_TYPE
FROM Usr_User_tb u
WHERE u.usr_entry_date = (
     SELECT     MAX(usr_entry_date)
     FROM Usr_User_tb u2
     WHERE u2.usr_employee_id = a.employee_id)
     and u.usr_employee_id = a.employee_id) as STAFF_TYPE,
     a.CAREER_TRACK as CAREER_TRACK,
     a.CAREER_PATH as CAREER_PATH, 
     a.WORK_ROLE as WORK_ROLE,
     a.CONTRACT_TYPE AS CONTRACT_TYPE,
     a.work_location AS WORK_LOCATION,
    count(a.reg_id) as REGISTRATIONS,
    a.total_duration as TOTAL_HOURS,
    1 as COUNT
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2012' AND '12/31/2012 23:59:59'
    ) a,
    Sec_Section_tb SEC,
    Dep_Department_tb DEP
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2012 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2012 23:59:59') 
    AND SEC.sec_id = DEP.sec_id_section
    AND DEP.dep_name = A.DEPARTMENT
    --AND SEC.sec_name = 'VPC'
    AND a.REG_CREATED_DATE <= '12/31/2012 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2012') < '12/31/2012 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
group by a.department, a.unit, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name, a.employee_id, a.work_location, a.career_track, a.career_path, a.work_role, a.contract_type, a.total_duration",
dbo,GDP_UNIQUE_DATA_2013,2013-01-02 14:41:44.277,2013-06-10 16:38:03.437,"CREATE VIEW [dbo].[GDP_UNIQUE_DATA_2013]
as
select a.department AS DEPARTMENT, a.unit AS UNIT, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name as NAME, a.employee_id AS EMPLOYEE_ID,
    (SELECT CASE WHEN u.usr_type = 'STF' THEN
             CASE WHEN u.usr_grade IN ('E1','E2','E3','E4','E5','EX1','EX2','EX3','EX4','P','R') THEN 'EXECUTIVE'
                  ELSE
                  CASE WHEN ISNULL(u.usr_payment_type,'') IN ('IP','JRP','JSF', 'KPR','LP','MIP','STP','TS') THEN 'PROFESSIONAL'
                       WHEN ISNULL(u.usr_payment_type,'') IN ('IA', 'LA', 'STA') THEN 'ADMINISTRATIVE'
                       ELSE 'OTHER'
                  END
             END
         ELSE 'OTHER'
         END as EMPLOYEE_TYPE
FROM Usr_User_tb u
WHERE u.usr_entry_date = (
     SELECT     MAX(usr_entry_date)
     FROM Usr_User_tb u2
     WHERE u2.usr_employee_id = a.employee_id)
     and u.usr_employee_id = a.employee_id) as STAFF_TYPE,
     a.CAREER_TRACK as CAREER_TRACK,
     a.CAREER_PATH as CAREER_PATH, 
     a.WORK_ROLE as WORK_ROLE,
     a.CONTRACT_TYPE AS CONTRACT_TYPE,
     a.work_location AS WORK_LOCATION,
    count(a.reg_id) as REGISTRATIONS,
    a.total_duration as TOTAL_HOURS,
    1 as COUNT
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R    
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND R.CREATED_DATE BETWEEN '01/01/2013' AND '12/31/2013 23:59:59'
    ) a,
    Sec_Section_tb SEC,
    Dep_Department_tb DEP
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2013 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2013 23:59:59') 
    AND SEC.sec_id = DEP.sec_id_section
    AND DEP.dep_name = A.DEPARTMENT
    --AND SEC.sec_name = 'VPC'
    AND a.REG_CREATED_DATE <= '12/31/2013 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2013') < '12/31/2013 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
group by a.department, a.unit, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name, a.employee_id, a.work_location, a.career_track, a.career_path, a.work_role, a.contract_type, a.total_duration",
dbo,GDP_UNIQUE_DATA_2014,2014-01-28 09:57:12.610,2014-06-16 10:27:01.170,"CREATE VIEW [dbo].[GDP_UNIQUE_DATA_2014]
AS 
select a.department AS DEPARTMENT, a.unit AS UNIT, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name as NAME, a.employee_id AS EMPLOYEE_ID,
     a.CAREER_TRACK as CAREER_TRACK,
     a.CAREER_PATH as CAREER_PATH, 
     a.WORK_ROLE as WORK_ROLE,
     a.CONTRACT_TYPE AS CONTRACT_TYPE,
     a.work_location AS WORK_LOCATION,
    count(a.reg_id) as REGISTRATIONS,
    a.total_duration as TOTAL_HOURS,
    1 as COUNT
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2014' AND '12/31/2014 23:59:59'
    ) a,
    Sec_Section_tb SEC,
    Dep_Department_tb DEP
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2014 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2014 23:59:59') 
    AND SEC.sec_id = DEP.sec_id_section
    AND DEP.dep_name = A.DEPARTMENT
    --AND SEC.sec_name = 'VPC'
    AND a.REG_CREATED_DATE <= '12/31/2014 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2014') < '12/31/2014 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
group by a.department, a.unit, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name, a.employee_id, a.work_location, a.career_track, a.career_path, a.work_role, a.contract_type, a.total_duration",
dbo,GDP_UNIQUE_DATA_2015,2015-06-16 09:42:47.200,2015-06-16 09:42:47.200,"CREATE VIEW [dbo].[GDP_UNIQUE_DATA_2015]
AS 
select a.department AS DEPARTMENT, a.unit AS UNIT, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name as NAME, a.employee_id AS EMPLOYEE_ID,
     a.CAREER_TRACK as CAREER_TRACK,
     a.CAREER_PATH as CAREER_PATH, 
     a.WORK_ROLE as WORK_ROLE,
     a.CONTRACT_TYPE AS CONTRACT_TYPE,
     a.work_location AS WORK_LOCATION,
    count(a.reg_id) as REGISTRATIONS,
    a.total_duration as TOTAL_HOURS,
    1 as COUNT
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2015' AND '12/31/2015 23:59:59'
    ) a,
    Sec_Section_tb SEC,
    Dep_Department_tb DEP
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2015 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2015 23:59:59') 
    AND SEC.sec_id = DEP.sec_id_section
    AND DEP.dep_name = A.DEPARTMENT
    --AND SEC.sec_name = 'VPC'
    AND a.REG_CREATED_DATE <= '12/31/2015 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2015') < '12/31/2015 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
group by a.department, a.unit, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name, a.employee_id, a.work_location, a.career_track, a.career_path, a.work_role, a.contract_type, a.total_duration",
dbo,GDP_UNIQUE_DATA_2016,2016-05-04 10:21:08.460,2016-05-04 10:21:08.460,"CREATE VIEW [dbo].[GDP_UNIQUE_DATA_2016]
AS 
select a.department AS DEPARTMENT, a.unit AS UNIT, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name as NAME, a.employee_id AS EMPLOYEE_ID,
     a.CAREER_TRACK as CAREER_TRACK,
     a.CAREER_PATH as CAREER_PATH, 
     a.WORK_ROLE as WORK_ROLE,
     a.CONTRACT_TYPE AS CONTRACT_TYPE,
     a.work_location AS WORK_LOCATION,
    count(a.reg_id) as REGISTRATIONS,
    a.total_duration as TOTAL_HOURS,
    1 as COUNT
from (
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_GENERAL_EVENT_VW O,
    REG_GUEST_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
    REG_REGISTRATION_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE, NULL AS CONTRACT_TYPE,
    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_MOODLE_EVENT_VW O,
    REG_GUEST_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_EXTERNAL_EVENT_VW O,
    REG_REGISTRATION_USER_VW R  
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_GENERAL_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_MOODLE_SERVICE_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
FROM OUT_COLLABORATIVE_LEARNING_VW O,
    REG_REGISTRATION_USER_VW R 
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE, R.CONTRACT_TYPE,
    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
FROM OUT_LANGUAGE_SERVICE_VW O,
    REG_LANGUAGE_USER_VW R
WHERE R.OUT_ID = O.OUT_ID
    AND O.START_DATE BETWEEN '01/01/2016' AND '12/31/2016 23:59:59'
    ) a,
    Sec_Section_tb SEC,
    Dep_Department_tb DEP
where (A.OUT_deleted_date is null or A.OUT_deleted_date > '12/31/2016 23:59:59') 
    AND (A.reg_deleted_date is null or A.reg_deleted_date > '12/31/2016 23:59:59') 
    AND SEC.sec_id = DEP.sec_id_section
    AND DEP.dep_name = A.DEPARTMENT
    --AND SEC.sec_name = 'VPC'
    AND a.REG_CREATED_DATE <= '12/31/2016 23:59:59'
    AND a.SHOWUP_FLAG = 1
    and isnull((select top 1 fsa.fsa_date from Rfa_Registration_Flow_Action_tb rfa, Fsa_Flow_Step_Action_tb fsa where rfa.reg_id = A.reg_id and rfa.fsa_id = fsa.fsa_id and fsa.fsa_action = 'APPROVE' order by fsa.fsa_date),'01/01/2016') < '12/31/2016 23:59:59'
    AND a.REG_STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
group by a.department, a.unit, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name, a.employee_id, a.work_location, a.career_track, a.career_path, a.work_role, a.contract_type, a.total_duration",
dbo,KBS_KNL_BUDGET_SUMMARY_VW,2010-06-01 17:43:30.910,2012-06-30 11:17:28.457,"CREATE VIEW [dbo].[KBS_KNL_BUDGET_SUMMARY_VW]
AS 
select a.depName, a.allocatedAmount, a.approvedNeedAmount, a.obligated_need_amount, a.executed_need_amount, a.approvedContributionAmount, a.obligated_contribution_amount, a.executed_contribution_amount, a.approvedKcpAmount, a.obligated_kcp_amount, a.executed_kcp_amount
from
(select dep.dep_name as depName, sum(kai.kai_amount) as allocatedAmount,
    (select isNull(sum((kpb.kpb_item_cost * kna.kna_knl_percentage)/100),0) from Kpb_Knl_Plan_Budget_tb kpb, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tag_Taxonomy_Group_tb tag, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp where kpb.kna_id=kna.kna_id and kna.kpd_id_deliverable=kpd.kpd_id and kna.kna_deleted_date is null and kpd.knd_id_division=knd.knd_Id and tag.tax_id_group_header = kpd.tax_id_type and tag.tag_code = 'NEE' and knd.knp_id_plan_department=knp.knp_id and kna.kna_deleted_date is null and kpd.kpd_deleted_date is null and kna.kna_selected_flag = 1 and knp.dep_id_department = dep.dep_id and knp.yea_year = kpa.yea_year) as approvedNeedAmount,
    (select isNull(sum(a.obligation_amount),0) from (select sum(obd.obligation_amount) as obligation_amount from OOB_OPERATIONAL_OBLIGATED_BUDGET_VW obd, Unt_Unit_tb unt, Kpd_Knl_Plan_Deliverable_tb kpd, Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag where obd.output_unit = unt.unt_name and unt.dep_id_department = dep.dep_id and obd.obligation_entry_type = 'Operative' and obd.obligation_year = kpa.yea_year and kpd.kpd_id = kna.kpd_id_deliverable and kna.kna_id = obd.activity_id  and kpd.tax_id_type = tag.tax_id_group_header  and tag.tag_code = 'NEE' union select sum(aob.obligation_amount) as obligation_amount from AOB_ADMINISTRATIVE_OBLIGATED_BUDGET_VW aob, Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Tag_Taxonomy_Group_tb tag where aob.obligation_entry_type = 'Plan Activity' and aob.obligation_year = kpa.yea_year and kna.kna_id = bip.kna_id and bip.bio_id = aob.obligation_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and kpd.tax_id_type = tag.tax_id_group_header and tag.tag_code = 'NEE' and knp.dep_id_department = dep.dep_id) as a) as obligated_need_amount,
    (select isNull(sum(a.execution_amount),0) from (select sum(obd.execution_amount) as execution_amount from OBD_OPERATIONAL_BUDGET_VW obd, Unt_Unit_tb unt, Kpd_Knl_Plan_Deliverable_tb kpd, Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag where obd.output_unit = unt.unt_name and unt.dep_id_department = dep.dep_id and obd.obligation_entry_type = 'Operative' and obd.obligation_year = kpa.yea_year and kpd.kpd_id = kna.kpd_id_deliverable and kna.kna_id = obd.activity_id  and kpd.tax_id_type = tag.tax_id_group_header  and tag.tag_code = 'NEE' union select sum(aob.execution_amount) as execution_amount from dbo.ADB_ADMINISTRATIVE_BUDGET_VW aob, Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Tag_Taxonomy_Group_tb tag where aob.obligation_entry_type = 'Plan Activity' and aob.obligation_year = kpa.yea_year and kna.kna_id = bip.kna_id and bip.bio_id = aob.obligation_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and kpd.tax_id_type = tag.tax_id_group_header and tag.tag_code = 'NEE' and knp.dep_id_department = dep.dep_id) as a) as executed_need_amount, 
    (select isNull(sum(kna.kna_approved_amount),0) from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tag_Taxonomy_Group_tb tag, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp where kna.kpd_id_deliverable=kpd.kpd_id and kna.kna_deleted_date is null and kpd.knd_id_division=knd.knd_Id and tag.tax_id_group_header = kpd.tax_id_type and tag.tag_code = 'CON' and knd.knp_id_plan_department=knp.knp_id and kna.kna_deleted_date is null and kpd.kpd_deleted_date is null and kna.kna_selected_flag = 1 and knp.dep_id_department = dep.dep_id and knp.yea_year = kpa.yea_year) as approvedContributionAmount,
    (select isNull(sum(a.obligation_amount),0) from (select sum(obd.obligation_amount) as obligation_amount from OOB_OPERATIONAL_OBLIGATED_BUDGET_VW obd, Unt_Unit_tb unt, Kpd_Knl_Plan_Deliverable_tb kpd, Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag where obd.output_unit = unt.unt_name and unt.dep_id_department = dep.dep_id and obd.obligation_entry_type = 'Operative' and obd.obligation_year = kpa.yea_year and kpd.kpd_id = kna.kpd_id_deliverable and kna.kna_id = obd.activity_id  and kpd.tax_id_type = tag.tax_id_group_header  and tag.tag_code = 'CON' union select sum(aob.obligation_amount) as obligation_amount from AOB_ADMINISTRATIVE_OBLIGATED_BUDGET_VW aob, Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Tag_Taxonomy_Group_tb tag where aob.obligation_entry_type = 'Plan Activity' and aob.obligation_year = kpa.yea_year and kna.kna_id = bip.kna_id and bip.bio_id = aob.obligation_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and kpd.tax_id_type = tag.tax_id_group_header and tag.tag_code = 'CON' and knp.dep_id_department = dep.dep_id) as a) as obligated_contribution_amount,
    (select isNull(sum(a.execution_amount),0) from (select sum(obd.execution_amount) as execution_amount from OBD_OPERATIONAL_BUDGET_VW obd, Unt_Unit_tb unt, Kpd_Knl_Plan_Deliverable_tb kpd, Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag where obd.output_unit = unt.unt_name and unt.dep_id_department = dep.dep_id and obd.obligation_entry_type = 'Operative' and obd.obligation_year = kpa.yea_year and kpd.kpd_id = kna.kpd_id_deliverable and kna.kna_id = obd.activity_id  and kpd.tax_id_type = tag.tax_id_group_header  and tag.tag_code = 'CON' union select sum(aob.execution_amount) as execution_amount from dbo.ADB_ADMINISTRATIVE_BUDGET_VW aob, Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Tag_Taxonomy_Group_tb tag where aob.obligation_entry_type = 'Plan Activity' and aob.obligation_year = kpa.yea_year and kna.kna_id = bip.kna_id and bip.bio_id = aob.obligation_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and kpd.tax_id_type = tag.tax_id_group_header and tag.tag_code = 'CON' and knp.dep_id_department = dep.dep_id) as a) as executed_contribution_amount, 
    (select isNull(sum(kna.kna_approved_amount),0) from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tag_Taxonomy_Group_tb tag, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp where kna.kpd_id_deliverable=kpd.kpd_id and kna.kna_deleted_date is null and kpd.knd_id_division=knd.knd_Id and tag.tax_id_group_header = kpd.tax_id_type and tag.tag_code = 'KCP' and knd.knp_id_plan_department=knp.knp_id and kna.kna_deleted_date is null and kpd.kpd_deleted_date is null and kna.kna_selected_flag = 1 and knp.dep_id_department = dep.dep_id and knp.yea_year = kpa.yea_year) as approvedKcpAmount,
    (select isNull(sum(a.obligation_amount),0) from (select sum(obd.obligation_amount) as obligation_amount from OOB_OPERATIONAL_OBLIGATED_BUDGET_VW obd, Unt_Unit_tb unt, Kpd_Knl_Plan_Deliverable_tb kpd, Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag where obd.output_unit = unt.unt_name and unt.dep_id_department = dep.dep_id and obd.obligation_entry_type = 'Operative' and obd.obligation_year = kpa.yea_year and kpd.kpd_id = kna.kpd_id_deliverable and kna.kna_id = obd.activity_id  and kpd.tax_id_type = tag.tax_id_group_header  and tag.tag_code = 'KCP' union select sum(aob.obligation_amount) as obligation_amount from AOB_ADMINISTRATIVE_OBLIGATED_BUDGET_VW aob, Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Tag_Taxonomy_Group_tb tag where aob.obligation_entry_type = 'Plan Activity' and aob.obligation_year = kpa.yea_year and kna.kna_id = bip.kna_id and bip.bio_id = aob.obligation_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and kpd.tax_id_type = tag.tax_id_group_header and tag.tag_code = 'KCP' and knp.dep_id_department = dep.dep_id) as a) as obligated_kcp_amount,
    (select isNull(sum(a.execution_amount),0) from (select sum(obd.execution_amount) as execution_amount from OBD_OPERATIONAL_BUDGET_VW obd, Unt_Unit_tb unt, Kpd_Knl_Plan_Deliverable_tb kpd, Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag where obd.output_unit = unt.unt_name and unt.dep_id_department = dep.dep_id and obd.obligation_entry_type = 'Operative' and obd.obligation_year = kpa.yea_year and kpd.kpd_id = kna.kpd_id_deliverable and kna.kna_id = obd.activity_id  and kpd.tax_id_type = tag.tax_id_group_header  and tag.tag_code = 'KCP' union select sum(aob.execution_amount) as execution_amount from dbo.ADB_ADMINISTRATIVE_BUDGET_VW aob, Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Tag_Taxonomy_Group_tb tag where aob.obligation_entry_type = 'Plan Activity' and aob.obligation_year = kpa.yea_year and kna.kna_id = bip.kna_id and bip.bio_id = aob.obligation_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and kpd.tax_id_type = tag.tax_id_group_header and tag.tag_code = 'KCP' and knp.dep_id_department = dep.dep_id) as a) as executed_kcp_amount 
from     
    Kpa_Knl_Plan_Allocation_tb kpa,
    Dep_Department_tb dep,
    Kai_Knl_Plan_Allocation_Item_tb kai
where kpa.dep_id_department = dep.dep_id
    and kai.kpa_id_allocation = kpa.kpa_id
    and kpa.yea_year = 2012
group by dep.dep_id,dep.dep_name, kpa.yea_year) as a",
dbo,KNL_EVENTS_CAREERPOINT_VW,2011-10-26 18:00:52.653,2013-05-31 10:53:57.613,"CREATE VIEW [dbo].[KNL_EVENTS_CAREERPOINT_VW]
AS 
select ge.OUT_ID as event_id, ge.NAME as event_name, 
    isnull((select case when unt.dep_id_department in (54,76) or UNT.unt_name is null THEN 'IDB' ELSE UNT.unt_name END from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.out_id_outcome = ge.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id),'IDB') as event_unit,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/'+ convert(varchar,ge.OUT_ID) as event_url, 
    ge.OBJECTIVES as event_objectives, 
    ge.PRESENTATION_TYPE as event_type,
    CASE WHEN ISNULL(dbo.getLanguagesByOutput(ge.OUT_ID),'') = '' THEN 'English' ELSE dbo.getLanguagesByOutput(ge.OUT_ID) END as event_languages,
    ge.PUBLISHED_DATE as event_published_date,
    ge.TOTAL_DURATION as event_duration,
    ge.CREATED_DATE as event_created_date,
    CONVERT(VARCHAR,ge.START_DATE,1) as event_start_date,
    CONVERT(VARCHAR,ge.START_DATE,108) as event_start_time,
    CONVERT(VARCHAR,ge.END_DATE,1) as event_end_date,
    ge.PRIVATE_REGISTRATION as restricted_flag,
    case when ge.PUBLISHED_DATE <= getdate() and ge.DEADLINE >= getDate() and ge.START_DATE >= getDate() and ge.deleted_date is null then 1 else 0 end as active_flag,
    ISNULL(GE.LAST_UPDATED_DATE,GE.CREATED_DATE) as last_updated_date,
    GE.DELETED_DATE as deleted_date
from OUT_GENERAL_EVENT_VW ge
WHERE GE.CREATED_DATE >= 2012
UNION ALL -- moodle events
select me.OUT_ID as event_id, me.NAME as event_name, 
    isnull((select case when unt.dep_id_department in (54,76) or UNT.unt_name is null  THEN 'IDB' ELSE UNT.unt_name END from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.out_id_outcome = me.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id),'IDB') as event_unit,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/'+ convert(varchar,me.OUT_ID) as event_url, 
    me.OBJECTIVES as event_objectives, 
    me.PRESENTATION_TYPE as event_type,
    CASE WHEN ISNULL(dbo.getLanguagesByOutput(me.OUT_ID),'') = '' THEN 'English' ELSE dbo.getLanguagesByOutput(me.OUT_ID) END as event_languages,
    me.PUBLISHED_DATE as event_published_date,
    me.TOTAL_DURATION as event_duration,
    me.CREATED_DATE as event_created_date,
    CONVERT(VARCHAR,me.START_DATE,1) as event_start_date,
    CONVERT(VARCHAR,me.START_DATE,108) as event_start_time,
    CONVERT(VARCHAR,me.END_DATE,1) as event_end_date,
    me.PRIVATE_REGISTRATION as restricted_flag,
    case when me.PUBLISHED_DATE <= getdate() and me.DEADLINE >= getDate() and me.START_DATE >= getDate() and me.deleted_date is null  then 1 else 0 end as active_flag,
    ISNULL(ME.LAST_UPDATED_DATE,ME.CREATED_DATE) as last_updated_date,
    ME.DELETED_DATE as deleted_date
from OUT_MOODLE_EVENT_VW me
WHERE ME.CREATED_DATE >= 2012
UNION ALL -- LANGUAGE GROUP EVENTS
select lg.OUT_ID , lg.NAME , 
    isnull((select  case when unt.dep_id_department in (54,76) or UNT.unt_name is null  THEN 'IDB' ELSE UNT.unt_name END from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.out_id_outcome = lg.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id),'IDB') as event_unit,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/'+ convert(varchar,lg.OUT_ID) , 
    lg.OBJECTIVES , 
    lg.PRESENTATION_TYPE ,
    CASE WHEN ISNULL(dbo.getLanguagesByOutput(lg.OUT_ID),'') = '' THEN 'English' ELSE dbo.getLanguagesByOutput(lg.OUT_ID) END as event_languages,
    lg.PUBLISHED_DATE ,
    lg.TOTAL_DURATION,
    lg.CREATED_DATE as event_created_date,
    isnull(CONVERT(VARCHAR,lg.START_DATE,1),'N/A') ,
    isnull(CONVERT(VARCHAR,lg.START_DATE,108),'N/A') as event_start_time,
    isnull(CONVERT(VARCHAR,lg.END_DATE,1),'N/A') ,
    lg.PRIVATE_REGISTRATION as restricted_flag,
    case when lg.PUBLISHED_DATE <= getdate() and lg.DEADLINE >= getDate() and lg.START_DATE >= getDate()  and lg.deleted_date is null then 1 else 0 end as active_flag,
    ISNULL(LG.LAST_UPDATED_DATE,LG.CREATED_DATE) as last_updated_date,
    LG.DELETED_DATE as deleted_date
from OUT_LANGUAGE_GROUP_EVENT_VW lg
WHERE lg.CREATED_DATE >= 2012
UNION ALL -- SELFLEANING EVENTS
select ms.OUT_ID , ms.NAME , 
    isnull((select  case when unt.dep_id_department in (54,76) or UNT.unt_name is null  THEN 'IDB' ELSE UNT.unt_name END from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.out_id_outcome = ms.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id),'IDB') as event_unit,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/'+ convert(varchar,ms.OUT_ID) , 
    ms.OBJECTIVES , 
    ms.PRESENTATION_TYPE ,
    CASE WHEN ISNULL(dbo.getLanguagesByOutput(ms.OUT_ID),'') = '' THEN 'English' ELSE dbo.getLanguagesByOutput(ms.OUT_ID) END as event_languages,
    ms.PUBLISHED_DATE ,
    ms.TOTAL_DURATION,
    ms.CREATED_DATE as event_created_date,
    isnull(CONVERT(VARCHAR,ms.START_DATE,1),'01/01/'+SUBSTRING(convert(VARCHAR,YEAR(ms.CREATED_DATE)),3,2)) as event_start_Date,
    isnull(CONVERT(VARCHAR,ms.START_DATE,108),'00:00:00') as event_start_time,
    isnull(CONVERT(VARCHAR,ms.END_DATE,1),'12/31/'+SUBSTRING(convert(VARCHAR,YEAR(ms.CREATED_DATE)),3,2)),
    ms.PRIVATE_REGISTRATION as restricted_flag,
    case when ms.PUBLISHED_DATE <= getdate() and ms.ACTIVE_FLAG = 1 and isnull(ms.START_DATE,getDate()) >= getDate() and ms.deleted_date is null   then 1 else 0 end as active_flag,
    ISNULL(MS.LAST_UPDATED_DATE,MS.CREATED_DATE) as last_updated_date,
    MS.DELETED_DATE as deleted_date
from OUT_GENERAL_SERVICE_VW ms
WHERE ms.CREATED_DATE >= 2012
UNION ALL -- MOODLE SELFLEANING EVENTS
select ms.OUT_ID , ms.NAME , 
    isnull((select  case when unt.dep_id_department in (54,76) or UNT.unt_name is null  THEN 'IDB' ELSE UNT.unt_name END from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.out_id_outcome = ms.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id),'IDB') as event_unit,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/'+ convert(varchar,ms.OUT_ID) , 
    ms.OBJECTIVES , 
    ms.PRESENTATION_TYPE ,
    CASE WHEN ISNULL(dbo.getLanguagesByOutput(ms.OUT_ID),'') = '' THEN 'English' ELSE dbo.getLanguagesByOutput(ms.OUT_ID) END as event_languages,
    ms.PUBLISHED_DATE ,
    ms.TOTAL_DURATION,
    ms.CREATED_DATE as event_created_date,
    isnull(CONVERT(VARCHAR,ms.START_DATE,1),'01/01/'+SUBSTRING(convert(VARCHAR,YEAR(ms.CREATED_DATE)),3,2)) as event_start_Date,
    isnull(CONVERT(VARCHAR,ms.START_DATE,108),'00:00:00') as event_start_time,
    isnull(CONVERT(VARCHAR,ms.END_DATE,1),'12/31/'+SUBSTRING(convert(VARCHAR,YEAR(ms.CREATED_DATE)),3,2)),
    ms.PRIVATE_REGISTRATION as restricted_flag,
    case when ms.PUBLISHED_DATE <= getdate() and ms.ACTIVE_FLAG = 1 and isnull(ms.START_DATE,getDate()) >= getDate() and ms.deleted_date is null   then 1 else 0 end as active_flag,
    ISNULL(MS.LAST_UPDATED_DATE,MS.CREATED_DATE) as last_updated_date,
    MS.DELETED_DATE as deleted_date
from OUT_MOODLE_SERVICE_VW ms
WHERE ms.CREATED_DATE >= 2012
UNION ALL -- LANGUAGE PRIVATE/SEMIPRIVATE EVENTS
select ls.OUT_ID , ls.NAME , 
    isnull((select  case when unt.dep_id_department in (54,76) or UNT.unt_name is null  THEN 'IDB' ELSE UNT.unt_name END from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.out_id_outcome = ls.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id),'IDB') as event_unit,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/'+ convert(varchar,ls.OUT_ID) , 
    ls.OBJECTIVES , 
    ls.PRESENTATION_TYPE ,
    CASE WHEN ISNULL(dbo.getLanguagesByOutput(ls.OUT_ID),'') = '' THEN 'English' ELSE dbo.getLanguagesByOutput(ls.OUT_ID) END as event_languages,
    ls.PUBLISHED_DATE ,
    ls.TOTAL_DURATION,
    ls.CREATED_DATE as event_created_date,
    isnull(CONVERT(VARCHAR,ls.START_DATE,1),'01/01/'+SUBSTRING(convert(VARCHAR,YEAR(ls.CREATED_DATE)),3,2)) as event_start_Date,
    isnull(CONVERT(VARCHAR,ls.START_DATE,108),'00:00:00') as event_start_time,
    isnull(CONVERT(VARCHAR,ls.END_DATE,1),'12/31/'+SUBSTRING(convert(VARCHAR,YEAR(ls.CREATED_DATE)),3,2)),
    ls.PRIVATE_REGISTRATION as restricted_flag,
    case when ls.PUBLISHED_DATE <= getdate() and ls.ACTIVE_FLAG = 1 and isnull(ls.START_DATE,getDate()) >= getDate() and ls.deleted_date is null   then 1 else 0 end as active_flag,
    ISNULL(LS.LAST_UPDATED_DATE,LS.CREATED_DATE) as last_updated_date,
    LS.DELETED_DATE as deleted_date
from OUT_LANGUAGE_SERVICE_VW ls
WHERE ls.CREATED_DATE >= 2012
UNION ALL -- COLLABORATIVE LEARNING
select ls.OUT_ID , ls.NAME , 
    isnull((select  case when unt.dep_id_department in (54,76) or UNT.unt_name is null  THEN 'IDB' ELSE UNT.unt_name END from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.out_id_outcome = ls.OUT_ID and aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id),'IDB') as event_unit,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/'+ convert(varchar,ls.OUT_ID) , 
    ls.OBJECTIVES , 
    ls.PRESENTATION_TYPE ,
    CASE WHEN ISNULL(dbo.getLanguagesByOutput(ls.OUT_ID),'') = '' THEN 'English' ELSE dbo.getLanguagesByOutput(ls.OUT_ID) END as event_languages,
    ls.PUBLISHED_DATE ,
    ls.TOTAL_DURATION,
    ls.CREATED_DATE as event_created_date,
    isnull(CONVERT(VARCHAR,ls.START_DATE,1),'01/01/'+SUBSTRING(convert(VARCHAR,YEAR(ls.CREATED_DATE)),3,2)) as event_start_Date,
    isnull(CONVERT(VARCHAR,ls.START_DATE,108),'00:00:00') as event_start_time,
    isnull(CONVERT(VARCHAR,ls.END_DATE,1),'12/31/'+SUBSTRING(convert(VARCHAR,YEAR(ls.CREATED_DATE)),3,2)),
    ls.PRIVATE_REGISTRATION as restricted_flag,
    case when ls.PUBLISHED_DATE <= getdate() and ls.ACTIVE_FLAG = 1 and isnull(ls.START_DATE,getDate()) >= getDate() and ls.deleted_date is null   then 1 else 0 end as active_flag,
    ISNULL(LS.LAST_UPDATED_DATE,LS.CREATED_DATE) as last_updated_date,
    LS.DELETED_DATE as deleted_date
from OUT_COLLABORATIVE_LEARNING_VW ls
WHERE ls.CREATED_DATE >= 2012",
dbo,knl_history_user,2017-05-17 13:20:10.933,2017-05-17 13:20:10.933,"create view knl_history_user as
SELECT
	reg.reg_id as regId,
	reg.reg_created_date as createdDate,
	year(reg.reg_created_date) as year,
	dbo.knlPortalServices_getStartDateByOutId(reg.out_id_outcome) as startDate,
	dbo.knlPortalServices_getEndDateByOutId(reg.out_id_outcome) as endDate,
	case dbo.knlPortalServices_getOutputTypeByOutId(reg.out_id_outcome) 
		when 'EVT_GENERAL' then 'General Event'
		when 'EVT_LANGUAGE' then 'Language Group Event'
		when 'EVT_MOODLE' then 'INDES Virtual'
		when 'OUT_EXTERNAL_EVENT' then 'External Event'
		when 'SRV_COLLABORATIVE' then 'Collaborative Learning'
		when 'SRV_GENERAL' then 'Self-Learning'
		when 'SRV_LANGUAGE' then 'Language Individual'
		when 'SRV_MOODLE' then 'INDES Self-Learning'
	end outputType,
	case reg.reg_participation_type 
		when 'ARTICLE' then 'Articles'
		when 'BOOK' then 'Books'
		when 'CERTIFICAT' then 'Certifications'
		when 'CI_APPS' then 'Creation and Installation of Apps'
		when 'COMM_PRAC' then 'Communities of Practice'
		when 'DB_REPORT' then 'Databases (produced by the Bank)'
		when 'EMAIL_UA' then 'Email Updates, Alerts'
		when 'EXTERNAL_P' then 'External Provider'
		when 'EXT_DB' then 'External Databases'
		when 'FACE_TO_FA' then 'Face-to-Face, External Provider'
		when 'FACE_TO_FO' then 'Face-to-Face, IDB Designed'
		when 'FIPC' then 'FHL Management of IDB Publications'
		when 'NEWSPAPERS' then 'Newspapers'
		when 'OUT_FACE_TO_FACE' then 'Face to Face'
		when 'OUT_SELF_LEARNING' then 'Self Learning'
		when 'OUT_VIRTUAL' then 'Virtual'
		when 'OUT_WEBINAR' then 'Webinar'
		when 'PEER_TO_PE' then 'Peer-to-Peer Learning'
		when 'PERIODICAL' then 'Periodicals'
		when 'POR_INTER' then 'Portals: Internet, Extranet'
		when 'POR_INTRA' then 'Portals: Intranet'
		when 'REG_FACE_TO_FACE' then 'Face to Face'
		when 'REG_ONLINE' then 'Online'
		when 'REPORT' then 'Reports'
		when 'SELF_LEARN' then 'Self-Learning'
		when 'SELF_LEARNING_MOODLE' then 'INDES Virtual Self-Learning'
		when 'TECH_NOTE' then 'Technical Notes'
		when 'VIRTUAL_WT' then 'Virtual with Tutor'
		when 'WEBINAR' then 'Webinar'
	end as participationType,
	concat(reg.out_id_outcome, ' - ', dbo.knlPortalServices_getOutputNameByOutId(reg.out_id_outcome)) outId,
	dbo.knlPortalServices_getDurationByOutId(reg.out_id_outcome) as duration,
	case SUBSTRING ( reg.reg_flow_status_code ,16,1) 
		when 'A' then 'Approved'
		when 'D' then 'Denied'
		when 'P' then 'Pending'
	end as flowStatusCode,
	per.per_id
FROM
	Reu_Registration_User_tb reu,
	Reg_Registration_tb reg ,
	Usr_User_tb usr,
	Per_Person_tb per
where
	reu.reg_id = reg.reg_id and
	reu.usr_id = usr.usr_id and
	usr.per_id_person = per.per_id and
	reg.reg_deleted_flag=0",
dbo,KNL_PLANS_2013,2013-03-19 15:34:19.597,2013-03-19 15:34:19.597,"CREATE VIEW [dbo].[KNL_PLANS_2013]
AS 
SELECT *
FROM OUT_OUTPUT_VW O,
    ACT_ACTIVITIES_VW A
WHERE O.KNA_ID = A.activityID
    AND A.yea_year = 2013",
dbo,KNL_REGISTRATIONS_CAREERPOINT_VW,2012-11-27 15:48:47.677,2013-01-22 14:52:04.260,"CREATE VIEW [dbo].[KNL_REGISTRATIONS_CAREERPOINT_VW]
AS 
SELECT A.REG_ID, A.OUT_ID, A.FIRST_NAME, A.MIDDLE_NAME, A.LAST_NAME, A.EMAIL, A.PCMAIL AS EMAILID, A.CREATED_DATE, A.SHOWUP_FLAG, A.DELETED_DATE, 
    CASE WHEN OUT_TYPE = 'OUT_GENERAL_EVENT' THEN (SELECT EVT.evt_end_date FROM Evt_Event_tb EVT WHERE EVT.out_id = A.OUT_ID) 
         WHEN OUT_TYPE = 'OUT_EXTERNAL_EVENT' THEN (SELECT EXT.ext_end_date FROM Ext_External_Event_tb EXT WHERE EXT.out_id = A.OUT_ID) 
         WHEN OUT_TYPE = 'OUT_GENERAL_SERVICE' THEN (SELECT isNull(SRV.srv_end_date, A.created_date) FROM Srv_Service_tb SRV WHERE SRV.out_id = A.OUT_ID)
    ELSE getDate()
    END AS END_DATE
FROM
    (select r.REG_ID, r.OUT_ID, r.FIRST_NAME, r.MIDDLE_NAME, r.LAST_NAME, r.EMAIL, r.PCMAIL, r.CREATED_DATE, r.SHOWUP_FLAG, r.DELETED_DATE,
        (select o.out_type from Out_Outcome_tb o where o.out_id = r.OUT_ID) as OUT_TYPE
    from REG_REGISTRATION_USER_VW r
    where r.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
        and r.EMPLOYEE_TYPE = 'STAFF'
        and YEAR(r.CREATED_DATE) >= 2012    
    union all
    select r.REG_ID, r.OUT_ID, r.FIRST_NAME, r.MIDDLE_NAME, r.LAST_NAME, r.EMAIL, r.PCMAIL, r.CREATED_DATE, r.SHOWUP_FLAG, r.DELETED_DATE,
        (select o.out_type from Out_Outcome_tb o where o.out_id = r.OUT_ID) as OUT_TYPE
    from REG_LANGUAGE_USER_VW r
    where r.STATUS_CODE = 'REG_SUPERVISOR_APPROVED'
        and r.EMPLOYEE_TYPE = 'STAFF'
        and YEAR(r.CREATED_DATE) >= 2012
    ) AS A,
    Usr_User_tb USR
WHERE A.PCMAIL = USR.USR_PCMAIL
    AND USR.USR_ACTIVE_FLAG = 1",
dbo,knlplatform_ongoing_view,2016-09-07 17:01:40.043,2016-09-08 11:00:43.383,"CREATE VIEW [dbo].[knlplatform_ongoing_view]
AS

SELECT
	v.*
FROM
	knlplatform_sortable_view v
WHERE
    v.SORTDATE < getDate()",
dbo,knlplatform_search_view,2016-08-10 13:46:52.380,2017-07-28 13:10:07.190,"CREATE VIEW [dbo].[knlplatform_search_view]
AS 
SELECT
	o.out_id as ID,
    isNull(omdt.omdt_title,o.out_name) as TITLE,
    dbo.knlPortalServices_getStartDateByOutType(o.out_type,o.out_id) as STARTDATE,
    dbo.knlPortalServices_getEndDateByOutType(o.out_type,o.out_id) as ENDDATE,
    dbo.knlPortalServices_getDeadlineByOutputType(o.out_type,o.out_id) as DEADLINEDATE,
    dbo.knlPortalServices_getRegistrationStatusi18n(o.out_type,o.out_id,omdt.omdt_lng_id) as REGISTRATIONSTATUS,
    dbo.knlPortalServices_getLanguagesByOutIdi18n(o.out_id,omdt.omdt_lng_id) as LANGUAGE,
    dbo.knlPortalServices_getModalityForLPi18n(o.out_modality,omdt.omdt_lng_id) AS COURSETYPE,
	isNull(omdt.omdt_cost_type,'') AS COSTTYPE,
	isNull(omdt.omdt_search_image,'') AS IMAGEURL,
	isNull(omdt.omdt_search_image,'') AS IMAGEURL_SEARCH,
	isNull(omdt.omdt_image_banner_medium,'') AS IMAGEURL_BANNER_MEDIUM,
	isNull(omdt.omdt_image_banner_large,'') AS IMAGEURL_BANNER_LARGE,
	dbo.knlPortalServices_getReviewsAVGByProgramOutId(o.out_id) AS RATING,
    omd.omd_featured_flag AS FEATUREDFLAG,
	isNull(omdt.omdt_cost_text,0.00) AS COST,
    omdt.omdt_lng_id AS LNG_ID
FROM
	Out_Outcome_tb o,
	Omd_Output_Metadata_tb omd,
	Omdt_OutputMetadata_Translation_tb omdt 
WHERE
	o.out_id = omd.out_id_output AND
	omd.omd_id = omdt.omdt_omd_id AND
	omdt.omdt_status='OMD_PUBLISHED'",
dbo,knlplatform_sortable_oear_view,2017-06-26 13:21:50.123,2017-06-26 13:21:50.123,"CREATE VIEW [dbo].[knlplatform_sortable_oear_view]
AS
SELECT
	v.* ,
    v.STARTDATE as SORTDATE
FROM
	knlplatform_search_view v 
WHERE
	v.COURSETYPE=dbo.knlPortalServices_getParameterByCode('MOOC')

UNION ALL

SELECT
	v.* ,
    v.DEADLINEDATE as SORTDATE
FROM
	knlplatform_search_view v 
WHERE
	v.COURSETYPE IN (dbo.knlPortalServices_getParameterByCode('F2F'),
	                 dbo.knlPortalServices_getParameterByCode('F2F_ES'),
	                 dbo.knlPortalServices_getParameterByCode('TUTOR'),
	                 dbo.knlPortalServices_getParameterByCode('TUTOR_ES'))
	                 

UNION ALL

SELECT
	v.* ,
    v.ENDDATE AS SORTDATE
FROM
	knlplatform_search_view v 
WHERE
	v.COURSETYPE in (dbo.knlPortalServices_getParameterByCode('SLFP'),
	                 dbo.knlPortalServices_getParameterByCode('SLFP_ES')) 
	             and v.id not in(select out_id from dbo.knlPortalServices_out_oear_tb where kps_active_flag=1)",
dbo,knlplatform_sortable_view,2016-09-08 10:59:43.790,2017-06-06 11:10:47.907,"CREATE VIEW [dbo].[knlplatform_sortable_view]
AS
SELECT
	v.* ,
    v.STARTDATE as SORTDATE
FROM
	knlplatform_search_view v 
WHERE
	v.COURSETYPE=dbo.knlPortalServices_getParameterByCode('MOOC')

UNION ALL

SELECT
	v.* ,
    v.DEADLINEDATE as SORTDATE
FROM
	knlplatform_search_view v 
WHERE
	v.COURSETYPE IN (dbo.knlPortalServices_getParameterByCode('F2F'),
	                 dbo.knlPortalServices_getParameterByCode('F2F_ES'),
	                 dbo.knlPortalServices_getParameterByCode('TUTOR'),
	                 dbo.knlPortalServices_getParameterByCode('TUTOR_ES'))
	                 

UNION ALL

SELECT
	v.* ,
    v.ENDDATE AS SORTDATE
FROM
	knlplatform_search_view v 
WHERE
	v.COURSETYPE in (dbo.knlPortalServices_getParameterByCode('SLFP'),
	                 dbo.knlPortalServices_getParameterByCode('SLFP_ES'))",
dbo,knlplatform_upcoming_view,2016-09-07 16:41:28.930,2016-09-08 11:01:18.293,"CREATE VIEW [dbo].[knlplatform_upcoming_view]
AS

SELECT
	v.*
FROM
	knlplatform_sortable_view v
WHERE
    v.SORTDATE >= getDate()",
dbo,LNG_LANGUAGE_ALL_REGISTRATIONS,2017-04-24 17:38:53.687,2017-04-24 17:38:53.687,"CREATE VIEW [dbo].[LNG_LANGUAGE_ALL_REGISTRATIONS]
AS 
select * from dbo.REU_ALL_EMPLOYEE_REGISTRATIONS where eventType='EVT_LANGUAGE' or serviceType='SRV_LANGUAGE'",
dbo,MAN_MANAGERS_VW,2015-08-18 10:53:33.673,2015-08-18 11:19:16.113,"CREATE VIEW [dbo].[MAN_MANAGERS_VW]
AS 
SELECT sec.sec_name, dep.dep_name, man.*
FROM Sec_Section_tb sec, Dep_Department_tb DEP LEFT OUTER JOIN 
                (select dep.dep_id, per.per_first_name, per.per_middle_name, per.per_last_name, usr.usr_pcmail, usr.usr_title
                from Dep_Department_tb dep,
                    Per_Person_tb per,
                    Usr_User_tb usr,
                    Unt_Unit_tb unt
                where dep.per_id_manager = per.per_id
                    and usr.per_id_person = per.per_id
                    and usr.unt_id_unit = unt.unt_id
                    and usr.usr_active_flag = 1) AS MAN ON MAN.dep_id = dep.dep_id
where dep.dep_active_flag = 1
    and sec.sec_id = dep.sec_id_section",
dbo,NAB_NOT_APPROVED_NEEDS_BWP_VW,2010-06-12 14:56:58.297,2012-06-30 11:17:28.510,"CREATE VIEW [dbo].[NAB_NOT_APPROVED_NEEDS_BWP_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    case when SUM(a.programmed_amount) > sum(a.kna_disbursed) then SUM(a.programmed_amount) else sum(a.kna_disbursed) end as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT kna.kna_id,
			   kna.ops_id_opus,
               (SELECT isNull((kna.kna_knl_percentage * SUM(kpb.kpb_item_cost))/100,0) FROM Kpb_Knl_Plan_Budget_tb kpb WHERE kpb.kna_id = kna.kna_id) AS kna_amount,
               (SELECT isNull(sum(obg.obg_knl_amount),0) as programmed_amount from Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, Aao_Available_Activity_Outcome_tb aao where obg.obg_entry_type = 'OBG_LIAISON' and out.out_id = obg.out_id_outcome and obg.out_id_outcome = aao.out_id_outcome and out.out_deleted_flag = 0 and aao.kna_id_activity = kna.kna_id) as programmed_amount,
               (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed		
        FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'NEE' AND
			kna.kna_deleted_date IS NULL AND
            kpd.kpd_deleted_date is null AND
			kna.kna_selected_flag = 0 AND
			knp.yea_year = 2010 AND
			knp.dep_id_department IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,NAC_NOT_APPROVED_CONTRIBUTIONS_VW,2010-06-12 14:53:32.083,2012-06-30 11:17:28.477,"CREATE VIEW [dbo].[NAC_NOT_APPROVED_CONTRIBUTIONS_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    case when SUM(a.programmed_amount) > sum(a.kna_disbursed) then SUM(a.programmed_amount) else sum(a.kna_disbursed) end as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT
			kna.kna_id,
			kna.ops_id_opus,
			kna.kna_approved_amount AS kna_amount,
            (SELECT isNull(sum(obg.obg_knl_amount),0) as programmed_amount from Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, Aao_Available_Activity_Outcome_tb aao where obg.obg_entry_type = 'OBG_LIAISON' and out.out_id = obg.out_id_outcome and obg.out_id_outcome = aao.out_id_outcome and out.out_deleted_flag = 0 and aao.kna_id_activity = kna.kna_id) as programmed_amount,
            (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed
		FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'CON' AND
			kna.kna_deleted_date IS NULL AND
            kpd.kpd_deleted_date is null AND
			kna.kna_approved_flag = 0 AND
			knp.yea_year = 2010 AND
			knp.dep_id_department NOT IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,NAK_NOT_APPROVED_KCPS_VW,2010-06-12 14:54:26.803,2012-06-30 11:17:28.480,"CREATE VIEW [dbo].[NAK_NOT_APPROVED_KCPS_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    case when SUM(a.programmed_amount) > sum(a.kna_disbursed) then SUM(a.programmed_amount) else sum(a.kna_disbursed) end as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT
			kna.kna_id,
			kna.ops_id_opus,
			kna.kna_approved_amount AS kna_amount,
            (SELECT isNull(sum(obg.obg_knl_amount),0) as programmed_amount from Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, Aao_Available_Activity_Outcome_tb aao where obg.obg_entry_type = 'OBG_LIAISON' and out.out_id = obg.out_id_outcome and obg.out_id_outcome = aao.out_id_outcome and out.out_deleted_flag = 0 and aao.kna_id_activity = kna.kna_id) as programmed_amount,
            (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed
		FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'KCP' AND
			kna.kna_deleted_date IS NULL AND
            kpd.kpd_deleted_date is null AND
			kna.kna_approved_flag = 0 AND
			knp.yea_year = 2010 AND
			knp.dep_id_department NOT IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,NAN_NOT_APPROVED_NEEED_VW,2010-06-12 14:51:31.120,2012-06-30 11:17:28.470,"CREATE VIEW [dbo].[NAN_NOT_APPROVED_NEEED_VW]
AS 
SELECT
	ops.ops_activity_code as opus_code,
	COUNT (a.kna_id) as activity_count,
	SUM(a.kna_amount) as approved_amount,
    case when SUM(a.programmed_amount) > sum(a.kna_disbursed) then SUM(a.programmed_amount) else sum(a.kna_disbursed) end as programmed_amount,
    sum(a.kna_disbursed) as disbursed_amount
FROM
	(	SELECT kna.kna_id,
			   kna.ops_id_opus,
               (SELECT isNull((kna.kna_knl_percentage * SUM(kpb.kpb_item_cost))/100,0) FROM Kpb_Knl_Plan_Budget_tb kpb WHERE kpb.kna_id = kna.kna_id) AS kna_amount,
               (SELECT isNull(sum(obg.obg_knl_amount),0) as programmed_amount from Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, Aao_Available_Activity_Outcome_tb aao where obg.obg_entry_type = 'OBG_LIAISON' and out.out_id = obg.out_id_outcome and obg.out_id_outcome = aao.out_id_outcome and out.out_deleted_flag = 0 and aao.kna_id_activity = kna.kna_id) as programmed_amount,
               (select isNull(sum(a.bio_debit_amount),0) - isNull(sum(a.bio_credit_amount),0)
from (
    (select 
        aao.kna_id_activity as kna_id, 
        sum(bio.bio_item_cost) as bio_debit_amount,
        0 as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_DEBIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity
    union
    select 
        aao.kna_id_activity as kna_id, 
        0 as bio_debit_amount,
        sum(bio.bio_item_cost) as bio_credit_amount
     from 
        Bio_Budget_Item_Obligated bio, 
        Boo_Budget_Item_Operational boo, 
        Obc_Outcome_Budget_Category_tb obc, 
        Obg_Outcome_Budget_tb obg, Out_Outcome_tb out, 
        Aao_Available_Activity_Outcome_tb aao 
    where 
        boo.bio_id = bio.bio_id and 
        boo.obc_id_outcome_budget_category = obc.obc_id and 
        obc.obg_id_outcome_budget = obg.obg_id and 
        obg.out_id_outcome = out.out_id and 
        aao.out_id_outcome = out.out_id and 
        bio.bio_deleted_date is null and 
        out.out_deleted_flag = 0 and 
        bio.bio_entry_type = 'BIO_OPERATIONAL' and
        bio.bio_accounting_type = 'BIO_CREDIT' and
        aao.kna_id_activity = kna.kna_id 
    group by aao.kna_id_activity) 
    union 
        (select 
            bip.kna_id, 
            sum (bio.bio_item_cost) as bio_debit_amount,
            0 as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_DEBIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id
        union
        select 
            bip.kna_id, 
            0 as bio_debit_amount,
            sum (bio.bio_item_cost) as bio_credit_amount
        from Bio_Budget_Item_Obligated bio, 
            Bip_Budget_Item_Plan_Activity_tb bip 
        where bio.bio_deleted_date is null and 
            bio.bio_id = bip.bio_id and 
            bip.kna_id = kna.kna_id and
            bio.bio_accounting_type = 'BIO_CREDIT' and
            bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' 
        group by bip.kna_id)) as a 
    group by a.kna_id) as kna_disbursed		
        FROM
			Kna_Knl_Plan_Activity_tb kna,
			Kpd_Knl_Plan_Deliverable_tb kpd,
			Knd_Knl_Plan_Division_tb knd,
			Knp_Knl_Plan_Department_tb knp,
			Tag_Taxonomy_Group_tb tag 
		WHERE
			kna.kpd_id_deliverable = kpd.kpd_id AND
			kpd.knd_id_division = knd.knd_id AND
			knd.knp_id_plan_department = knp.knp_id AND
			tag.tax_id_group_header = kpd.tax_id_type AND
			tag.tag_code = 'NEE' AND
			kna.kna_deleted_date IS NULL AND
            kpd.kpd_deleted_date is null AND
			kna.kna_selected_flag = 0 AND
			knp.yea_year = 2010 AND
			knp.dep_id_department NOT IN (54) 
	)
	AS a,
	Ops_Opus_tb ops 
WHERE
	a.ops_id_opus = ops.ops_id 
GROUP BY
	ops.ops_activity_code",
dbo,OAP_OUTPUT_ACTIVITY_PLAN_VW,2014-05-08 11:12:19.783,2014-05-08 11:12:19.783,"CREATE VIEW [dbo].[OAP_OUTPUT_ACTIVITY_PLAN_VW]
AS 

select a.yea_year, a.secId, a.secName, a.depName, a.depId, a.unit, a.unitId, a.componentType, a.deliverableName, a.activityName, a.activityBK, a.activity_status, a.unitAmount, a.knlAmount, a.otherAmount,
    a.knlStatus, a.knlApprovedAmount, a.knp_id, a.knd_id,
    o.OUT_ID, o.NAME, o.OBJECTIVES, o.COMMENTS, o.MODALITY, o.PRESENTATION_TYPE, o.SUBJECT_TYPE, o.OPUS_CODE, o.OUT_TYPE, o.LOCATION_TYPE, o.LOCATION_NAME, o.LOCATION_CITY, o.OUT_STATUS_CODE,
    o.LOGISTICS_FLAG, o.START_DATE, o.END_DATE, o.MAX_PARTICIPANTS, o.TOTAL_PARTICIPANTS, o.TOTAL_DURATION, o.ESTIMATED_TOTAL_COST, o.AUDIENCE 
from Aao_Available_Activity_Outcome_tb aao,
    OUT_OUTPUT_VW o,
    ACT_ACTIVITIES_VW a
where aao.out_id_outcome = o.OUT_ID
    AND aao.kna_id_activity = a.activityID",
dbo,OBA_OUTPUTS_BALANCE_VW,2010-12-09 15:02:19.763,2012-06-30 11:17:28.723,"CREATE VIEW [dbo].[OBA_OUTPUTS_BALANCE_VW]
AS 
select 
    -- OUTPUTS CON BALANCE MAYOR QUE CERO
    a.OUT_ID,
    a.KNA_ID_ACTIVITY as kna_id,
    a.depName,
    a.unit,
    a.yea_year,
    a.OUTPUT_TYPE,
    a.OUT_NAME,
    --Convert start date (string) in datetime
    cast(a.START_DATE as datetime) as START_DATE,
    cast(a.END_DATE as datetime) as END_DATE,
    a.ACTIVITY_CODE as opus_code,
    dbo.getKNLOfficersByOutcome(a.OUT_ID) as knlOfficer,
    a.out_budget_officer_closed_date as closed_officer,
    a.out_budget_officer_closed_date as closed_date,
    a.out_budget_officer_closed_flag as closed_flag,
    a.programmed_amount,
    a.OBLIGATED_AMOUNT,
    a.programmed_amount - a.OBLIGATED_AMOUNT as balance_amount
from
(select 
    o.*,
    act.*,
    case 
        WHEN o.OUT_BUDGET_OFFICER_CLOSED_FLAG = 1 then 
            o.OBLIGATED_AMOUNT
        else
            case
                when o.OBG_KNL_AMOUNT > o.OBLIGATED_AMOUNT then o.OBG_KNL_AMOUNT else o.OBLIGATED_AMOUNT end 
        end as programmed_amount
from OUA_OUTCOME_ACTIVITY_VW o,
    ACT_ACTIVITIES_VW act
where act.activityID = o.KNA_ID_ACTIVITY
    and act.yea_year >= 2010
    and act.activity_status = 'Approved'
    and act.componentType = 'Need'
union all
select 
    o.*,
    act.*,
    case 
        WHEN o.OUT_BUDGET_OFFICER_CLOSED_FLAG = 1 then 
            o.OBLIGATED_AMOUNT
        else
            case
                when o.OBG_KNL_AMOUNT > o.OBLIGATED_AMOUNT then o.OBG_KNL_AMOUNT else o.OBLIGATED_AMOUNT end 
        end as programmed_amount
from OUA_OUTCOME_ACTIVITY_VW o,
    ACT_ACTIVITIES_VW act
where act.activityID = o.KNA_ID_ACTIVITY
    and act.yea_year >= 2010
    and act.activity_status = 'Approved'
    and act.knlStatus = 'KNL Approved'
    and act.componentType <> 'Need'
    and act.sourceOfFunding like 'KNL/002%'
    ) as a
where a.programmed_amount - a.OBLIGATED_AMOUNT > 0",
dbo,OBD_OPERATIONAL_BUDGET_VW,2010-05-14 15:13:56.903,2012-06-30 11:17:28.210,"CREATE VIEW [dbo].[OBD_OPERATIONAL_BUDGET_VW]
AS 
select
    --- OUTPUT
    out.out_id as output_id,
    aao.kna_id_activity as activity_id,
    (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as activity_department,
    (select unt.unt_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where kna.kna_id  = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as activity_unit,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header ) as activity_status,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header) as activity_approved_amount,
    CASE
        WHEN (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = aao.kna_id_activity)
    END as activity_type,
    (select tal2.tal_description from Tal_Taxonomy_Language_tb tal2 where tal2.tax_id = out.tax_id_presentation_type) as output_presentation_type,
    output_modality =
	case
		when out.out_modality = 'OUT_FACE_TO_FACE' then 'Face to Face'
		when out.out_modality = 'OUT_WEBINAR' then 'Webinar'
		when out.out_modality = 'OUT_VIRTUAL' then 'Virtual'
		when out.out_modality = 'OUT_SELF_LEARNING' then 'Self-Learning'
		else out.out_modality
	end,
	(select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as output_opus_code,
    output_type =
	case
		when out.out_type = 'OUT_EXTERNAL_EVENT' then 'External Event'
		when out.out_type = 'OUT_GENERAL_EVENT' then 'General Event'
		when out.out_type = 'OUT_GENERAL_SERVICE' then 'General Service'
		when out.out_type = 'OUT_KNOWLEDGE_PRODUCT' then 'Knowledge Product'
		else out.out_type
	end,
   (select unt.unt_name from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id and aao.out_id_outcome = out.out_id) as output_unit,
   out.out_created_date as output_created_date,
    obg.obg_knl_amount as output_budget_knl_amount,
    (select tal3.tal_description from Tal_Taxonomy_Language_tb tal3 where tal3.tax_id = obc.tax_id_category) as output_budget_category,
    obc.obc_item_cost as output_budget_category_amount,
    --- OBLIGATION
    bio.bio_id as obligation_id,
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		when bio.bio_entry_type = 'BIO_OPERATIONAL' then 'Operative'
		else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    consultant_id =
    case 
     when (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
    adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
   CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator, 
    --- EXECUTION
    bie.bie_id as execution_id,
    CASE 
        when bie.bie_accounting_type = 'BIE_CREDIT' then (bie.bie_item_cost * -1)
        else bie.bie_item_cost 
    END as execution_amount,
    bie.bie_invoice_date as execution_invoce_date,
    bie.bie_epay_flag as execution_epay_flag,
    bie.bie_description as execution_description,
    (select bip.kna_id from Bip_Budget_Item_Plan_Activity_tb bip where bip.bio_id  = bio.bio_id) as execution_plan_activity,
    (select tal1.tal_description from Tal_Taxonomy_Language_tb tal1 where tal1.tax_id = bie.tax_id_classification) as execution_classification,
    bie.bie_entry_date as execution_entry_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bie.per_id_creator) as execution_creator,
    bie.bie_last_updated_date as execution_last_updated_date,
    (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3 where per3.per_id = bie.per_id_updator) as execution_last_updator,
     bio.bio_lawson_date as lawson_date
from Bio_Budget_Item_Obligated bio left outer join  Bie_Budget_Item_Executed bie on bio.bio_id = bie.bio_id_budget_item_obligated,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops,
    Out_Outcome_tb out left outer join Aao_available_activity_outcome_tb aao on out.out_id = aao.out_id_outcome,
    Obg_Outcome_Budget_tb obg,
    Obc_Outcome_Budget_Category_tb obc,
    Boo_Budget_Item_Operational boo
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type in ('BIO_OPERATIONAL')
    and bio.bio_id = boo.bio_id
    and boo.obc_id_outcome_budget_category = obc.obc_id
    and obc.obg_id_outcome_budget = obg.obg_id
    and obg.out_id_outcome = out.out_id
    and obg.obg_entry_type = 'OBG_EXECUTED'
    and bio.bio_deleted_date is null
    and bie.bie_deleted_date is null",
dbo,OBK_OUTPUT_BREAKDOWN_VW,2010-11-29 14:52:02.817,2012-06-30 11:17:28.710,"CREATE VIEW [dbo].[OBK_OUTPUT_BREAKDOWN_VW]
AS 
SELECT
	'(KNA-' + CONVERT(VARCHAR, kna.kna_id) + ') ' AS knaId,
	tal.tal_description                           AS component,
	(	SELECT
			t.tal_description 
		FROM
			Tal_Taxonomy_Language_tb t 
		WHERE
			t.tax_id = kna.tax_id_source_funding 
	)
	AS source_funding,
	budgetItems.* 
FROM
	Kna_Knl_Plan_Activity_tb kna,
	Knd_Knl_Plan_Division_tb knd,
	Knp_Knl_Plan_Department_tb knp,
	Aao_Available_Activity_Outcome_tb aao,
	Tal_Taxonomy_Language_tb tal,
	Out_Outcome_tb OUT,
	Kpd_Knl_Plan_Deliverable_tb kpd,
	(	SELECT
			OUT.out_id                                                   AS 
			outId,
			'(OUT-' + CONVERT(VARCHAR, OUT.out_id) + ') ' + OUT.out_name AS 
			OUTPUT,
			CONVERT(VARCHAR(10), 
			CASE 
				WHEN OUT.out_type = 'OUT_EXTERNAL_EVENT' 
				THEN (	SELECT
							X.ext_start_date 
						FROM
							Ext_External_Event_tb X 
						WHERE
							X.out_id = OUT.OUT_ID 
				)
				WHEN OUT.out_type = 'OUT_GENERAL_EVENT' 
				THEN (	SELECT
							V.evt_start_Date 
						FROM
							Evt_Event_tb V 
						WHERE
							V.out_id = OUT.OUT_ID 
				)
				ELSE NULL 
			END, 101 )                            AS output_start_Date,
			CONVERT(VARCHAR(10), 
			CASE 
				WHEN OUT.out_type = 'OUT_EXTERNAL_EVENT' 
				THEN (	SELECT
							X.ext_end_date 
						FROM
							Ext_External_Event_tb X 
						WHERE
							X.out_id = OUT.OUT_ID 
				)
				WHEN OUT.out_type = 'OUT_GENERAL_EVENT' 
				THEN (	SELECT
							V.evt_end_Date 
						FROM
							Evt_Event_tb V 
						WHERE
							V.out_id = OUT.OUT_ID 
				)
				ELSE NULL 
			END, 101)                             AS output_end_Date,
			CASE obg.obg_entry_type 
				WHEN 'OBG_LATEST' 
				THEN 'Latest Total Cost' 
				WHEN 'OBG_LOGISTIC' 
				THEN 'Logistic' 
				ELSE 'Executed' 
			END                                                              AS 
			outputType,
			CASE obg.obg_entry_type 
				WHEN 'OBG_LATEST' 
				THEN 
				CASE obg.obg_knl_amount 
					WHEN 0 
					THEN 0 
					ELSE round((obc.obc_item_cost / obg.obg_knl_amount)*100,0) 
				END 
				ELSE 100 
			END                                                              AS 
			KNL_Percentage,
			tal.tal_description                                          AS 
			category,
			isnull(obc.obc_item_cost,0) cost 
		FROM
			Out_Outcome_tb OUT,
			Obg_Outcome_Budget_tb obg,
			Obc_Outcome_Budget_Category_tb obc,
			Tal_Taxonomy_Language_tb tal 
		WHERE
			OUT.out_id = obg.out_id_outcome AND
			obg.obg_id = obc.obg_id_outcome_budget AND
			obc.tax_id_category = tal.tax_id AND
			OUT.out_deleted_flag = 0 AND
			YEAR(OUT.out_publish_date) = 2012 AND
			(obg.obg_entry_type = 'OBG_LATEST' OR
			obg.obg_entry_type = 'OBG_LOGISTIC') 
		UNION
			ALL SELECT
					OUT.out_id                                                   
					AS outId,
					'(OUT-' + CONVERT(VARCHAR, OUT.out_id) + ') ' + OUT.out_name 
					AS OUTPUT,
					CONVERT(VARCHAR(10), 
					CASE 
						WHEN OUT.out_type = 'OUT_EXTERNAL_EVENT' 
						THEN (	SELECT
									X.ext_start_date 
								FROM
									Ext_External_Event_tb X 
								WHERE
									X.out_id = OUT.OUT_ID 
						)
						WHEN OUT.out_type = 'OUT_GENERAL_EVENT' 
						THEN (	SELECT
									V.evt_start_Date 
								FROM
									Evt_Event_tb V 
								WHERE
									V.out_id = OUT.OUT_ID 
						)
						ELSE NULL 
					END,101)                              AS output_start_Date,
					CONVERT(VARCHAR(10), 
					CASE 
						WHEN OUT.out_type = 'OUT_EXTERNAL_EVENT' 
						THEN (	SELECT
									X.ext_end_date 
								FROM
									Ext_External_Event_tb X 
								WHERE
									X.out_id = OUT.OUT_ID 
						)
						WHEN OUT.out_type = 'OUT_GENERAL_EVENT' 
						THEN (	SELECT
									V.evt_end_Date 
								FROM
									Evt_Event_tb V 
								WHERE
									V.out_id = OUT.OUT_ID 
						)
						ELSE NULL 
					END,101)                              AS output_end_Date,
					'Obligated'                                                  
					AS outputType,
                    100 as KNL_Percentage,
					tal.tal_description                                          
					AS category,
					isnull(budgetObligated.bioCost,0) cost 
				FROM
					Out_Outcome_tb OUT,
					Obg_Outcome_Budget_tb obg,
					Obc_Outcome_Budget_Category_tb obc,
					Tal_Taxonomy_Language_tb tal,
					(	SELECT
							CASE bio.bio_accounting_type 
								WHEN 'BIO_CREDIT' 
								THEN (bio.bio_item_cost)*(-1) 
								ELSE bio.bio_item_cost 
							END AS bioCost,
							boo.obc_id_outcome_budget_category obcId 
						FROM
							Bio_Budget_Item_Obligated bio,
							Boo_Budget_Item_Operational boo 
						WHERE
							bio.bio_id = boo.bio_id AND
							bio.bio_deleted_date IS NULL AND
							bio.per_deletor_id IS NULL 
					)
					AS budgetObligated 
				WHERE
					OUT.out_id = obg.out_id_outcome AND
					obg.obg_id = obc.obg_id_outcome_budget AND
					obc.tax_id_category = tal.tax_id AND
					budgetObligated.obcId = obc.obc_id AND
					OUT.out_deleted_flag = 0 AND
					YEAR(OUT.out_publish_date) = 2012 AND
					obg.obg_entry_type = 'OBG_EXECUTED' 
				UNION
					ALL SELECT
							OUT.out_id                                                    
							AS outId,
							'(OUT-' + CONVERT(VARCHAR, OUT.out_id) + ') ' + OUT. 
							out_name AS OUTPUT,
							CONVERT(VARCHAR(10), 
							CASE 
								WHEN OUT.out_type = 'OUT_EXTERNAL_EVENT' 
								THEN (	SELECT
											X.ext_start_date 
										FROM
											Ext_External_Event_tb X 
										WHERE
											X.out_id = OUT.OUT_ID 
								)
								WHEN OUT.out_type = 'OUT_GENERAL_EVENT' 
								THEN (	SELECT
											V.evt_start_Date 
										FROM
											Evt_Event_tb V 
										WHERE
											V.out_id = OUT.OUT_ID 
								)
								ELSE NULL 
							END,101)                               AS 
							output_start_Date,
							CONVERT(VARCHAR(10), 
							CASE 
								WHEN OUT.out_type = 'OUT_EXTERNAL_EVENT' 
								THEN (	SELECT
											X.ext_end_date 
										FROM
											Ext_External_Event_tb X 
										WHERE
											X.out_id = OUT.OUT_ID 
								)
								WHEN OUT.out_type = 'OUT_GENERAL_EVENT' 
								THEN (	SELECT
											V.evt_end_Date 
										FROM
											Evt_Event_tb V 
										WHERE
											V.out_id = OUT.OUT_ID 
								)
								ELSE NULL 
							END,101)                               AS 
							output_end_Date,
							'Executed'                                                    
							AS outputType,
                            100 as KNL_Percentage,
							tal.tal_description                                           
							AS category,
							isnull(budgetExecuted.bieCost,0) cost 
						FROM
							Out_Outcome_tb OUT,
							Obg_Outcome_Budget_tb obg,
							Obc_Outcome_Budget_Category_tb obc,
							Tal_Taxonomy_Language_tb tal,
							(	SELECT
									CASE bie.bie_accounting_type 
										WHEN 'BIE_CREDIT' 
										THEN (bie.bie_item_cost)*(-1) 
										ELSE bie.bie_item_cost 
									END AS bieCost,
									boo.obc_id_outcome_budget_category obcId 
								FROM
									Bio_Budget_Item_Obligated bio,
									Bie_Budget_Item_Executed bie,
									Boo_Budget_Item_Operational boo 
								WHERE
									bio.bio_id = boo.bio_id AND
									bio.bio_id = bie. 
									bio_id_budget_item_obligated AND
									bio.bio_deleted_date IS NULL AND
									bio.per_deletor_id IS NULL AND
									bie.bie_deleted_date IS NULL AND
									bie.per_id_deletor IS NULL 
							)
							AS budgetExecuted 
						WHERE
							OUT.out_id = obg.out_id_outcome AND
							obg.obg_id = obc.obg_id_outcome_budget AND
							obc.tax_id_category = tal.tax_id AND
							budgetExecuted.obcId = obc.obc_id AND
							OUT.out_deleted_flag = 0 AND
							YEAR(OUT.out_publish_date) = 2012 AND
							obg.obg_entry_type = 'OBG_EXECUTED' 
	)
	AS budgetItems 
WHERE
	kna.kna_id = aao.kna_id_activity AND
	kna.kpd_id_deliverable = kpd.kpd_id AND
	kpd.tax_id_type = tal.tax_id AND
	kpd.knd_id_division = knd.knd_id AND
	knd.knp_id_plan_department = knp.knp_id AND
	knp.yea_year = 2010 AND
	OUT.out_id = aao.out_id_outcome AND
	OUT.out_id IN (	SELECT
						o.out_id_outcome 
					FROM
						Obg_Outcome_Budget_tb o 
					WHERE
						o.obg_entry_type = 'OBG_LOGISTIC' AND
						o.obg_knl_amount <> 0 
	)
	AND
	aao.out_id_outcome = budgetItems.outId AND
	( ( kpd.tax_id_type = 18 AND
	kna.kna_selected_flag = 1) OR
	(kpd.tax_id_type <> 18 AND
	kna.kna_approved_flag = 1 AND
	kna.kna_selected_flag = 1) )",
dbo,OBL_OBLIGATED_VW,2010-10-29 18:08:52.087,2015-09-18 11:16:11.117,"CREATE VIEW [dbo].[OBL_OBLIGATED_VW]
AS 
select
    --- OUTPUT
    bio.bio_id as obligation_id,
    out.out_id as output_id,
	aao.kna_id_activity as activity_id,
    (select isNull(tal.tal_description,'N/A') from Tal_Taxonomy_Language_tb tal, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd where tal.tax_id = kpd.tax_id_type and tal.lng_id = 1 and kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id) as componentType,
    (select knp.yea_year from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) as activity_year,
    (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as activity_department,
    (select unt.unt_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where kna.kna_id  = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as activity_unit,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header ) as activity_status,
    (select case    when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then (select tal.tal_description from Tal_Taxonomy_Language_tb tal where kna.tax_id_source_funding = tal.tax_id and tal.lng_id = 1 )  else 'N/A' end as source_funding    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header ) as source_funding,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header) as activity_approved_amount,
    CASE
        WHEN (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = aao.kna_id_activity)
    END as activity_type,
    (select tal2.tal_description from Tal_Taxonomy_Language_tb tal2 where tal2.tax_id = out.tax_id_presentation_type) as output_presentation_type,
    output_modality =
	case
		when out.out_modality = 'OUT_FACE_TO_FACE' then 'Face to Face'
		when out.out_modality = 'OUT_WEBINAR' then 'Webinar'
		when out.out_modality = 'OUT_VIRTUAL' then 'Virtual'
		when out.out_modality = 'OUT_SELF_LEARNING' then 'Self-Learning'
		else out.out_modality
	end,
	(select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as output_opus_code,
    output_type =
	case
		when out.out_type = 'OUT_EXTERNAL_EVENT' then 'External Event'
		when out.out_type = 'OUT_GENERAL_EVENT' then 'General Event'
		when out.out_type = 'OUT_GENERAL_SERVICE' then 'General Service'
		when out.out_type = 'OUT_KNOWLEDGE_PRODUCT' then 'Knowledge Product'
        when out.out_type = 'OUT_LIBRARY_PRODUCT' then 'Library Product'
		else out.out_type
	end,
    output_unit =
    case 
     when out.out_type = 'OUT_EXTERNAL_EVENT' and out.out_flow_status_code = 'EXT_REVIEWED'
     then (select unt.unt_name from Usr_User_tb usr, Unt_Unit_tb unt, Reu_Registration_User_tb reu, Reg_Registration_tb reg where out.out_id = reg.out_id_outcome and reu.reg_id = reg.reg_id and reu.usr_id = usr.usr_id and unt.unt_id = usr.unt_id_unit and reg.reg_deleted_flag = 0)
    else (select unt.unt_name from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id and aao.out_id_outcome = out.out_id)
    end,
    out.out_created_date as output_created_date,
    obg.obg_knl_amount as output_reviewed_amount,
    (select tal3.tal_description from Tal_Taxonomy_Language_tb tal3 where tal3.tax_id = obc.tax_id_category) as output_budget_category,
    obc.obc_item_cost as output_budget_category_amount,
    --- OBLIGATION
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		when bio.bio_entry_type = 'BIO_OPERATIONAL' then 'Operative'
		else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    consultant_id =
    case 
     when (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
	adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
    CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator,
     bio.bio_lawson_date as lawson_date,
     (SELECT isnull(SUM(A.DEBIT) - SUM(A.credit),0) AS EXECUTED_AMOUNT FROM (select bio_id_budget_item_obligated,  case when bie_accounting_type = 'BIE_CREDIT' then bie_item_cost       else 0    end as credit,    case        when bie_accounting_type = 'BIE_DEBIT' then bie_item_cost        else 0    end as debit from Bie_Budget_Item_Executed where bie_deleted_date is null and bio_id_budget_item_obligated = bio.bio_id) AS A) AS executed_amount
from Bio_Budget_Item_Obligated bio,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops,
    Out_Outcome_tb out left outer join Aao_available_activity_outcome_tb aao on out.out_id = aao.out_id_outcome,
    Obg_Outcome_Budget_tb obg,
    Obc_Outcome_Budget_Category_tb obc,
    Boo_Budget_Item_Operational boo
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type in ('BIO_OPERATIONAL')
    and bio.bio_id = boo.bio_id
    and boo.obc_id_outcome_budget_category = obc.obc_id
    and obc.obg_id_outcome_budget = obg.obg_id
    and obg.out_id_outcome = out.out_id
    and obg.obg_entry_type = 'OBG_EXECUTED'
    and bio.bio_deleted_date is null
union all
select 
    bio.bio_id as obligation_id,
    0 as output_id,
    (select isNull(bip.kna_id,0) from Bip_Budget_Item_Plan_Activity_tb bip where bip.bio_id  = bio.bio_id) as activity_id,
    (select isNull(tal.tal_description,'N/A') from Tal_Taxonomy_Language_tb tal, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Bip_Budget_Item_Plan_Activity_tb bip where tal.tax_id = kpd.tax_id_type and tal.lng_id = 1 and kna.kna_id = bip.kna_id and bip.bio_id = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id) as componentType,
    (select knp.yea_year from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id) as activity_year,
    (select dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as activity_department,
    (select unt.unt_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as source_funding,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id = bio.bio_id) as activity_status,
    (select case    when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then (select tal.tal_description from Tal_Taxonomy_Language_tb tal where kna.tax_id_source_funding = tal.tax_id and tal.lng_id = 1 ) else 'N/A' end as source_funding    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id = bio.bio_id) as knl_status,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Bip_Budget_Item_Plan_Activity_tb bip, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = bip.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header and bip.bio_id  = bio.bio_id) as activity_approved_amount,
    CASE
        WHEN (select dep.dep_name from Bip_Budget_Item_Plan_Activity_tb bip, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where bip.kna_id = kna.kna_id and bip.bio_id  = bio.bio_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal, Bip_Budget_Item_Plan_Activity_tb bip where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = bip.kna_id and bip.bio_id = bio.bio_id)
    END as activity_type,
    '' as output_presentation_type,
    '' as output_modality,
    '' as output_opus_code,
    '' as output_type,
    '' as output_unit,
    '' as output_created_date,
    0 as output_reviewed_amount,
    '' as output_budget_category,
    0 as output_budget_category_amount,
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		when bio.bio_entry_type = 'BIO_OPERATIONAL' then 'Operative'
        else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
	consultant_id =
    case 
     when (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
    adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
    CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator,
     bio.bio_lawson_date as lawson_date,
     (SELECT isnull(SUM(A.DEBIT) - SUM(A.credit),0) AS EXECUTED_AMOUNT FROM (select bio_id_budget_item_obligated,  case when bie_accounting_type = 'BIE_CREDIT' then bie_item_cost       else 0    end as credit,    case        when bie_accounting_type = 'BIE_DEBIT' then bie_item_cost        else 0    end as debit from Bie_Budget_Item_Executed where bie_deleted_date is null and bio_id_budget_item_obligated = bio.bio_id) AS A) AS executed_amount
from Bio_Budget_Item_Obligated bio,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type not in ('BIO_OPERATIONAL')
    and bio.bio_deleted_date is null",
dbo,OBL_OBLIGATIONS_ACTIVITY_VW_2013,2013-07-25 13:04:58.313,2013-07-25 13:04:58.313,"CREATE VIEW [dbo].[OBL_OBLIGATIONS_ACTIVITY_VW_2013]
AS 
select obl.activity_id, obl.obligation_id, obl.obligation_year, obl.obligation_entry_type, obl.obligation_vendor, obl.consultant_id, obl.obligation_account_code,
    obl.obligation_account_name, obl.obligation_org_unit_code, obl.obligation_description, obl.obligation_item_type, obl.obligation_item_value, obl.obligation_amount,
    obl.obligation_opus_code, obl.obligation_entry_date, obl.obligation_creator, obl.obligation_last_updated_date, obl.obligation_last_updator, obl.lawson_date, obl.executed_amount
			from OBL_OBLIGATED_VW obl,
			    ACT_ACTIVITIES_VW act
			where act.activityID = obl.activity_id
			    and act.yea_year = 2013
			    and obl.output_id = 0",
dbo,OCE_OUTCOME_CATEGORY_EXPENSE_VW,2011-11-14 11:48:17.667,2012-06-30 11:17:28.513,"CREATE VIEW [dbo].[OCE_OUTCOME_CATEGORY_EXPENSE_VW]
AS 
SELECT OUA.OUT_ID, OUA.KNA_ID_ACTIVITY, OUA.OUTPUT_TYPE, OUA.START_DATE, OUA.END_DATE, OUA.ACTIVITY_CODE AS OPUS_CODE, OUA.out_outcome_budget_status OUTCOME_BUDGET_STATUS, OUA.out_logistic_required_flag AS LOGISTIC_REQUIRED_FLAG,
    OBG.obg_entry_type AS BUDGET_TYPE, TAL.tal_description AS CATEGORY, OBC.obc_item_cost AS ITEM_COST
FROM OUA_OUTCOME_ACTIVITY_VW OUA,
    Obg_Outcome_Budget_tb OBG,
    Obc_Outcome_Budget_Category_tb OBC,
    Tal_Taxonomy_Language_tb TAL
WHERE OUA.OUT_ID = OBG.out_id_outcome
    AND OBG.obg_id = OBC.obg_id_outcome_budget
    AND OBG.obg_entry_type IN ('OBG_ORIGINAL','OBG_LATEST','OBG_LOGISTIC','OBG_EXECUTED')
    AND TAL.tax_id = OBC.tax_id_category
    AND TAL.lng_id = 1
    AND OUA.OUT_DELETED_FLAG = 0",
dbo,OCR_Optima_Corporate_Registration_vw,2015-01-09 17:23:39.997,2015-02-23 11:27:01.313,"CREATE VIEW [dbo].[OCR_Optima_Corporate_Registration_vw]
AS 
select 
    dep.dep_name as participant_department,
    unt.unt_name as participant_unit,
    p.per_first_name + ' ' + isnull(p.per_middle_name + ' ','') + p.per_last_name as participant_name,
    u.usr_pcmail as participant_email,
    o.out_id as output_id,
    o.out_name as course_name,
    s.srv_total_duration as hours,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/' + convert(VARCHAR,o.out_id) as output_link    
from Kna_Knl_Plan_Activity_tb kna,
    Aao_Available_Activity_Outcome_tb aao,
    Out_Outcome_tb o,
    Srv_Service_tb s,
    Reg_Registration_tb r,
    Reu_Registration_User_tb reu,
    Usr_User_tb u,
    Per_Person_tb p,
    Unt_Unit_tb unt,
    Dep_Department_tb dep
where kna.kna_id in (8968, 9012)
    and aao.kna_id_activity = kna.kna_id
    and aao.out_id_outcome = o.out_id
    and o.out_id = s.out_id
    and r.out_id_outcome = o.out_id
    and r.reg_id = reu.reg_id
    and reu.usr_id = u.usr_id
    and u.per_id_person = p.per_id
    and u.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and o.out_deleted_flag = 0
    and r.reg_deleted_flag = 0
union all
select dep.dep_name as participant_department,
    unt.unt_name as participant_unit,
    p.per_first_name + ' ' + isnull(p.per_middle_name + ' ','') + p.per_last_name as participant_name,
    u.usr_pcmail as participant_email,
    o.out_id as output_id,
    o.out_name as course_name,
    e.evt_total_duration as hours,
    'http://knlsystem//index.cfm/registration/registrationDetail/outId/' + convert(VARCHAR,o.out_id) as output_link  
from Kna_Knl_Plan_Activity_tb kna,
    Aao_Available_Activity_Outcome_tb aao,
    Out_Outcome_tb o,
    Evt_Event_tb e,
    Reg_Registration_tb r,
    Reu_Registration_User_tb reu,
    Usr_User_tb u,
    Per_Person_tb p,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec
where kna.kna_id in (8968, 9012)
    and aao.kna_id_activity = kna.kna_id
    and sec.sec_id = dep.sec_id_section
    and aao.out_id_outcome = o.out_id
    and o.out_id = e.out_id
    and r.out_id_outcome = o.out_id
    and r.reg_id = reu.reg_id
    and reu.usr_id = u.usr_id
    and u.per_id_person = p.per_id
    and u.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and o.out_deleted_flag = 0
    and r.reg_deleted_flag = 0",
dbo,ODL_GENERAL_EVENT_LOGISTIC_DETAIL_VW,2016-01-20 11:47:11.130,2016-01-21 23:26:21.990,"CREATE VIEW [dbo].[ODL_GENERAL_EVENT_LOGISTIC_DETAIL_VW]
AS 
select * from ODT_GENERAL_EVENT_DETAIL_VW
where LOGISTICS_FLAG = 1
    and year(START_DATE) = year(getdate())",
dbo,ODT_COLLABORATIVE_LEARNING_DETAIL_VW,2015-12-05 03:59:12.603,2015-12-05 03:59:12.603,"CREATE VIEW [dbo].[ODT_COLLABORATIVE_LEARNING_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Collaborative Learning' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    srv.srv_total_duration AS TOTAL_DURATION,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_GENERAL' THEN 'SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_MOODLE' THEN 'MOODLE SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_LANGUAGE' THEN 'LANGUAGE SERVICE'  when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_COLLABORATIVE' THEN 'Collaborative Learning'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- SERVICE
    srv.srv_start_date AS START_DATE,
    srv.srv_end_date AS END_DATE,
    srv.srv_active_flag AS ACTIVE_FLAG,
    srv.srv_registration_cofinancing AS REGISTRATION_COFINANCING,
    srv.srv_registration_fee AS REGISTRATION_FEE,
    srv.srv_private_registration_flag AS PRIVATE_REGISTRATION,
    CASE WHEN flw.flw_code = 'SRV_NONE' THEN 'NOT REQUIRES SUPERVISOR APPROVAL' WHEN flw.flw_code = 'SRV_APPROVAL' THEN 'REQUIRES SUPERVISOR APPROVAL' ELSE 'N/A' END AS FLOW_CODE
from Out_Outcome_tb o,
    Srv_Service_tb srv,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = srv.out_id
    and srv.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    and srv.srv_type = 'SRV_COLLABORATIVE'",
dbo,ODT_EXTERNAL_EVENT_DETAIL_VW,2015-12-05 03:34:46.837,2015-12-05 03:34:46.837,"CREATE VIEW [dbo].[ODT_EXTERNAL_EVENT_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_EXTERNAL_EVENT' THEN 'EXTERNAL EVENT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    loc.loc_description AS LOCATION_NAME,
    loc.loc_type AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c where c.cti_id = loc.cti_id_city) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- EXTERNAL EVENT
    ext.ext_start_date AS START_DATE,
    ext.ext_end_date AS END_DATE,
    ext.ext_duration AS TOTAL_DURATION
from Out_Outcome_tb o,
    Ext_External_Event_tb ext,
    Loc_Location_tb loc,
    Ops_Opus_tb ops
where o.out_id = ext.out_id
    and o.loc_id_location = loc.loc_id
    and ops.ops_id = o.ops_id_opus
    and (SELECT COUNT(*)
        FROM Reg_Registration_tb REG
        WHERE REG.reg_deleted_flag = 0
            AND REG.reg_showup_flag = 1
            AND REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
            AND REG.out_id_outcome = O.OUT_ID) > 0
union all
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_EXTERNAL_EVENT' THEN 'EXTERNAL EVENT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    Institutions.ins_name AS LOCATION_NAME,
    'LOC_EXTERNAL_FACILITY' AS LOCATION_TYPE,
    Cities.cti_name AS LOCATION_CITY,
    Countries.ctr_name AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- EXTERNAL EVENT
    ext.ext_start_date AS START_DATE,
    ext.ext_end_date AS END_DATE,
    ext.ext_duration AS TOTAL_DURATION
from Out_Outcome_tb o,
    Ext_External_Event_tb ext,
    Ops_Opus_tb ops,
    Ins_Institution_tb Institutions,
    Cti_City_tb as Cities,
    Ctr_Country_tb as Countries
where o.out_id = ext.out_id
    and ext.ins_id_institution = Institutions.ins_id
    and Institutions.cti_id_city = Cities.cti_id
    and Cities.ctr_id_country = Countries.ctr_id
    and ops.ops_id = o.ops_id_opus
    and (SELECT COUNT(*)
        FROM Reg_Registration_tb REG
        WHERE REG.reg_deleted_flag = 0
            AND REG.reg_showup_flag = 1
            AND REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
            AND REG.out_id_outcome = O.OUT_ID) > 0",
dbo,ODT_FHL_PRODUCT_DETAIL_VW,2015-12-05 03:50:19.423,2015-12-05 03:56:40.450,"CREATE VIEW [dbo].[ODT_FHL_PRODUCT_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_LIBRARY_PRODUCT' THEN 'LIBRARY PRODUCT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    '' AS LOCATION_NAME,
    '' AS LOCATION_TYPE,
    '' AS LOCATION_CITY,
    '' AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    CASE WHEN lbr.lbr_transaction_type = 'FHL_NEW' THEN 'NEW' 
         WHEN lbr.lbr_transaction_type = 'FHL_RENEW' THEN 'RENEW' 
         ELSE 'UNKNOWN'
    END AS TRANSACTION_TYPE,
     CASE WHEN lbr.lbr_format = 'LBR_PRINT' THEN 'PRINT' 
         WHEN lbr.lbr_format = 'LBR_ELECTRONIC' THEN 'ELECTRONIC' 
         WHEN lbr.lbr_format = 'LBR_PRINT_ELECTRONIC' THEN 'PRINT AND ELECTRONIC' 
         ELSE 'UNKNOWN'
    END AS FORMAT,
    lbr.lbr_coverage_from AS COVERAGE_FROM,
    lbr.lbr_coverage_to AS COVERAGE_TO
from Out_Outcome_tb o,
    Lbr_Library_Product_tb lbr,
    Ops_Opus_tb ops
where o.out_id = lbr.out_id
    and ops.ops_id = o.ops_id_opus",
dbo,ODT_GENERAL_EVENT_DETAIL_VW,2015-12-05 03:25:41.380,2016-01-21 23:18:08.747,"CREATE VIEW [dbo].[ODT_GENERAL_EVENT_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'Face to Face' when O.out_modality = 'OUT_WEBINAR' THEN 'Webinar' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'Self-Learning' when O.out_modality = 'OUT_VIRTUAL' THEN 'Virtual with Tutor' end AS MODALITY,
    CASE WHEN evt.evt_type = 'EVT_GENERAL' AND o.out_modality = 'OUT_WEBINAR' THEN 'Webinar'
         WHEN evt.evt_type = 'EVT_GENERAL' AND o.out_modality = 'OUT_VIRTUAL' THEN 'Virtual with Tutor'
         ELSE (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) 
    END AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_GENERAL' THEN 'General Event' 
         when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_MOODLE' THEN 'Moodle Event' 
         when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_LANGUAGE' THEN 'Language Group Event' 
         ELSE 'UNKNOWN' 
    END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- EVENT
    evt.evt_start_date AS START_DATE,
    evt.evt_end_date AS END_DATE,
    evt.evt_registration_deadline AS DEADLINE,
    evt.evt_max_number_participants AS MAX_PARTICIPANTS,
    evt.evt_registration_cofinancing AS REGISTRATION_COFINANCING,
    evt.evt_registration_fee AS REGISTRATION_FEE,
    evt.evt_private_registration_flag AS PRIVATE_REGISTRATION,
    evt.evt_total_duration AS TOTAL_DURATION,
    evt.evt_online_flag AS ONLINE_FLAG,
    CASE WHEN flw.flw_code = 'EVT_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'EVT_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    (select top 1 isNull(per.per_first_name + ' ' + per.per_last_name,'') from Oko_Outcome_KNLOfficer_tb oko, Per_Person_tb per where oko.out_id_outcome = o.OUT_ID and oko.per_id_responsible = per.per_id and oko.oko_type = 'OKO_LOGISTIC' and oko.oko_active_flag = 1) as logistic_assistant,
    (select top 1 isNull(per.per_first_name + ' ' + per.per_last_name,'') from Oko_Outcome_KNLOfficer_tb oko, Per_Person_tb per where oko.out_id_outcome = o.OUT_ID and oko.per_id_responsible = per.per_id and oko.oko_type = 'OKO_AUDIOVISUALS' and oko.oko_active_flag = 1) as audiovisuals_assistant,
    (select top 1 isNull(per.per_first_name + ' ' + per.per_last_name,'') from Oko_Outcome_KNLOfficer_tb oko, Per_Person_tb per where oko.out_id_outcome = o.OUT_ID and oko.per_id_responsible = per.per_id and oko.oko_type = 'OKO_BUDGET' and oko.oko_active_flag = 1) as budget_assistant,
    CASE WHEN evt.evt_logistic_complexity = 'LOG_LOW_COMPLEXITY' THEN 'Low'
         WHEN evt.evt_logistic_complexity = 'LOG_MEDIUM_COMPLEXITY' THEN 'Medium'
         WHEN evt.evt_logistic_complexity = 'LOG_HIGH_COMPLEXITY' THEN 'High'
         ELSE 'Other'
    END as LOGISTIC_COMPLEXITY
from Out_Outcome_tb o,
    Evt_Event_tb evt,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = evt.out_id
    and evt.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    and evt.evt_type = 'EVT_GENERAL'",
dbo,ODT_GENERAL_SERVICE_DETAIL_VW,2015-12-05 03:40:37.400,2015-12-05 03:40:37.400,"CREATE VIEW [dbo].[ODT_GENERAL_SERVICE_DETAIL_VW]
AS 
SELECT
	o.out_id                              AS OUT_ID,
	o.out_name                            AS NAME,
	o.out_objectives                      AS OBJECTIVES,
	O.out_comments                        AS COMMENTS,
	CASE 
		WHEN O.out_modality = 'OUT_FACE_TO_FACE' 
		THEN 'FACE TO FACE' 
		WHEN O.out_modality = 'OUT_WEBINAR' 
		THEN 'WEBINAR' 
		WHEN O.out_modality = 'OUT_SELF_LEARNING' 
		THEN 'SELF-LEARNING' 
		WHEN O.out_modality = 'OUT_VIRTUAL' 
		THEN 'VIRTUAL' 
		WHEN (	SELECT
					ISNULL(tag.tag_code,'') 
				FROM
					Tag_Taxonomy_Group_tb tag,
					Tax_Taxonomy_tb tax 
				WHERE
					tag.tax_id_group_header = tax.tax_parent_id AND
					tax.tax_id = o.tax_id_presentation_type) = 'OLL' 
		THEN 'SELF-LEARNING' 
		WHEN O.out_modality = 'OUT_MOOC' 
		THEN 'MOOC' 
	END                                       AS MODALITY,
	'General Self-Learning'               AS PRESENTATION_TYPE,
	(	SELECT
			t.tal_description 
		FROM
			Tal_Taxonomy_Language_tb t 
		WHERE
			t.tax_id = o.tax_id_subject_type AND
			t.lng_id = 1)                                    AS SUBJECT_TYPE,
	ops.ops_activity_code                 AS OPUS_CODE,
	o.out_created_date                    AS CREATED_DATE,
	o.out_deleted_date                    AS DELETED_DATE,
	o.out_publish_date                    AS PUBLISHED_DATE,
	srv.srv_total_duration                AS TOTAL_DURATION,
	(	SELECT
			per.per_first_name +' ' + per.per_last_name 
		FROM
			Per_Person_tb per 
		WHERE
			per.per_id = o.per_id_creator)                                    AS 
	CREATOR,
	(	SELECT
			per.per_first_name +' ' + per.per_last_name 
		FROM
			Per_Person_tb per 
		WHERE
			per.per_id = o.per_id_deletor)                                    AS 
	DELETOR,
	CASE 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_GENERAL' 
		THEN 'Self-Learning' 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_MOODLE' 
		THEN 'Moodle Self-Learning' 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_LANGUAGE' 
		THEN 'Language Service' 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_MOOC' 
		THEN 'MOOC' 
		ELSE 'UNKNOWN' 
	END                                       AS OUT_TYPE,
	(	SELECT
			loc.loc_description 
		FROM
			Loc_Location_tb loc 
		WHERE
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_NAME,
	(	SELECT
			loc.loc_type 
		FROM
			Loc_Location_tb loc 
		WHERE
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_TYPE,
	(	SELECT
			C.cti_name 
		FROM
			Cti_City_tb C,
			Loc_Location_tb loc 
		WHERE
			C.cti_id = loc.cti_id_city AND
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_CITY,
	(	SELECT
			y.ctr_local_name 
		FROM
			Cti_City_tb C,
			Ctr_Country_tb y,
			Loc_Location_tb loc 
		WHERE
			C.cti_id = loc.cti_id_city AND
			C.ctr_id_country = y.ctr_id AND
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_COUNTRY,
	o.out_flow_status_code                AS STATUS_CODE,
	o.out_outcome_budget_status           AS BUDGET_STATUS_CODE,
	o.out_budget_officer_closed_date      AS BUDGET_OFFICER_CLOSED_DATE,
	(	SELECT
			per.per_first_name +' ' + per.per_last_name 
		FROM
			Per_Person_tb per 
		WHERE
			per.per_id = o.per_id_budget_officer)  AS CLOSER,
	o.out_last_updated_Date               AS LAST_UPDATED_DATE,
	-- SERVICE
	srv.srv_start_date                    AS START_DATE,
	srv.srv_end_date                      AS END_DATE,
	srv.srv_active_flag                   AS ACTIVE_FLAG,
	srv.srv_registration_cofinancing      AS REGISTRATION_COFINANCING,
	srv.srv_registration_fee              AS REGISTRATION_FEE,
	srv.srv_private_registration_flag     AS PRIVATE_REGISTRATION,
	CASE 
		WHEN flw.flw_code = 'SRV_NONE' 
		THEN 'NO APPROVAL REQUIRED' 
		WHEN flw.flw_code = 'SRV_APPROVAL' 
		THEN 'SUPERVISOR APPROVAL REQUIRED' 
		ELSE 'N/A' 
	END                                       AS FLOW_CODE
FROM
	Out_Outcome_tb o,
	Srv_Service_tb srv,
	Flw_Flow_tb flw,
	Ops_Opus_tb ops
WHERE
	o.out_id = srv.out_id AND
	srv.flw_id_flow = flw.flw_id AND
	ops.ops_id = o.ops_id_opus AND
	srv.srv_type IN ('SRV_GENERAL',
	'SRV_MOOC')",
dbo,ODT_KNOWLEDGE_PRODUCT_DETAIL_VW,2015-12-05 03:54:12.020,2015-12-05 03:54:12.020,"CREATE VIEW [dbo].[ODT_KNOWLEDGE_PRODUCT_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_KNOWLEDGE_PRODUCT' THEN 'KNOWLEDGE PRODUCT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    '' AS LOCATION_NAME,
    '' AS LOCATION_TYPE,
    '' AS LOCATION_CITY,
    '' AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE
from Out_Outcome_tb o,
    Prd_Product_tb prd,
    Ops_Opus_tb ops
where o.out_id = prd.out_id
    and ops.ops_id = o.ops_id_opus",
dbo,ODT_LANGUAGE_GROUP_EVENT_DETAIL_VW,2015-12-05 03:30:56.750,2015-12-05 03:30:56.750,"CREATE VIEW [dbo].[ODT_LANGUAGE_GROUP_EVENT_DETAIL_VW]
AS 
-- LANGUAGE GROUP EVENTS
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Language Group Event' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_GENERAL' THEN 'GENERAL EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_MOODLE' THEN 'MOODLE EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_LANGUAGE' THEN 'LANGUAGE GROUP EVENT' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- EVENT
    evt.evt_start_date AS START_DATE,
    evt.evt_end_date AS END_DATE,
    evt.evt_registration_deadline AS DEADLINE,
    evt.evt_max_number_participants AS MAX_PARTICIPANTS,
    evt.evt_registration_cofinancing AS REGISTRATION_COFINANCING,
    evt.evt_registration_fee AS REGISTRATION_FEE,
    evt.evt_private_registration_flag AS PRIVATE_REGISTRATION,
    evt.evt_total_duration AS TOTAL_DURATION,
    evt.evt_online_flag AS ONLINE_FLAG,
    CASE WHEN flw.flw_code = 'EVT_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'EVT_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    --- LANGUAGE GROUP EVENT
    (SELECT P.per_first_name +' ' + P.per_last_name FROM Per_Person_tb P, Fcl_Facilitator_tb FCL, Tea_Teacher_tb TEA WHERE TEA.tea_id = LGE.tea_id_teacher AND FCL.per_id_person = P.per_id AND FCL.fcl_id = TEA.fcl_id_facilitator) AS TEACHER
from Out_Outcome_tb o,
    Evt_Event_tb evt,
    Lge_Language_Group_Event_tb LGE,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = evt.out_id
    and evt.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    AND EVT.out_id = LGE.out_id
    AND EVT.EVT_TYPE = 'EVT_LANGUAGE'",
dbo,ODT_LANGUAGE_SERVICE_DETAIL_VW,2015-12-05 03:45:52.053,2015-12-05 03:45:52.053,"CREATE VIEW [dbo].[ODT_LANGUAGE_SERVICE_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Language Individual' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    srv.srv_total_duration AS TOTAL_DURATION,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_GENERAL' THEN 'SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_MOODLE' THEN 'MOODLE SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_LANGUAGE' THEN 'LANGUAGE SERVICE' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- SERVICE
    srv.srv_active_flag AS ACTIVE_FLAG,
    srv.srv_registration_cofinancing AS REGISTRATION_COFINANCING,
    srv.srv_registration_fee AS REGISTRATION_FEE,
    srv.srv_private_registration_flag AS PRIVATE_REGISTRATION,
    CASE WHEN flw.flw_code = 'SRV_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'SRV_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    srv.srv_start_date as START_DATE,
    srv.srv_end_date as END_DATE 
from Out_Outcome_tb o,
    Srv_Service_tb srv,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = srv.out_id
    and srv.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    and srv.srv_type = 'SRV_LANGUAGE'",
dbo,ODT_MOODLE_EVENT_DETAIL_VW,2015-12-05 03:44:00.710,2016-06-22 10:19:13.740,"CREATE VIEW [dbo].[ODT_MOODLE_EVENT_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Indes Virtual Event' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_ID AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    dbo.getKNLOfficersByOutcome(o.out_id) as KNLOFFICERS,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_GENERAL' THEN 'GENERAL EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_MOODLE' THEN 'MOODLE EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_LANGUAGE' THEN 'LANGUAGE GROUP EVENT' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- EVENT
    evt.evt_start_date AS START_DATE,
    evt.evt_end_date AS END_DATE,
    evt.evt_registration_deadline AS DEADLINE,
    evt.evt_max_number_participants AS MAX_PARTICIPANTS,
    evt.evt_registration_cofinancing AS REGISTRATION_COFINANCING,
    evt.evt_registration_fee AS REGISTRATION_FEE,
    evt.evt_private_registration_flag AS PRIVATE_REGISTRATION,
    evt.evt_total_duration AS TOTAL_DURATION,
    evt.evt_online_flag AS ONLINE_FLAG,
    CASE WHEN flw.flw_code = 'EVT_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'EVT_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    --- MOODLE EVENT
    moe.moe_moodle_id AS MOODLE_ID 
from Out_Outcome_tb o,
    Evt_Event_tb evt,
    Moe_Moodle_Event_tb moe,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = evt.out_id
    and evt.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    AND EVT.out_id = moe.out_id
    AND EVT.EVT_TYPE = 'EVT_MOODLE'",
dbo,ODT_MOODLE_SERVICE_DETAIL_VW,2015-12-05 03:48:23.693,2015-12-05 03:48:23.693,"CREATE VIEW [dbo].[ODT_MOODLE_SERVICE_DETAIL_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Indes Virtual Self-Learning' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    srv.srv_total_duration AS TOTAL_DURATION,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_GENERAL' THEN 'SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_MOODLE' THEN 'MOODLE SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_LANGUAGE' THEN 'LANGUAGE SERVICE' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- EVENT
    srv.srv_start_date AS START_DATE,
    srv.srv_end_date AS END_DATE,
    srv.srv_active_flag AS ACTIVE_FLAG,
    srv.srv_registration_cofinancing AS REGISTRATION_COFINANCING,
    srv.srv_registration_fee AS REGISTRATION_FEE,
    srv.srv_private_registration_flag AS PRIVATE_REGISTRATION,
    CASE WHEN flw.flw_code = 'SRV_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'SRV_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    -- MOODLE
    mos.mos_moodle_id AS MOODLE_ID 
from Out_Outcome_tb o,
    Srv_Service_tb srv,
    Mos_Moodle_Service_tb mos,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = srv.out_id
    and mos.out_id = srv.out_id
    and srv.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus",
dbo,ODT_OUTPUT_DETAIL_VW,2015-12-05 03:21:38.410,2020-11-19 11:43:47.867,"CREATE VIEW [dbo].[ODT_OUTPUT_DETAIL_VW]
AS 
SELECT A.*,
    OPL.opl_description AS OPUS_NAME,
    (select aao.kna_id_activity from aao_available_activity_outcome_tb aao where aao.out_id_outcome = A.out_id) as KNA_ID
FROM 
(SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_GENERAL_EVENT_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_LANGUAGE_GROUP_EVENT_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_MOODLE_EVENT_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_EXTERNAL_EVENT_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_GENERAL_SERVICE_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_MOODLE_SERVICE_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_LANGUAGE_SERVICE_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.START_DATE, O.END_DATE, O.TOTAL_DURATION
FROM ODT_COLLABORATIVE_LEARNING_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    NULL, NULL, 0
FROM ODT_KNOWLEDGE_PRODUCT_DETAIL_VW O
--WHERE O.DELETED_DATE IS NULL
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
    O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    NULL, NULL, 0
FROM ODT_FHL_PRODUCT_DETAIL_VW O
/*WHERE O.DELETED_DATE IS NULL*/) AS A,
    Ops_Opus_tb OPS,
    Opl_Opus_Language_tb OPL
WHERE OPS.ops_id = OPL.ops_id
    AND OPL.lng_id = 1
    AND OPS.ops_activity_code = A.OPUS_CODE",
dbo,OFL_OBLIGATION_FHL_VW,2012-11-16 11:35:20.960,2013-01-07 11:19:45.413,"CREATE VIEW [dbo].[OFL_OBLIGATION_FHL_VW]
AS 
select o.obligation_year as YEAR, o.obligation_org_unit_code AS ORG_UNIT, o.obligation_opus_code AS OPUS_CODE,
    '('+o.obligation_account_code+') '+o.obligation_account_name as ACCOUNT,
    o.obligation_vendor as VENDOR,
    o.obligation_description as DESCRIPTION,
    DATENAME(month, o.obligation_entry_date) as MONTH,
    COUNT(*) AS BUDGET_LINES,
    SUM(O.obligation_amount) as AMOUNT
from OBL_OBLIGATED_VW o
where o.obligation_org_unit_code IN ('KNLFHL-KNX','KNLFHL-ADS','KNLFHL-ITM')    
group by o.obligation_year, o.obligation_org_unit_code, o.obligation_opus_code, '('+o.obligation_account_code+') '+o.obligation_account_name, o.obligation_vendor, o.obligation_description, DATENAME(month, o.obligation_entry_date)",
dbo,OOB_OPERATIONAL_OBLIGATED_BUDGET_VW,2010-05-21 15:23:17.673,2015-09-18 11:09:24.410,"CREATE VIEW [dbo].[OOB_OPERATIONAL_OBLIGATED_BUDGET_VW]
AS 
select
    --- OUTPUT
    out.out_id as output_id,
	aao.kna_id_activity as activity_id,
    (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) as activity_department,
    (select unt.unt_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where kna.kna_id  = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id) as activity_unit,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then 'Approved' when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 'Pending Approval' when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 1 then 'Approved'   when (tag.tag_code = 'CON' or tag.tag_code = 'KCP')  and kna.kna_approved_flag = 0 then 'Pending Approval'   end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header ) as activity_status,
    (select case    when tag.tag_code = 'NEE' and kna.kna_selected_flag = 1 then (select isNull(sum(kpb.kpb_item_cost),0) from Kpb_Knl_Plan_Budget_tb kpb where kpb.kna_id = kna.kna_id) when tag.tag_code = 'NEE' and kna.kna_selected_flag = 0 then 0.00 when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 1 then isNull(kna.kna_approved_amount,0) when (tag.tag_code = 'CON' or tag.tag_code = 'KCP') and kna.kna_approved_flag = 0 then 0.00 end as activity_status    from Kna_Knl_Plan_Activity_tb kna, Tag_Taxonomy_Group_tb tag, Kpd_Knl_Plan_Deliverable_tb kpd where kna.kna_id = aao.kna_id_activity and kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tag.tax_id_group_header) as activity_approved_amount,
    CASE
        WHEN (select dep.dep_name from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Knp_Knl_Plan_Department_tb knp, Dep_Department_tb dep where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.knp_id_plan_department = knp.knp_id and knp.dep_id_department = dep.dep_id) = 'BWP' THEN 'Bank Wide Activity'
        ELSE (select tal.tal_description from Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Tal_Taxonomy_Language_tb tal where kna.kpd_id_deliverable = kpd.kpd_id and kpd.tax_id_type = tal.tax_id and kna.kna_id = aao.kna_id_activity)
    END as activity_type,
    (select tal2.tal_description from Tal_Taxonomy_Language_tb tal2 where tal2.tax_id = out.tax_id_presentation_type) as output_presentation_type,
    output_modality =
	case
		when out.out_modality = 'OUT_FACE_TO_FACE' then 'Face to Face'
		when out.out_modality = 'OUT_WEBINAR' then 'Webinar'
		when out.out_modality = 'OUT_VIRTUAL' then 'Virtual'
		when out.out_modality = 'OUT_SELF_LEARNING' then 'Self-Learning'
		else out.out_modality
	end,
	(select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as output_opus_code,
    output_type =
	case
		when out.out_type = 'OUT_EXTERNAL_EVENT' then 'External Event'
		when out.out_type = 'OUT_GENERAL_EVENT' then 'General Event'
		when out.out_type = 'OUT_GENERAL_SERVICE' then 'General Service'
		when out.out_type = 'OUT_KNOWLEDGE_PRODUCT' then 'Knowledge Product'
		else out.out_type
	end,
    output_unit =
    case 
     when out.out_type = 'OUT_EXTERNAL_EVENT' and out.out_flow_status_code = 'EXT_REVIEWED'
     then (select unt.unt_name from Usr_User_tb usr, Unt_Unit_tb unt, Reu_Registration_User_tb reu, Reg_Registration_tb reg where out.out_id = reg.out_id_outcome and reu.reg_id = reg.reg_id and reu.usr_id = usr.usr_id and unt.unt_id = usr.unt_id_unit and reg.reg_deleted_flag = 0)
    else (select unt.unt_name from Aao_Available_Activity_Outcome_tb aao, Kna_Knl_Plan_Activity_tb kna, Kpd_Knl_Plan_Deliverable_tb kpd, Knd_Knl_Plan_Division_tb knd, Unt_Unit_tb unt where aao.kna_id_activity = kna.kna_id and kna.kpd_id_deliverable = kpd.kpd_id and kpd.knd_id_division = knd.knd_id and knd.unt_id_unit = unt.unt_id and aao.out_id_outcome = out.out_id)
    end,
    out.out_created_date as output_created_date,
    obg.obg_knl_amount as output_budget_knl_amount,
    (select tal3.tal_description from Tal_Taxonomy_Language_tb tal3 where tal3.tax_id = obc.tax_id_category) as output_budget_category,
    obc.obc_item_cost as output_budget_category_amount,
    --- OBLIGATION
    bio.bio_id as obligation_id,
    bio.yea_id_year as obligation_year,
    obligation_entry_type =
	case
		when bio.bio_entry_type = 'BIO_PLAN_ACTIVITY' then 'Plan Activity'
		when bio.bio_entry_type = 'BIO_ADMINISTRATIVE' then 'Administrative'
		when bio.bio_entry_type = 'BIO_OPERATIONAL' then 'Operative'
		else bio.bio_entry_type
	end,
    obligation_vendor =
    case 
     when (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id) is not null
     then (select per3.per_last_name+', '+ per3.per_first_name from Per_Person_tb per3, Fcl_Facilitator_tb fcl1 where per3.per_id = fcl1.per_id_person and bio.fcl_id_vendor = fcl1.fcl_id)
    else (select ins.ins_name from Ins_Institution_tb ins, Fcl_Facilitator_tb fcl2 where ins.ins_id = fcl2.ins_id_institution and bio.fcl_id_vendor = fcl2.fcl_id)
    end,
    consultant_id =
    case 
     when (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1) is not null
     then (select usr.usr_employee_id from Per_Person_tb per, Usr_User_tb usr, Fcl_Facilitator_tb fcl where per.per_id = fcl.per_id_person and bio.fcl_id_vendor = fcl.fcl_id and per.per_id = usr.per_id_person and usr.usr_active_flag = 1 and per.per_active_flag = 1)
    else 'N/A'
    end,
	adc.adc_code as obligation_account_code,
    adc.adc_name as obligation_account_name,
    bou.bou_code as obligation_org_unit_code,
    bio.bio_description as obligation_description,
    obligation_item_type =
	case
		when bio.bio_item_type = 'BIO_CMO' then 'CMO'
		when bio.bio_item_type = 'BIO_CONSULTANT_PO' then 'Consultant PO'
		when bio.bio_item_type = 'BIO_LETTER_OF_AGREEMENT' then 'Letter of Agreement'
		when bio.bio_item_type = 'BIO_OUTPUT_NUMBER' then 'Output Number'
		when bio.bio_item_type = 'BIO_PCARD' then 'PCard'
		when bio.bio_item_type = 'BIO_PROCUREMENT_PO' then 'Procurement PO'
		when bio.bio_item_type = 'BIO_REFERENCE' then 'Reference'
		when bio.bio_item_type = 'BIO_TA_NUMBER' then 'TA Number'
		else bio.bio_item_type
	end,
    bio.bio_item_type_value as obligation_item_value,
    CASE 
        when bio.bio_accounting_type = 'BIO_CREDIT' then (bio.bio_item_cost * -1)
        else bio.bio_item_cost 
    END as obligation_amount,
    ops.ops_activity_code as obligation_opus_code,
    bio.bio_entry_date as obligation_entry_date,
    (select per1.per_last_name+', '+ per1.per_first_name from Per_Person_tb per1 where per1.per_id = bio.per_creator_id) as obligation_creator, 
    bio.bio_last_updated_date as obligation_last_updated_date,
    (select per2.per_last_name+', '+ per2.per_first_name from Per_Person_tb per2 where per2.per_id = bio.per_id_updator) as obligation_last_updator,
     bio.bio_lawson_date as lawson_date
from Bio_Budget_Item_Obligated bio,
    Adc_Administrative_Account_tb adc,
    Bou_Budget_Org_Unit_tb bou,
    Ops_Opus_tb ops,
    Out_Outcome_tb out left outer join Aao_available_activity_outcome_tb aao on out.out_id = aao.out_id_outcome,
    Obg_Outcome_Budget_tb obg,
    Obc_Outcome_Budget_Category_tb obc,
    Boo_Budget_Item_Operational boo
where bio.ops_id_opus = ops.ops_id
    and bio.adc_id_administrative_account = adc.adc_id
    and bio.bou_id_budget_org_unit = bou.bou_id
    and bio.bio_entry_type in ('BIO_OPERATIONAL')
    and bio.bio_id = boo.bio_id
    and boo.obc_id_outcome_budget_category = obc.obc_id
    and obc.obg_id_outcome_budget = obg.obg_id
    and obg.out_id_outcome = out.out_id
    and obg.obg_entry_type = 'OBG_EXECUTED'
    and bio.bio_deleted_date is null",
dbo,OPT_Employees_Training_Plan_vw,2016-01-29 13:59:07.667,2016-03-28 15:26:54.200,"CREATE VIEW [dbo].[OPT_Employees_Training_Plan_vw]
AS 
/*select prr.pro_id as program_id, prr.prr_id as role_id, prr.prr_name as role_name,
    ptp.ptp_id as training_plan_id, ptp.ptp_name as training_plan_name,
    per.per_first_name as first_name, per.per_middle_name as middle_name, per.per_last_name as last_name, 
    per.per_first_name + ' ' + per.per_middle_name + ' ' + per.per_last_name as full_name,
    usr.usr_type as employee_type, per.per_email as employee_email, unt.unt_name as employee_unit, dep.dep_name as employee_department, usr.usr_work_location as employee_location,
    (select count(*) from Usr_User_tb usr1 where usr1.per_id_person = per.per_id and usr1.usr_active_flag = 1) as isActiveFlag
from Prr_Program_Role_tb prr,
    Ptp_Program_Training_Plan_tb ptp,
    Ptu_Program_Training_Plan_User_tb ptu,
    Usr_User_tb usr,
    Per_Person_tb per,
    Unt_Unit_tb unt,
    Dep_Department_tb dep
where prr.pro_id = 5
    and ptp.prr_id_role = prr.prr_id
    and ptu.ptp_id_training_plan = ptp.ptp_id
    and ptu.usr_id_participant = usr.usr_id
    and usr.per_id_person = per.per_id
    and usr.unt_id_unit = unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and ptu.ptu_deleted_flag = 0
    and ptp.ptp_deleted_flag = 0
    and prr.prr_deleted_flag = 0*/
select prr.pro_id as program_id, prr.prr_id as role_id, prr.prr_name as role_name,
    ptp.ptp_id as training_plan_id, ptp.ptp_name as training_plan_name,
    uAct.per_first_name as first_name, uAct.per_middle_name as middle_name, uAct.per_last_name as last_name, 
    uAct.complete_name as full_name,
    uAct.usr_type as employee_type, uAct.per_email as employee_email, uAct.unt_name as employee_unit, uAct.dep_name as employee_department, 
    uAct.usr_work_location as employee_location,
    (select count(*) from Usr_User_tb usr1 where usr1.per_id_person = uAct.per_id and usr1.usr_active_flag = 1) as isActiveFlag
from Prr_Program_Role_tb prr,
    Ptp_Program_Training_Plan_tb ptp,
    Ptu_Program_Training_Plan_User_tb ptu,
    Usr_User_tb usr,
    USR_ACTIVE_EMPLOYEES_VW uAct
where prr.pro_id = 5
    and ptp.prr_id_role = prr.prr_id
    and ptu.ptp_id_training_plan = ptp.ptp_id
    and ptu.usr_id_participant = usr.usr_id
    and usr.per_id_person = uAct.per_id
    and ptu.ptu_deleted_flag = 0
    and ptp.ptp_deleted_flag = 0
    and prr.prr_deleted_flag = 0",
dbo,OPT_Optima_Training_Course_Employee_vw,2016-02-16 13:37:12.387,2016-03-28 15:28:46.183,"CREATE VIEW [dbo].[OPT_Optima_Training_Course_Employee_vw]
AS 
/*select distinct pco.pco_course_name as course_name, pco.pco_order as course_order, 
    pco.pco_type as course_type, lng.lng_code as course_language, 
    pcl.out_id_output as course_output_id, mos.mos_moodle_id as course_moodle_id,
    per.per_email as employee_email, 
    per.per_first_name as employee_first_name, 
    per.per_middle_name as employee_last_name, 
    per.per_last_name as employee_middle_name, 
    per.per_first_name +' '+ per.per_middle_name +' '+ per.per_last_name as employee_complete_name,
    unt.unt_name as employee_unit,
    dep.dep_name as employee_department,
    sec.sec_name as employee_seccion
from Pco_Program_Course_tb pco,
    Pcl_Program_Course_Language_tb pcl,
    Ptu_Program_Training_Plan_User_tb ptu,
    Lng_Language_tb lng,
    Mos_Moodle_Service_tb mos,
    Usr_User_tb usr,
    Per_Person_tb per,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec
where ptu.usr_id_participant = usr.usr_id
    and usr.per_id_person = per.per_id
    and usr.unt_id_unit= unt.unt_id
    and unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    and pcl.pco_id_course = pco.pco_id
    and pcl.lng_id_language = lng.lng_id
    and mos.out_id = pcl.out_id_output
    and pco.ptp_id_training_plan in (select ptp.ptp_id from Prr_Program_Role_tb prr, Ptp_Program_Training_Plan_tb ptp where prr.prr_id = ptp.prr_id_role and prr.pro_id = 5 and ptp.ptp_deleted_flag = 0 and prr.prr_deleted_flag = 0)
    and pco.ptp_id_training_plan = ptu.ptp_id_training_plan
    and pco.pco_deleted_flag = 0
    and ptu.ptu_deleted_flag = 0
    and pcl.pcl_deleted_flag = 0*/
select distinct pco.pco_course_name as course_name, pco.pco_order as course_order, 
    pco.pco_type as course_type, lng.lng_code as course_language, 
    pcl.out_id_output as course_output_id, mos.mos_moodle_id as course_moodle_id,
    uAct.per_email as employee_email, 
    uAct.per_first_name as employee_first_name, 
    uAct.per_middle_name as employee_last_name, 
    uAct.per_last_name as employee_middle_name, 
    uAct.complete_name as employee_complete_name,
    uAct.unt_name as employee_unit,
    uAct.dep_name as employee_department,
    uAct.sec_name as employee_seccion
from Pco_Program_Course_tb pco,
    Pcl_Program_Course_Language_tb pcl,
    Ptu_Program_Training_Plan_User_tb ptu,
    Lng_Language_tb lng,
    Mos_Moodle_Service_tb mos,
    Usr_User_tb usr,
    USR_ACTIVE_EMPLOYEES_VW uAct
where ptu.usr_id_participant = usr.usr_id
    and usr.per_id_person = uAct.per_id
    and pcl.pco_id_course = pco.pco_id
    and pcl.lng_id_language = lng.lng_id
    and mos.out_id = pcl.out_id_output
    and pco.ptp_id_training_plan in (select ptp.ptp_id from Prr_Program_Role_tb prr, Ptp_Program_Training_Plan_tb ptp where prr.prr_id = ptp.prr_id_role and prr.pro_id = 5 and ptp.ptp_deleted_flag = 0 and prr.prr_deleted_flag = 0)
    and pco.ptp_id_training_plan = ptu.ptp_id_training_plan
    and pco.pco_deleted_flag = 0
    and ptu.ptu_deleted_flag = 0
    and pcl.pcl_deleted_flag = 0",
dbo,OPT_Optima_Training_Plan_vw,2016-01-29 13:50:47.940,2016-01-29 13:50:47.940,"CREATE VIEW [dbo].[OPT_Optima_Training_Plan_vw]
AS 
select prr.pro_id as program_id, prr.prr_id as role_id, prr.prr_name as role_name,
    ptp.ptp_id as training_plan_id, ptp.ptp_name as training_plan_name,
    pco.pco_id as course_id, pco.pco_course_name as course_name, pco.pco_order as course_order, 
    pco.pco_type as course_type, lng.lng_code as course_language, 
    pcl.out_id_output as course_output_id, mos.mos_moodle_id as course_moodle_id
from Prr_Program_Role_tb prr,
    Ptp_Program_Training_Plan_tb ptp,
    Pco_Program_Course_tb pco,
    Pcl_Program_Course_Language_tb pcl,
    Lng_Language_tb lng,
    Mos_Moodle_Service_tb mos
where prr.pro_id = 5
    and ptp.prr_id_role = prr.prr_id
    and pcl.pco_id_course = pco.pco_id
    and pcl.lng_id_language = lng.lng_id
    and pco.ptp_id_training_plan = ptp.ptp_id
    and mos.out_id = pcl.out_id_output
    and pco.pco_deleted_flag = 0
    and ptp.ptp_deleted_flag = 0
    and prr.prr_deleted_flag = 0",
dbo,OUA_OUTCOME_ACTIVITY_VW,2010-07-19 18:24:58.843,2014-08-28 09:47:10.480,"CREATE VIEW [dbo].[OUA_OUTCOME_ACTIVITY_VW]
AS 
SELECT A.OUT_ID,
    A.KNA_ID_ACTIVITY,
    CASE
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_GENERAL' THEN 'General Event'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_LANGUAGE' THEN 'Language Group Event'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_MOODLE' AND A.modality = 'OUT_VIRTUAL' THEN 'INDES Virtual Event'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_MOODLE' AND A.modality is null THEN 'INDES Certification'
        WHEN A.OUT_TYPE = 'OUT_EXTERNAL_EVENT' THEN 'External Event'
        WHEN A.OUT_TYPE = 'OUT_KNOWLEDGE_PRODUCT' THEN 'Knowledge Product'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_GENERAL' THEN 'General Self-Learning'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_LANGUAGE' THEN 'Language Private/Semiprivate'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_MOODLE' THEN 'INDES Self-Learning'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_COLLABORATIVE' THEN 'Collaborative Learning'
        ELSE ''
    END AS OUTPUT_TYPE,
    A.OUT_NAME,
    A.OUT_OBJECTIVES,
    A.OUT_COMMENTS,
    CASE
        WHEN A.START_DATE = 'N/A' THEN null
        ELSE cast(A.START_DATE as datetime)
     END AS START_DATE,    
     
    CASE
        WHEN A.END_DATE = 'N/A' THEN null
        ELSE cast(A.END_DATE as datetime)
     END AS END_DATE,

    A.ACTIVITY_CODE,
    A.OUT_CREATED_DATE AS CREATED_DATE,
    isNull(A.ORG_UNIT,'') as ORG_UNIT,
    A.ORG_UNIT_COUNT,
    A.PARTICIPANTS AS PARTICIPANTS,
    A.EVT_TOTAL_DURATION,
    A.PARTICIPANTS * A.EVT_TOTAL_DURATION AS HOURS_DELIVERED,
    A.OBG_KNL_AMOUNT,
   	cast(A.OBLIGATED_AMOUNT as decimal(15,2)) as OBLIGATED_AMOUNT,
	cast(A.EXECUTED_AMOUNT as decimal(15,2)) as EXECUTED_AMOUNT,
	cast(A.OBLIGATED_AMOUNT - A.EXECUTED_AMOUNT  as decimal(15,2)) AS BALANCE_AMOUNT,
    A.out_budget_officer_closed,
    A.out_budget_officer_closed_date,
    A.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    A.out_outcome_budget_status,
    A.out_logistic_required_flag,
    A.OUT_DELETED_FLAG,
    dbo.getKNLOfficersByOutcome(A.out_id) as OutputKNLOfficers
FROM 
(
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    evt.evt_type as subType,
    out.out_modality as modality,
    convert(varchar,evt.evt_start_date,1) as start_date,
    convert(varchar,evt.evt_end_date,1) as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    evt.evt_total_duration, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0) AS OBG_KNL_AMOUNT,
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Evt_Event_tb evt,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and evt.out_id = out.out_id
    and kna.kna_deleted_date is null
    and year(evt.evt_start_date) >= 2010
    and out.out_deleted_flag = 0
union all
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    'EXT_EXTERNAL_EVENT',
    out.out_modality,
    convert(varchar,ext.ext_start_date,1) as start_date,
    convert(varchar,ext.ext_end_date,1) as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    ext.ext_duration, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0),
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Ext_External_Event_tb ext,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and ext.out_id = out.out_id
    and kna.kna_deleted_date is null
    and year(ext.ext_start_date) >= 2010
    and out.out_deleted_flag = 0
union all
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    'PRD_PRODUCT',
    out.out_modality,
    'N/A' as start_date,
    'N/A' as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    0, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0),
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Prd_Product_tb prd,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and kna.kna_deleted_date is null
    and prd.out_id = out.out_id
    and year(out.out_publish_date) >= 2010
    and out.out_deleted_flag = 0    
union all
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    srv.srv_type,
    out.out_modality,
    convert(varchar,srv.srv_start_date,1) as start_date,
    convert(varchar,srv.srv_end_date,1) as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    srv.srv_total_duration, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0),
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Srv_Service_tb srv,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and kna.kna_deleted_date is null
    and srv.out_id = out.out_id
    and year(out.out_publish_date) >= 2010
    and out.out_deleted_flag = 0  
union all
 select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    'LBR_LIBRARY_PRODUCT',
    out.out_modality,
    'N/A' as start_date,
    'N/A' as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    0, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0),
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Lbr_Library_Product_tb lbr,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and kna.kna_deleted_date is null
    and lbr.out_id = out.out_id
    and year(out.out_publish_date) >= 2010
    and out.out_deleted_flag = 0  
) A",
dbo,OUD_OUTCOME_ACTIVITY_DELETED_VW,2012-10-04 12:14:52.263,2012-10-04 12:14:52.263,"CREATE VIEW [dbo].[OUD_OUTCOME_ACTIVITY_DELETED_VW]
AS 
SELECT A.OUT_ID,
    A.KNA_ID_ACTIVITY,
    CASE
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_GENERAL' THEN 'General Event'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_LANGUAGE' THEN 'Language Group Event'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_MOODLE' AND A.modality = 'OUT_VIRTUAL' THEN 'INDES Virtual Event'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_EVENT' AND A.subType = 'EVT_MOODLE' AND A.modality is null THEN 'INDES Certification'
        WHEN A.OUT_TYPE = 'OUT_EXTERNAL_EVENT' THEN 'External Event'
        WHEN A.OUT_TYPE = 'OUT_KNOWLEDGE_PRODUCT' THEN 'Knowledge Product'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_GENERAL' THEN 'General Self-Learning'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_LANGUAGE' THEN 'Language Private/Semiprivate'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_MOODLE' THEN 'INDES Self-Learning'
        WHEN A.OUT_TYPE = 'OUT_GENERAL_SERVICE' AND A.subType = 'SRV_COLLABORATIVE' THEN 'Collaborative Learning'
        ELSE ''
    END AS OUTPUT_TYPE,
    A.OUT_NAME,
    A.OUT_OBJECTIVES,
    A.OUT_COMMENTS,
    CASE
        WHEN A.START_DATE = 'N/A' THEN null
        ELSE cast(A.START_DATE as datetime)
     END AS START_DATE,    
     
    CASE
        WHEN A.END_DATE = 'N/A' THEN null
        ELSE cast(A.END_DATE as datetime)
     END AS END_DATE,

    A.ACTIVITY_CODE,
    A.OUT_CREATED_DATE AS CREATED_DATE,
    isNull(A.ORG_UNIT,'') as ORG_UNIT,
    A.ORG_UNIT_COUNT,
    A.PARTICIPANTS AS PARTICIPANTS,
    A.EVT_TOTAL_DURATION,
    A.PARTICIPANTS * A.EVT_TOTAL_DURATION AS HOURS_DELIVERED,
    A.OBG_KNL_AMOUNT,
   	cast(A.OBLIGATED_AMOUNT as decimal(15,2)) as OBLIGATED_AMOUNT,
	cast(A.EXECUTED_AMOUNT as decimal(15,2)) as EXECUTED_AMOUNT,
	cast(A.OBLIGATED_AMOUNT - A.EXECUTED_AMOUNT  as decimal(15,2)) AS BALANCE_AMOUNT,
    A.out_budget_officer_closed,
    A.out_budget_officer_closed_date,
    A.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    A.out_outcome_budget_status,
    A.out_logistic_required_flag,
    A.OUT_DELETED_FLAG,
    dbo.getKNLOfficersByOutcome(A.out_id) as OutputKNLOfficers
FROM 
(
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    evt.evt_type as subType,
    out.out_modality as modality,
    convert(varchar,evt.evt_start_date,1) as start_date,
    convert(varchar,evt.evt_end_date,1) as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    evt.evt_total_duration, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0) AS OBG_KNL_AMOUNT,
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Evt_Event_tb evt,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and evt.out_id = out.out_id
    and kna.kna_deleted_date is null
    and year(evt.evt_start_date) >= 2010
    and out.out_deleted_flag = 1
union all
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    'EXT_EXTERNAL_EVENT',
    out.out_modality,
    convert(varchar,ext.ext_start_date,1) as start_date,
    convert(varchar,ext.ext_end_date,1) as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    ext.ext_duration, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0),
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Ext_External_Event_tb ext,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and ext.out_id = out.out_id
    and kna.kna_deleted_date is null
    and year(ext.ext_start_date) >= 2010
    and out.out_deleted_flag = 1
union all
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    'PRD_PRODUCT',
    out.out_modality,
    'N/A' as start_date,
    'N/A' as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    0, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0),
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Prd_Product_tb prd,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and kna.kna_deleted_date is null
    and prd.out_id = out.out_id
    and year(out.out_publish_date) >= 2010
    and out.out_deleted_flag = 1  
union all
select out.out_id,
    aao.kna_id_activity,
    out.out_type,
    out.out_name,
    out.out_objectives,
    out.out_comments,
    srv.srv_type,
    out.out_modality,
    convert(varchar,srv.srv_start_date,1) as start_date,
    convert(varchar,srv.srv_end_date,1) as end_date,
    (select ops2.ops_activity_code from Ops_Opus_tb ops2 where ops2.ops_id = out.ops_id_opus) as activity_code,
    (select top 1 isNull(bou.bou_code,'') from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit,
    (select count(distinct bou.bou_code) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2, Bou_Budget_Org_Unit_tb bou where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bou.bou_id = bio.bou_id_budget_org_unit) as org_unit_count,
    (select count(*) from Reg_Registration_tb reg where reg.out_id_outcome = out.out_id and reg.reg_deleted_flag = 0 and reg.reg_showup_flag = 1 and reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED') as participants,
    srv.srv_total_duration, 
    isnull((select obg.obg_amount from Obg_Outcome_Budget_tb obg where obg.out_id_outcome = out.out_id and obg.obg_entry_type = 'OBG_LATEST'),0),
    (select isNull(sum(CASE when bio.bio_accounting_type = 'BIO_CREDIT' then (-1) * bio.bio_item_cost else bio.bio_item_cost end),0) from Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null) as obligated_amount,
    (select isNull(sum(CASE when bie.bie_accounting_type = 'BIE_CREDIT' then (-1) * bie.bie_item_cost else bie.bie_item_cost end),0) from Bie_Budget_Item_Executed bie, Bio_Budget_Item_Obligated bio, Boo_Budget_Item_Operational boo, Obc_Outcome_Budget_Category_tb obc, Obg_Outcome_Budget_tb obg2 where bio.bio_id = bie.bio_id_budget_item_obligated and obc.obg_id_outcome_budget = obg2.obg_id and obg2.out_id_outcome = out.out_id and boo.obc_id_outcome_budget_category = obc.obc_id and boo.bio_id = bio.bio_id and bio.bio_deleted_date is null and bie.bie_deleted_date is null) as executed_amount,
    (select per.per_first_name + ' ' + per.per_last_name from Per_Person_tb per where per.per_id = out.per_id_budget_officer) as out_budget_officer_closed,
    out.out_budget_officer_closed_date,
    out.OUT_BUDGET_OFFICER_CLOSED_FLAG,
    OUT.out_logistic_required_flag,
    out.out_outcome_budget_status, 
    out.out_deleted_flag,
    out.out_created_date
from Out_Outcome_tb out,
    Aao_Available_Activity_Outcome_tb aao,
    Srv_Service_tb srv,
    Ops_Opus_tb ops,
    Kna_Knl_Plan_Activity_tb kna
where kna.ops_id_opus = ops.ops_id
    and out.out_id = aao.out_id_outcome
    and aao.kna_id_activity = kna.kna_id
    and kna.kna_deleted_date is null
    and srv.out_id = out.out_id
    and year(out.out_publish_date) >= 2010
    and out.out_deleted_flag = 1   
) A",
dbo,OUT_COLLABORATIVE_LEARNING_VW,2012-09-11 15:26:20.077,2020-11-04 17:11:13.677,"CREATE VIEW [dbo].[OUT_COLLABORATIVE_LEARNING_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Collaborative Learning' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    srv.srv_total_duration AS TOTAL_DURATION,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_GENERAL' THEN 'SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_MOODLE' THEN 'MOODLE SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_LANGUAGE' THEN 'LANGUAGE SERVICE'  when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_COLLABORATIVE' THEN 'Collaborative Learning'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE /*REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    -- SERVICE
    srv.srv_start_date AS START_DATE,
    srv.srv_end_date AS END_DATE,
    srv.srv_active_flag AS ACTIVE_FLAG,
    srv.srv_registration_cofinancing AS REGISTRATION_COFINANCING,
    srv.srv_registration_fee AS REGISTRATION_FEE,
    srv.srv_private_registration_flag AS PRIVATE_REGISTRATION,
    CASE WHEN flw.flw_code = 'SRV_NONE' THEN 'NOT REQUIRES SUPERVISOR APPROVAL' WHEN flw.flw_code = 'SRV_APPROVAL' THEN 'REQUIRES SUPERVISOR APPROVAL' ELSE 'N/A' END AS FLOW_CODE,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
    Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        /*and bio.bio_deleted_date is null*/
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Srv_Service_tb srv,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = srv.out_id
    and srv.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    and srv.srv_type = 'SRV_COLLABORATIVE'",
dbo,OUT_EXTERNAL_EVENT_VW,2011-04-20 08:24:26.470,2020-11-04 17:02:32.213,"CREATE VIEW [dbo].[OUT_EXTERNAL_EVENT_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_EXTERNAL_EVENT' THEN 'EXTERNAL EVENT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    loc.loc_description AS LOCATION_NAME,
    loc.loc_type AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c where c.cti_id = loc.cti_id_city) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE /*REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    -- EXTERNAL EVENT
    ext.ext_start_date AS START_DATE,
    ext.ext_end_date AS END_DATE,
    ext.ext_duration AS TOTAL_DURATION,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        /*and bio.bio_deleted_date is null*/
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Ext_External_Event_tb ext,
    Loc_Location_tb loc,
    Ops_Opus_tb ops
where o.out_id = ext.out_id
    and o.loc_id_location = loc.loc_id
    and ops.ops_id = o.ops_id_opus
    and (SELECT COUNT(*)
        FROM Reg_Registration_tb REG
        WHERE /*REG.reg_deleted_flag = 0
            AND REG.reg_showup_flag = 1
            AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
            AND REG.out_id_outcome = O.OUT_ID) > 0
union all
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_EXTERNAL_EVENT' THEN 'EXTERNAL EVENT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    Institutions.ins_name AS LOCATION_NAME,
    'LOC_EXTERNAL_FACILITY' AS LOCATION_TYPE,
    Cities.cti_name AS LOCATION_CITY,
    Countries.ctr_name AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE /*REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    -- EXTERNAL EVENT
    ext.ext_start_date AS START_DATE,
    ext.ext_end_date AS END_DATE,
    ext.ext_duration AS TOTAL_DURATION,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
      AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        /*and bio.bio_deleted_date is null*/
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Ext_External_Event_tb ext,
    Ops_Opus_tb ops,
    Ins_Institution_tb Institutions,
    Cti_City_tb as Cities,
    Ctr_Country_tb as Countries
where o.out_id = ext.out_id
    and ext.ins_id_institution = Institutions.ins_id
    and Institutions.cti_id_city = Cities.cti_id
    and Cities.ctr_id_country = Countries.ctr_id
    and ops.ops_id = o.ops_id_opus
    and (SELECT COUNT(*)
        FROM Reg_Registration_tb REG
        WHERE /*REG.reg_deleted_flag = 0
            AND REG.reg_showup_flag = 1
            AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
            AND REG.out_id_outcome = O.OUT_ID) > 0",
dbo,OUT_FHL_PRODUCT_VW,2013-04-02 12:17:56.693,2016-06-22 10:14:55.197,"CREATE VIEW [dbo].[OUT_FHL_PRODUCT_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_LIBRARY_PRODUCT' THEN 'LIBRARY PRODUCT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    '' AS LOCATION_NAME,
    '' AS LOCATION_TYPE,
    '' AS LOCATION_CITY,
    '' AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    CASE WHEN lbr.lbr_transaction_type = 'FHL_NEW' THEN 'NEW' 
         WHEN lbr.lbr_transaction_type = 'FHL_RENEW' THEN 'RENEW' 
         ELSE 'UNKNOWN'
    END AS TRANSACTION_TYPE,
     CASE WHEN lbr.lbr_format = 'LBR_PRINT' THEN 'PRINT' 
         WHEN lbr.lbr_format = 'LBR_ELECTRONIC' THEN 'ELECTRONIC' 
         WHEN lbr.lbr_format = 'LBR_PRINT_ELECTRONIC' THEN 'PRINT AND ELECTRONIC' 
         ELSE 'UNKNOWN'
    END AS FORMAT,
    lbr.lbr_coverage_from AS COVERAGE_FROM,
    lbr.lbr_coverage_to AS COVERAGE_TO,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        and bio.bio_deleted_date is null
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        AND S.sof_deleted_flag = 0) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Lbr_Library_Product_tb lbr,
    Ops_Opus_tb ops
where o.out_id = lbr.out_id
    and ops.ops_id = o.ops_id_opus",
dbo,OUT_GENERAL_EVENT_VW,2011-04-19 18:27:54.900,2020-11-04 12:30:58.160,"CREATE VIEW [dbo].[OUT_GENERAL_EVENT_VW]
AS 
-- GENERAL EVENTS
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'Face to Face' when O.out_modality = 'OUT_WEBINAR' THEN 'Webinar' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'Self-Learning' when O.out_modality = 'OUT_VIRTUAL' THEN 'Virtual with Tutor' end AS MODALITY,
    CASE WHEN evt.evt_type = 'EVT_GENERAL' AND o.out_modality = 'OUT_WEBINAR' THEN 'Webinar'
         WHEN evt.evt_type = 'EVT_GENERAL' AND o.out_modality = 'OUT_VIRTUAL' THEN 'Virtual with Tutor'
         ELSE (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) 
    END AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    dbo.getKNLOfficersByOutcome(o.out_id) as KNLOFFICERS,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_GENERAL' THEN 'General Event' 
         when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_MOODLE' THEN 'Moodle Event' 
         when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_LANGUAGE' THEN 'Language Group Event' 
         ELSE 'UNKNOWN' 
    END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    -- EVENT
    evt.evt_start_date AS START_DATE,
    evt.evt_end_date AS END_DATE,
    evt.evt_registration_deadline AS DEADLINE,
    evt.evt_max_number_participants AS MAX_PARTICIPANTS,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE /*REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    evt.evt_registration_cofinancing AS REGISTRATION_COFINANCING,
    evt.evt_registration_fee AS REGISTRATION_FEE,
    evt.evt_private_registration_flag AS PRIVATE_REGISTRATION,
    evt.evt_total_duration AS TOTAL_DURATION,
    evt.evt_online_flag AS ONLINE_FLAG,
    CASE WHEN flw.flw_code = 'EVT_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'EVT_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    (select top 1 isNull(per.per_first_name + ' ' + per.per_last_name,'') from Oko_Outcome_KNLOfficer_tb oko, Per_Person_tb per where oko.out_id_outcome = o.OUT_ID and oko.per_id_responsible = per.per_id and oko.oko_type = 'OKO_LOGISTIC' and oko.oko_active_flag = 1) as logistic_assistant,
    (select top 1 isNull(per.per_first_name + ' ' + per.per_last_name,'') from Oko_Outcome_KNLOfficer_tb oko, Per_Person_tb per where oko.out_id_outcome = o.OUT_ID and oko.per_id_responsible = per.per_id and oko.oko_type = 'OKO_AUDIOVISUALS' and oko.oko_active_flag = 1) as audiovisuals_assistant,
    (select top 1 isNull(per.per_first_name + ' ' + per.per_last_name,'') from Oko_Outcome_KNLOfficer_tb oko, Per_Person_tb per where oko.out_id_outcome = o.OUT_ID and oko.per_id_responsible = per.per_id and oko.oko_type = 'OKO_BUDGET' and oko.oko_active_flag = 1) as budget_assistant,
    dbo.getTargetAudienceByOutcome(o.out_id) as target_audience,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        /*and bio.bio_deleted_date is null*/
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY     
from Out_Outcome_tb o,
    Evt_Event_tb evt,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = evt.out_id
    and evt.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    and evt.evt_type = 'EVT_GENERAL'",
dbo,OUT_GENERAL_SERVICE_VW,2011-04-20 08:33:01.997,2020-11-04 17:04:46.380,"CREATE VIEW [dbo].[OUT_GENERAL_SERVICE_VW]
AS 
SELECT
	o.out_id                              AS OUT_ID,
	o.out_name                            AS NAME,
	o.out_objectives                      AS OBJECTIVES,
	O.out_comments                        AS COMMENTS,
	CASE 
		WHEN O.out_modality = 'OUT_FACE_TO_FACE' 
		THEN 'FACE TO FACE' 
		WHEN O.out_modality = 'OUT_WEBINAR' 
		THEN 'WEBINAR' 
		WHEN O.out_modality = 'OUT_SELF_LEARNING' 
		THEN 'SELF-LEARNING' 
		WHEN O.out_modality = 'OUT_VIRTUAL' 
		THEN 'VIRTUAL' 
		WHEN (	SELECT
					ISNULL(tag.tag_code,'') 
				FROM
					Tag_Taxonomy_Group_tb tag,
					Tax_Taxonomy_tb tax 
				WHERE
					tag.tax_id_group_header = tax.tax_parent_id AND
					tax.tax_id = o.tax_id_presentation_type) = 'OLL' 
		THEN 'SELF-LEARNING' 
		WHEN O.out_modality = 'OUT_MOOC' 
		THEN 'MOOC' 
	END                                       AS MODALITY,
	'General Self-Learning'               AS PRESENTATION_TYPE,
	(	SELECT
			t.tal_description 
		FROM
			Tal_Taxonomy_Language_tb t 
		WHERE
			t.tax_id = o.tax_id_subject_type AND
			t.lng_id = 1)                                    AS SUBJECT_TYPE,
	ops.ops_activity_code                 AS OPUS_CODE,
	ops.ops_id AS OPUS_ID,
    o.out_created_date                    AS CREATED_DATE,
	o.out_deleted_date                    AS DELETED_DATE,
	o.out_publish_date                    AS PUBLISHED_DATE,
	srv.srv_total_duration                AS TOTAL_DURATION,
	(	SELECT
			per.per_first_name +' ' + per.per_last_name 
		FROM
			Per_Person_tb per 
		WHERE
			per.per_id = o.per_id_creator)                                    AS 
	CREATOR,
	dbo.getKNLOfficersByOutcome(o.out_id) AS KNLOFFICERS,
	(	SELECT
			per.per_first_name +' ' + per.per_last_name 
		FROM
			Per_Person_tb per 
		WHERE
			per.per_id = o.per_id_deletor)                                    AS 
	DELETOR,
	CASE 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_GENERAL' 
		THEN 'Self-Learning' 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_MOODLE' 
		THEN 'Moodle Self-Learning' 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_LANGUAGE' 
		THEN 'Language Service' 
		WHEN o.out_type = 'OUT_GENERAL_SERVICE' AND
		srv.srv_type = 'SRV_MOOC' 
		THEN 'MOOC' 
		ELSE 'UNKNOWN' 
	END                                       AS OUT_TYPE,
	(	SELECT
			loc.loc_description 
		FROM
			Loc_Location_tb loc 
		WHERE
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_NAME,
	(	SELECT
			loc.loc_type 
		FROM
			Loc_Location_tb loc 
		WHERE
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_TYPE,
	(	SELECT
			C.cti_name 
		FROM
			Cti_City_tb C,
			Loc_Location_tb loc 
		WHERE
			C.cti_id = loc.cti_id_city AND
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_CITY,
	(	SELECT
			y.ctr_local_name 
		FROM
			Cti_City_tb C,
			Ctr_Country_tb y,
			Loc_Location_tb loc 
		WHERE
			C.cti_id = loc.cti_id_city AND
			C.ctr_id_country = y.ctr_id AND
			loc.loc_id = o.loc_id_location)                                    
	AS LOCATION_COUNTRY,
	o.out_flow_status_code                AS STATUS_CODE,
	o.out_outcome_budget_status           AS BUDGET_STATUS_CODE,
	o.out_budget_officer_closed_date      AS BUDGET_OFFICER_CLOSED_DATE,
	(	SELECT
			per.per_first_name +' ' + per.per_last_name 
		FROM
			Per_Person_tb per 
		WHERE
			per.per_id = o.per_id_budget_officer)                                    
	AS CLOSER,
	o.out_last_updated_Date               AS LAST_UPDATED_DATE,
	(	SELECT
			COUNT(*) 
		FROM
			Reg_Registration_tb REG 
		WHERE
			/*REG.reg_deleted_flag = 0 AND
			REG.reg_showup_flag = 1 AND*/
			REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED' AND
			REG.out_id_outcome = O.OUT_ID)                                    AS 
	TOTAL_PARTICIPANTS,
	-- SERVICE
	srv.srv_start_date                    AS START_DATE,
	srv.srv_end_date                      AS END_DATE,
	srv.srv_active_flag                   AS ACTIVE_FLAG,
	srv.srv_registration_cofinancing      AS REGISTRATION_COFINANCING,
	srv.srv_registration_fee              AS REGISTRATION_FEE,
	srv.srv_private_registration_flag     AS PRIVATE_REGISTRATION,
	CASE 
		WHEN flw.flw_code = 'SRV_NONE' 
		THEN 'NO APPROVAL REQUIRED' 
		WHEN flw.flw_code = 'SRV_APPROVAL' 
		THEN 'SUPERVISOR APPROVAL REQUIRED' 
		ELSE 'N/A' 
	END                                       AS FLOW_CODE,
	(	SELECT
			ISNULL(SUM(OBG.obg_amount),0) 
		FROM
			Obg_Outcome_Budget_tb obg 
		WHERE
			obg.obg_entry_type = 'OBG_LATEST' AND
			obg.out_id_outcome = O.OUT_ID)                                    AS 
	ESTIMATED_TOTAL_COST,
	(	SELECT
			ISNULL(SUM(SOF.sof_amount),0) 
		FROM
			Aao_Available_Activity_Outcome_tb AAO,
			Sat_Source_Of_Funding_Activity_tb SAT,
			Sof_Source_Of_Funding_tb SOF 
		WHERE
			AAO.out_id_outcome = O.OUT_ID AND
			SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity AND
			SOF.sof_id = SAT.sof_id AND
			SOF.out_id_outcome = O.OUT_ID /*AND
			SOF.sof_deleted_flag = 0*/)                                    AS 
	FINANCED_BY_ASSOCIATED_ACTIVITY,
	(	SELECT
			ISNULL(SUM(SOF.sof_amount),0) 
		FROM
			Aao_Available_Activity_Outcome_tb AAO,
			Sat_Source_Of_Funding_Activity_tb SAT,
			Sof_Source_Of_Funding_tb SOF 
		WHERE
			AAO.out_id_outcome = O.OUT_ID AND
			SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity AND
			SOF.sof_id = SAT.sof_id AND
			SOF.out_id_outcome = O.OUT_ID /*AND
			SOF.sof_deleted_flag = 0*/)                                    AS 
	FINANCED_BY_OTHER_KNAS,
	(	SELECT
			ISNULL(SUM(SOF.sof_amount),0) 
		FROM
			Sof_Source_Of_Funding_tb SOF,
			Sac_Source_Of_Funding_Account_tb SAC 
		WHERE
			SOF.sof_id = SAC.sof_id AND
			SOF.out_id_outcome = O.OUT_ID /*AND
			SOF.sof_deleted_flag = 0*/)                                    AS 
	FINANCED_BY_OTHER_SOURCES,
	(	SELECT
			ISNULL(SUM( 
			CASE 
				WHEN (bio.bio_accounting_type = 'BIO_CREDIT') 
				THEN bio.bio_item_cost*(-1) 
				ELSE bio.bio_item_cost 
			END),0) 
		FROM
			Obg_Outcome_Budget_tb obg,
			Obc_Outcome_Budget_Category_tb obc,
			Boo_Budget_Item_Operational boo,
			Bio_Budget_Item_Obligated bio 
		WHERE
			obg.obg_entry_type = 'OBG_EXECUTED' AND
			bio.bio_deleted_date IS NULL AND
			obg.out_id_outcome = O.OUT_ID AND
			obc.obg_id_outcome_budget = obg.obg_id AND
			boo.obc_id_outcome_budget_category = obc.obc_id AND
			boo.bio_id = bio.bio_id)                                    AS 
	DISBURSED_AMOUNT,
	(	SELECT
			ISNULL(SUM(S.sof_executed_amount),0) 
		FROM
			Sof_Source_Of_Funding_tb S 
		WHERE
			S.out_id_outcome = O.OUT_ID /*AND
			S.sof_deleted_flag = 0*/)                                    AS 
	DISBURSED_SOF,
	(	SELECT
			ISNULL(SUM(SOF.sof_executed_amount),0) 
		FROM
			Aao_Available_Activity_Outcome_tb AAO,
			Sat_Source_Of_Funding_Activity_tb SAT,
			Sof_Source_Of_Funding_tb SOF 
		WHERE
			AAO.out_id_outcome = O.OUT_ID AND
			SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity AND
			SOF.sof_id = SAT.sof_id AND
			SOF.out_id_outcome = O.OUT_ID /*AND
			SOF.sof_deleted_flag = 0*/)                                    AS 
	DISBURSED_BY_ASSOCIATED_ACTIVITY 
FROM
	Out_Outcome_tb o,
	Srv_Service_tb srv,
	Flw_Flow_tb flw,
	Ops_Opus_tb ops 
WHERE
	o.out_id = srv.out_id AND
	srv.flw_id_flow = flw.flw_id AND
	ops.ops_id = o.ops_id_opus AND
	srv.srv_type IN ('SRV_GENERAL',	'SRV_MOOC')",
dbo,OUT_KNOWLEDGE_PRODUCT_VW,2011-04-20 08:26:07.707,2016-06-22 10:18:21.123,"CREATE VIEW [dbo].[OUT_KNOWLEDGE_PRODUCT_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_presentation_type and t.lng_id = 1) AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_ID AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_KNOWLEDGE_PRODUCT' THEN 'KNOWLEDGE PRODUCT'  ELSE 'UNKNOWN' END AS OUT_TYPE,
    '' AS LOCATION_NAME,
    '' AS LOCATION_TYPE,
    '' AS LOCATION_CITY,
    '' AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        and bio.bio_deleted_date is null
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        AND S.sof_deleted_flag = 0) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        AND SOF.sof_deleted_flag = 0) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Prd_Product_tb prd,
    Ops_Opus_tb ops
where o.out_id = prd.out_id
    and ops.ops_id = o.ops_id_opus",
dbo,OUT_LANGUAGE_GROUP_EVENT_VW,2011-04-19 18:34:23.783,2020-11-04 16:59:44.267,"CREATE VIEW [dbo].[OUT_LANGUAGE_GROUP_EVENT_VW]
AS 
-- LANGUAGE GROUP EVENTS
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    'FACE TO FACE' AS MODALITY,
    'Language Group Event' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    dbo.getKNLOfficersByOutcome(o.out_id) as KNLOFFICERS,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_GENERAL' THEN 'GENERAL EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_MOODLE' THEN 'MOODLE EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_LANGUAGE' THEN 'LANGUAGE GROUP EVENT' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    -- EVENT
    evt.evt_start_date AS START_DATE,
    evt.evt_end_date AS END_DATE,
    evt.evt_registration_deadline AS DEADLINE,
    evt.evt_max_number_participants AS MAX_PARTICIPANTS,
    evt.evt_registration_cofinancing AS REGISTRATION_COFINANCING,
    evt.evt_registration_fee AS REGISTRATION_FEE,
    evt.evt_private_registration_flag AS PRIVATE_REGISTRATION,
    evt.evt_total_duration AS TOTAL_DURATION,
    evt.evt_online_flag AS ONLINE_FLAG,
    CASE WHEN flw.flw_code = 'EVT_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'EVT_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    --- LANGUAGE GROUP EVENT
    (SELECT P.per_first_name +' ' + P.per_last_name FROM Per_Person_tb P, Fcl_Facilitator_tb FCL, Tea_Teacher_tb TEA WHERE TEA.tea_id = LGE.tea_id_teacher AND FCL.per_id_person = P.per_id AND FCL.fcl_id = TEA.fcl_id_facilitator) AS TEACHER,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        and bio.bio_deleted_date is null
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Evt_Event_tb evt,
    Lge_Language_Group_Event_tb LGE,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = evt.out_id
    and evt.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    AND EVT.out_id = LGE.out_id
    AND EVT.EVT_TYPE = 'EVT_LANGUAGE'",
dbo,OUT_LANGUAGE_SERVICE_VW,2011-04-20 08:38:37.320,2020-11-04 17:13:28.343,"CREATE VIEW [dbo].[OUT_LANGUAGE_SERVICE_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Language Individual' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_ID AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    srv.srv_total_duration AS TOTAL_DURATION,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    dbo.getKNLOfficersByOutcome(o.out_id) as KNLOFFICERS,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_GENERAL' THEN 'SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_MOODLE' THEN 'MOODLE SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_LANGUAGE' THEN 'LANGUAGE SERVICE' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE /*REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    -- SERVICE
    srv.srv_active_flag AS ACTIVE_FLAG,
    srv.srv_registration_cofinancing AS REGISTRATION_COFINANCING,
    srv.srv_registration_fee AS REGISTRATION_FEE,
    srv.srv_private_registration_flag AS PRIVATE_REGISTRATION,
    CASE WHEN flw.flw_code = 'SRV_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'SRV_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    srv.srv_start_date as START_DATE,
    srv.srv_end_date as END_DATE,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_entry_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        /*and bio.bio_deleted_date is null*/
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Srv_Service_tb srv,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = srv.out_id
    and srv.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    and srv.srv_type = 'SRV_LANGUAGE'",
dbo,OUT_MOODLE_EVENT_VW,2011-04-20 08:11:02.033,2020-11-04 12:36:12.800,"CREATE VIEW [dbo].[OUT_MOODLE_EVENT_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Indes Virtual Event' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    dbo.getKNLOfficersByOutcome(o.out_id) as KNLOFFICERS,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_GENERAL' THEN 'GENERAL EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_MOODLE' THEN 'MOODLE EVENT' when o.out_type = 'OUT_GENERAL_EVENT' and evt.evt_type = 'EVT_LANGUAGE' THEN 'LANGUAGE GROUP EVENT' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_logistic_required_flag AS LOGISTICS_FLAG,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE /*REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND */REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    -- EVENT
    evt.evt_start_date AS START_DATE,
    evt.evt_end_date AS END_DATE,
    evt.evt_registration_deadline AS DEADLINE,
    evt.evt_max_number_participants AS MAX_PARTICIPANTS,
    evt.evt_registration_cofinancing AS REGISTRATION_COFINANCING,
    evt.evt_registration_fee AS REGISTRATION_FEE,
    evt.evt_private_registration_flag AS PRIVATE_REGISTRATION,
    evt.evt_total_duration AS TOTAL_DURATION,
    evt.evt_online_flag AS ONLINE_FLAG,
    CASE WHEN flw.flw_code = 'EVT_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'EVT_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    --- MOODLE EVENT
    moe.moe_moodle_id AS MOODLE_ID,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        /*and bio.bio_deleted_date is null*/
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Evt_Event_tb evt,
    Moe_Moodle_Event_tb moe,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = evt.out_id
    and evt.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus
    AND EVT.out_id = moe.out_id
    AND EVT.EVT_TYPE = 'EVT_MOODLE'",
dbo,OUT_MOODLE_SERVICE_VW,2011-04-20 08:35:37.167,2020-11-04 17:08:10.853,"CREATE VIEW [dbo].[OUT_MOODLE_SERVICE_VW]
AS 
select 
    o.out_id AS OUT_ID,
    o.out_name AS NAME,
    o.out_objectives AS OBJECTIVES,
    O.out_comments AS COMMENTS,
    case when O.out_modality = 'OUT_FACE_TO_FACE' THEN 'FACE TO FACE' when O.out_modality = 'OUT_WEBINAR' THEN 'WEBINAR' when O.out_modality = 'OUT_SELF_LEARNING' THEN 'SELF-LEARNING' when O.out_modality = 'OUT_VIRTUAL' THEN 'VIRTUAL' end AS MODALITY,
    'Indes Virtual Self-Learning' AS PRESENTATION_TYPE,
    (select t.tal_description from Tal_Taxonomy_Language_tb t where t.tax_id = o.tax_id_subject_type and t.lng_id = 1) AS SUBJECT_TYPE,
    ops.ops_activity_code AS OPUS_CODE,
    ops.ops_id AS OPUS_ID,
    o.out_created_date AS CREATED_DATE,
    o.out_deleted_date AS DELETED_DATE,
    o.out_publish_date AS PUBLISHED_DATE,
    srv.srv_total_duration AS TOTAL_DURATION,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_creator) as CREATOR,
    dbo.getKNLOfficersByOutcome(o.out_id) as KNLOFFICERS,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_deletor) as DELETOR,
    case when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_GENERAL' THEN 'SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_MOODLE' THEN 'MOODLE SELF-LEARNING' when o.out_type = 'OUT_GENERAL_SERVICE' and srv.srv_type = 'SRV_LANGUAGE' THEN 'LANGUAGE SERVICE' ELSE 'UNKNOWN' END AS OUT_TYPE,
    (select loc.loc_description from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_NAME,
    (select loc.loc_type from Loc_Location_tb loc where loc.loc_id = o.loc_id_location) AS LOCATION_TYPE,
    (select c.cti_name from Cti_City_tb c, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and loc.loc_id = o.loc_id_location) AS LOCATION_CITY,
    (select y.ctr_local_name from Cti_City_tb c, Ctr_Country_tb y, Loc_Location_tb loc where c.cti_id = loc.cti_id_city and c.ctr_id_country = y.ctr_id and loc.loc_id = o.loc_id_location) AS LOCATION_COUNTRY,
    o.out_flow_status_code AS STATUS_CODE,
    o.out_outcome_budget_status AS BUDGET_STATUS_CODE,
    o.out_budget_officer_closed_date AS BUDGET_OFFICER_CLOSED_DATE,
    (select per.per_first_name +' ' + per.per_last_name from Per_Person_tb per where per.per_id = o.per_id_budget_officer) as CLOSER,
    o.out_last_updated_Date as LAST_UPDATED_DATE,
    (SELECT COUNT(*)
    FROM Reg_Registration_tb REG
    WHERE /*REG.reg_deleted_flag = 0
        AND REG.reg_showup_flag = 1
        AND*/ REG.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
        AND REG.out_id_outcome = O.OUT_ID) AS TOTAL_PARTICIPANTS,
    -- EVENT
    srv.srv_start_date AS START_DATE,
    srv.srv_end_date AS END_DATE,
    srv.srv_active_flag AS ACTIVE_FLAG,
    srv.srv_registration_cofinancing AS REGISTRATION_COFINANCING,
    srv.srv_registration_fee AS REGISTRATION_FEE,
    srv.srv_private_registration_flag AS PRIVATE_REGISTRATION,
    CASE WHEN flw.flw_code = 'SRV_NONE' THEN 'NO APPROVAL REQUIRED' WHEN flw.flw_code = 'SRV_APPROVAL' THEN 'SUPERVISOR APPROVAL REQUIRED' ELSE 'N/A' END AS FLOW_CODE,
    -- MOODLE
    mos.mos_moodle_id AS MOODLE_ID,
    (SELECT ISNULL(SUM(OBG.obg_amount),0)
     FROM Obg_Outcome_Budget_tb obg
     WHERE obg.obg_entry_type = 'OBG_LATEST'
        AND obg.out_id_outcome = O.OUT_ID) AS ESTIMATED_TOTAL_COST,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_ASSOCIATED_ACTIVITY,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan <> AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_KNAS,
    (SELECT ISNULL(SUM(SOF.sof_amount),0)
     FROM Sof_Source_Of_Funding_tb SOF,
          Sac_Source_Of_Funding_Account_tb SAC
     WHERE SOF.sof_id = SAC.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS FINANCED_BY_OTHER_SOURCES,
    (SELECT ISNULL(SUM(case when (bio.bio_accounting_type = 'BIO_CREDIT') then bio.bio_item_cost*(-1) else bio.bio_item_cost end),0)
     FROM Obg_Outcome_Budget_tb obg,
          Obc_Outcome_Budget_Category_tb obc,
          Boo_Budget_Item_Operational boo,
          Bio_Budget_Item_Obligated bio
     WHERE obg.obg_entry_type = 'OBG_EXECUTED'
        /*and bio.bio_deleted_date is null*/
        AND obg.out_id_outcome = O.OUT_ID
        AND obc.obg_id_outcome_budget = obg.obg_id
        and boo.obc_id_outcome_budget_category = obc.obc_id
        and boo.bio_id = bio.bio_id) AS DISBURSED_AMOUNT,
     (SELECT ISNULL(SUM(S.sof_executed_amount),0)
     FROM Sof_Source_Of_Funding_tb S
     WHERE S.out_id_outcome = O.OUT_ID
        /*AND S.sof_deleted_flag = 0*/) AS DISBURSED_SOF,
    (SELECT ISNULL(SUM(SOF.sof_executed_amount),0)
     FROM Aao_Available_Activity_Outcome_tb AAO,
          Sat_Source_Of_Funding_Activity_tb SAT,
          Sof_Source_Of_Funding_tb SOF
     WHERE AAO.out_id_outcome = O.OUT_ID
        AND SAT.kna_id_knl_administrative_plan = AAO.kna_id_activity
        AND SOF.sof_id = SAT.sof_id
        AND SOF.out_id_outcome = O.OUT_ID
        /*AND SOF.sof_deleted_flag = 0*/) AS DISBURSED_BY_ASSOCIATED_ACTIVITY 
from Out_Outcome_tb o,
    Srv_Service_tb srv,
    Mos_Moodle_Service_tb mos,
    Flw_Flow_tb flw,
    Ops_Opus_tb ops
where o.out_id = srv.out_id
    and mos.out_id = srv.out_id
    and srv.flw_id_flow = flw.flw_id
    and ops.ops_id = o.ops_id_opus",
dbo,OUT_OUTPUT_VW,2013-03-19 15:10:25.690,2020-11-04 11:54:01.693,"CREATE VIEW [dbo].[OUT_OUTPUT_VW]
AS
SELECT A.*,
  (select act.yea_year from act_activities_vw act where activityID = A.KNA_ID) as KNA_YEAR,
  case 
        when (SELECT COUNT(*) FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) = 0 AND A.OUT_TYPE = 'External Event' THEN 'INTERNAL'
        when (SELECT COUNT(*) FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) = 0 THEN 'UNKNOWN'
        when (select count(*) from ( (SELECT O.tax_id  FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) EXCEPT (select tax.tax_id from Tax_Taxonomy_tb tax where tax.tax_id in (445,446,447)) ) as u) = (SELECT COUNT(*) FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) AND (SELECT COUNT(*) FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) > 0 then 'INTERNAL'
        when (select count(*) from ( (SELECT O.tax_id  FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) EXCEPT (select tax.tax_id from Tax_Taxonomy_tb tax where tax.tax_id in (445,446,447)) ) as u) = 0 then 'EXTERNAL'
        when (SELECT COUNT(*) FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) > (select count(*) from ( (SELECT O.tax_id  FROM Ota_Outcome_Target_Audience_tb O WHERE O.out_id = A.OUT_ID) EXCEPT (select tax.tax_id from Tax_Taxonomy_tb tax where tax.tax_id in (445,446,447)) ) as u)  then 'BOTH'
        else '--'
    end as AUDIENCE,
   OPL.opl_description AS OPUS_NAME,
   CASE WHEN A.BUDGET_OFFICER_CLOSED_DATE IS NULL THEN A.FINANCED_BY_ASSOCIATED_ACTIVITY
        ELSE A.DISBURSED_BY_ASSOCIATED_ACTIVITY
   END AS PROGRAMMED_AMOUNT,
   dbo.getTopicsByOutput(a.out_id) AS OUT_TOPICS,
   dbo.getTargetDepartmentsByOutput(a.out_id) as OUT_DEPARTMENTS
FROM 
(SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, 
    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
    NULL AS TRANSACTION_TYPE,  NULL AS FORMAT, NULL AS COVERAGE_FROM, NULL AS COVERAGE_TO,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF, O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_GENERAL_EVENT_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_LANGUAGE_GROUP_EVENT_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_MOODLE_EVENT_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, 
    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_EXTERNAL_EVENT_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, O.END_DATE, NULL, NULL, NULL, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL, O.FLOW_CODE, NULL, NULL, O.ACTIVE_FLAG,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_GENERAL_SERVICE_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, O.END_DATE, NULL, NULL, NULL, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL, O.FLOW_CODE, NULL, O.MOODLE_ID, O.ACTIVE_FLAG,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_MOODLE_SERVICE_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, O.END_DATE, NULL, NULL, NULL, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL, O.FLOW_CODE, NULL, NULL, O.ACTIVE_FLAG,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_LANGUAGE_SERVICE_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
    O.END_DATE, O.END_DATE, NULL, NULL, NULL, O.PRIVATE_REGISTRATION,
    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    O.TOTAL_PARTICIPANTS,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_COLLABORATIVE_LEARNING_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    NULL, NULL, NULL, NULL,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    0,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_KNOWLEDGE_PRODUCT_VW O
/*WHERE O.DELETED_DATE IS NULL*/
UNION ALL
SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE, O.OPUS_ID,
    O.CREATED_DATE, O.CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY,
    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    NULL, NULL, NULL, NULL, NULL, NULL,
    O.TRANSACTION_TYPE, O.FORMAT, O.COVERAGE_FROM, O.COVERAGE_TO,
    O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF,O.DISBURSED_BY_ASSOCIATED_ACTIVITY,
    0,
    (SELECT AAO.kna_id_activity FROM Aao_Available_Activity_Outcome_tb AAO WHERE AAO.out_id_outcome = O.OUT_ID) AS KNA_ID
FROM OUT_FHL_PRODUCT_VW O
/*WHERE O.DELETED_DATE IS NULL*/) AS A,
    Opl_Opus_Language_tb OPL
WHERE OPL.lng_id = 1
    AND OPL.ops_id = A.OPUS_ID",
dbo,OUT_OUTPUTS_FINANCED_VW_2013,2013-07-25 13:04:20.883,2013-07-25 13:05:48.600,"CREATE VIEW [dbo].[OUT_OUTPUTS_FINANCED_VW_2013]
AS 
select 
	a1.activityID financedKNAID, a2.depName associatedDept, a2.unit associatedUnit, a2.activityID associatedKNAID, o.OUT_ID,
    O.NAME, O.OBJECTIVES, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.AUDIENCE, O.OPUS_CODE,
    O.OUT_CREATED_dATE, O.OUT_CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, 
    O.OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.TOTAL_PARTICIPANTS, O.PRIVATE_REGISTRATION, O.TOTAL_DURATION, O.ONLINE_FLAG,
    O.FLOW_CODE, O.TEACHER, O.MOODLE_ID, O.SERVICE_ACTIVE_FLAG, O.ESTIMATED_TOTAL_COST, S.ESTIMATED_AMOUNT AS FINANCEDAMOUNT,
    S.DISBURSED_AMOUNT AS FINANCEDDISBURSEDAMOUNT
			from 
			    OUT_OUTPUT_VW O,
			    SOF_BY_OUT_VW s,
			    ACT_ACTIVITIES_VW a1,
			    ACT_ACTIVITIES_VW a2
			where s.OUT_ID = o.OUT_ID
			    and a2.activityID = o.KNA_ID
			    and S.KNA = a1.activityID
			    and a1.activityID <> a2.activityID
			    and a1.yea_year = 2013",
dbo,OUT_OUTPUTS_VW_2013,2013-07-25 13:03:50.203,2013-08-02 12:37:55.823,"CREATE VIEW [dbo].[OUT_OUTPUTS_VW_2013]
AS 
select O.KNA_ID, O.OUT_ID, O.NAME, O.OBJECTIVES, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.AUDIENCE, O.OPUS_CODE,
    O.OUT_CREATED_dATE, O.OUT_CREATOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, 
    O.OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.TOTAL_PARTICIPANTS, O.PRIVATE_REGISTRATION, O.TOTAL_DURATION, O.ONLINE_FLAG,
    O.FLOW_CODE, O.TEACHER, O.MOODLE_ID, O.SERVICE_ACTIVE_FLAG, O.ESTIMATED_TOTAL_COST, O.FINANCED_BY_ASSOCIATED_ACTIVITY, 
    O.FINANCED_BY_OTHER_KNAS, O.FINANCED_BY_OTHER_SOURCES, O.DISBURSED_AMOUNT, O.DISBURSED_SOF, O.PROGRAMMED_AMOUNT
			from OUT_OUTPUT_VW O,
			    ACT_ACTIVITIES_VW a
			where o.KNA_ID = a.activityID
			    and a.yea_year = 2013",
dbo,OUTPUTS_ASSOCIATED_WITH_OTHER_YEAR_KNA,2016-06-28 12:51:59.057,2016-06-28 12:51:59.057,"CREATE VIEW [dbo].[OUTPUTS_ASSOCIATED_WITH_OTHER_YEAR_KNA]
AS 
SELECT *
FROM OUT_OUTPUT_VW O , ACT_ACTIVITIES_VW A
WHERE YEAR(O.END_DATE) = year(getDate())
    AND O.KNA_ID = A.activityID
    AND A.yea_year <> YEAR(O.START_DATE)",
dbo,OUTPUTS_ASSOCIATED_WITH_OTHER_YEAR_KNA_2016,2017-01-05 15:23:52.440,2017-01-05 15:23:52.440,"CREATE VIEW OUTPUTS_ASSOCIATED_WITH_OTHER_YEAR_KNA_2016
AS 
SELECT *
FROM OUT_OUTPUT_VW O , ACT_ACTIVITIES_VW A
WHERE YEAR(O.END_DATE) = 2016
    AND O.KNA_ID = A.activityID
    AND A.yea_year <> YEAR(O.START_DATE)",
dbo,OUTPUTS_LOCATION_TDB,2016-06-28 12:49:53.207,2016-06-28 12:49:53.207,"CREATE VIEW [dbo].[OUTPUTS_LOCATION_TDB]
AS 
SELECT *
FROM OUT_OUTPUT_VW
WHERE YEAR(END_DATE) = year(getDate())
    AND (LOCATION_NAME LIKE '%TBD%' OR LOCATION_TYPE = 'LOC_PENDING')",
dbo,OUTPUTS_LOCATION_TDB_2016,2017-01-05 15:21:38.580,2017-01-05 15:21:38.580,"CREATE VIEW OUTPUTS_LOCATION_TDB_2016
AS 
SELECT *
FROM OUT_OUTPUT_VW
WHERE YEAR(END_DATE) = 2016
    AND (LOCATION_NAME LIKE '%TBD%' OR LOCATION_TYPE = 'LOC_PENDING')",
dbo,OUTPUTS_WITH_ESTIMATED_COST,2016-06-28 12:45:08.410,2016-06-28 12:45:08.410,"CREATE VIEW [dbo].[OUTPUTS_WITH_ESTIMATED_COST]
AS 

SELECT *
FROM OUT_OUTPUT_VW O 
WHERE YEAR(O.END_DATE) = year(getDate())
    AND O.ESTIMATED_TOTAL_COST > 0
    AND O.FINANCED_BY_ASSOCIATED_ACTIVITY + O.FINANCED_BY_OTHER_KNAS + O.FINANCED_BY_OTHER_SOURCES = 0",
dbo,OUTPUTS_WITH_ESTIMATED_COST_2016,2017-01-05 15:18:41.487,2017-01-05 15:18:41.487,"CREATE VIEW OUTPUTS_WITH_ESTIMATED_COST_2016
AS 
SELECT *
FROM OUT_OUTPUT_VW O 
WHERE YEAR(O.END_DATE) = 2016
    AND O.ESTIMATED_TOTAL_COST > 0
    AND O.FINANCED_BY_ASSOCIATED_ACTIVITY + O.FINANCED_BY_OTHER_KNAS + O.FINANCED_BY_OTHER_SOURCES = 0",
dbo,OUTPUTS_WITHOUT_KNA,2016-06-28 12:42:16.597,2016-06-28 12:42:16.597,"CREATE VIEW [dbo].[OUTPUTS_WITHOUT_KNA]
AS 

SELECT *
FROM OUT_OUTPUT_VW
WHERE YEAR(END_DATE) = year(getDate())
    AND KNA_ID IS NULL",
dbo,OUTPUTS_WITHOUT_KNA_2016,2017-01-05 15:14:54.500,2017-01-05 15:14:54.500,"create VIEW OUTPUTS_WITHOUT_KNA_2016
AS 
SELECT *
FROM OUT_OUTPUT_VW
WHERE YEAR(END_DATE) = 2016
    AND KNA_ID IS NULL",
dbo,OUTPUTS_ZERO_PARTICIPANTS_HOURS,2016-06-28 12:48:30.133,2016-06-28 12:48:30.133,"CREATE VIEW [dbo].[OUTPUTS_ZERO_PARTICIPANTS_HOURS]
AS 

SELECT *
FROM OUT_OUTPUT_VW
WHERE YEAR(END_DATE) = year(getDate())
    AND (TOTAL_DURATION * TOTAL_PARTICIPANTS) = 0",
dbo,OUTPUTS_ZERO_PARTICIPANTS_HOURS_2016,2017-01-05 15:20:05.513,2017-01-05 15:20:05.513,"CREATE VIEW OUTPUTS_ZERO_PARTICIPANTS_HOURS_2016
AS 
SELECT *
FROM OUT_OUTPUT_VW
WHERE YEAR(END_DATE) = 2016
    AND (TOTAL_DURATION * TOTAL_PARTICIPANTS) = 0",
dbo,POU_PUBLISHED_OUTPUTS_VW,2015-04-01 18:16:40.833,2015-04-01 18:16:40.833,"CREATE VIEW [dbo].[POU_PUBLISHED_OUTPUTS_VW]
AS 
select OUT_ID, NAME, OBJECTIVES, COMMENTS, MODALITY, PRESENTATION_TYPE, OPUS_CODE, OUT_CREATED_DATE, OUT_CREATOR, PUBLISHED_DATE, OUT_TYPE, LOCATION_NAME, LOCATION_TYPE
    LOCATION_CITY, OUT_STATUS_CODE, BUDGET_STATUS_CODE, BUDGET_OFFICER_CLOSED_DATE, CLOSER, LOGISTICS_FLAG, START_DATE, END_DATE, DEADLINE, MAX_PARTICIPANTS, REGISTRATION_COFINANCING,
    REGISTRATION_FEE, PRIVATE_REGISTRATION, TOTAL_DURATION, ONLINE_FLAG, FLOW_CODE, TEACHER, MOODLE_ID, SERVICE_ACTIVE_FLAG, ESTIMATED_TOTAL_COST, TOTAL_PARTICIPANTS, KNA_ID, AUDIENCE,
    OPUS_NAME, OUT_TOPICS , (select d.dep_name from Dep_Department_tb d where d.dep_id = dbo.getDepartmentIDByOutputID(OUT_ID)) as OUT_DEPT, dbo.getTargetDepartmentsByOutput(OUT_ID) as OUT_DEPARTMENTS
    
from OUT_OUTPUT_VW
where PUBLISHED_DATE < getDate()
    and DEADLINE > getDate()
    and OUT_TYPE IN ('GENERAL EVENT','LANGUAGE GROUP EVENT','MOODLE EVENT')
UNION ALL
select OUT_ID, NAME, OBJECTIVES, COMMENTS, MODALITY, PRESENTATION_TYPE, OPUS_CODE, OUT_CREATED_DATE, OUT_CREATOR, PUBLISHED_DATE, OUT_TYPE, LOCATION_NAME, LOCATION_TYPE
    LOCATION_CITY, OUT_STATUS_CODE, BUDGET_STATUS_CODE, BUDGET_OFFICER_CLOSED_DATE, CLOSER, LOGISTICS_FLAG, START_DATE, END_DATE, DEADLINE, MAX_PARTICIPANTS, REGISTRATION_COFINANCING,
    REGISTRATION_FEE, PRIVATE_REGISTRATION, TOTAL_DURATION, ONLINE_FLAG, FLOW_CODE, TEACHER, MOODLE_ID, SERVICE_ACTIVE_FLAG, ESTIMATED_TOTAL_COST, TOTAL_PARTICIPANTS, KNA_ID, AUDIENCE,
    OPUS_NAME, OUT_TOPICS , 
    (select d.dep_name from Dep_Department_tb d where d.dep_id = dbo.getDepartmentIDByOutputID(OUT_ID)) as OUT_DEPT, dbo.getTargetDepartmentsByOutput(OUT_ID) as OUT_DEPARTMENTS
from OUT_OUTPUT_VW
where PUBLISHED_DATE < getDate()
    and SERVICE_ACTIVE_FLAG = 1
    and OUT_TYPE IN ('SELF-LEARNING','MOODLE SELF-LEARNING','LANGUAGE SERVICE','Collaborative Learning')",
dbo,REG_GUEST_VW,2011-04-20 09:13:52.087,2014-11-18 10:01:51.177,"CREATE VIEW [dbo].[REG_GUEST_VW]
AS 
select reg.out_id_outcome AS OUT_ID,
    REG.reg_id AS REG_ID,
    -- PERSON
    PER.per_first_name AS FIRST_NAME,
    PER.per_middle_name AS MIDDLE_NAME,
    PER.per_last_name AS LAST_NAME,
    PER.per_email AS EMAIL,
    PER.per_gender AS GENDER,
    gst.gst_title AS TITLE,
    isnull((SELECT ins.ins_name FROM Ins_Institution_tb ins where ins.ins_id = gst.ins_id_instituion),'') AS INSTITUTION,
    isnull((select t.tal_description from Ins_Institution_tb i, Tal_Taxonomy_Language_tb t where i.ins_id = 5069 and i.tax_id_type =t.tax_id    and t.lng_id = 1),'') as INSTITUTION_TYPE,
    isnull((SELECT ctr.ctr_name FROM Ctr_Country_tb ctr where ctr.ctr_id = gst.ctr_id_country),'') AS COUNTRY,
    -- REGISTRATION
    REG.reg_created_date AS CREATED_DATE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = REG.per_id_registrator) AS REGISTRATOR,
    REG.reg_cofinancing AS COFINANCING_AMOUNT,
    REG.reg_fee AS FEE_AMOUNT,
    REG.reg_showup_flag AS SHOWUP_FLAG,
    REG.reg_deleted_date AS DELETED_DATE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = REG.per_id_deletor) AS DELETOR,
    REG.reg_participation_type AS PARTICIPATION_TYPE,
    CASE WHEN (REG.reg_type = 'REG_REGISTRATION_USER' OR REG.reg_type = 'REG_SERVICE_INDIVIDUAL_LANGUAGE') THEN 'EMPLOYEE' WHEN REG.reg_type = 'REG_GUEST' THEN 'GUEST' ELSE 'UNKNOWN' END AS REG_TYPE,
    REG.reg_flow_status_code AS STATUS_CODE
from Reg_Registration_tb reg,
    Rgt_Registration_Guest_tb rgt,
    Gst_Guest_tb gst,
    Per_Person_tb per
where reg.reg_id = rgt.reg_id
    and rgt.per_id = per.per_id
    and gst.per_id = per.per_id
    and reg.reg_type = 'REG_GUEST'",
dbo,REG_LANGUAGE_USER_VW,2011-04-20 09:11:39.347,2013-06-10 16:32:06.597,"CREATE VIEW [dbo].[REG_LANGUAGE_USER_VW]
AS 
select reg.out_id_outcome AS OUT_ID,
    REG.reg_id AS REG_ID,
    -- PERSON
    PER.per_first_name AS FIRST_NAME,
    PER.per_middle_name AS MIDDLE_NAME,
    PER.per_last_name AS LAST_NAME,
    PER.per_email AS EMAIL,
    PER.per_gender AS GENDER,
    -- USER
    USR.USR_PCMAIL AS PCMAIL,
    USR.usr_employee_id AS EMPLOYEE_ID,
    USR.usr_left_date AS LEFT_DATE,
    CASE WHEN USR.usr_type = 'STF' THEN 'STAFF' ELSE 'OTHER' END AS EMPLOYEE_TYPE,
    CASE WHEN USR.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END AS WORK_LOCATION,
    CASE WHEN USR.usr_work_location = 'HQ' THEN 'USA' ELSE USR.USR_WORK_LOCATION END AS WORK_COUNTRY,
    USR.usr_title AS TITLE,
    USR.usr_career_track as CAREER_TRACK,
    USR.usr_career_path as CAREER_PATH,
    USR.usr_work_role as WORK_ROLE,
    USR.usr_payment_type AS PAYMENT_TYPE,
    USR.usr_grade AS GRADE,
    USR.usr_contract_type AS CONTRACT_TYPE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = USR.per_id_supervisor) AS SUPERVISOR,
    -- UNIT
    UNT.unt_name AS UNIT,
    UNT.unt_id AS UNIT_ID,
    -- DEPARTMENT
    DEP.dep_name AS DEPARTMENT,
    DEP.dep_id AS DEPT_ID,
    -- REGISTRATION
    REG.reg_created_date AS CREATED_DATE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = REG.per_id_registrator) AS REGISTRATOR,
    REG.reg_cofinancing AS COFINANCING_AMOUNT,
    REG.reg_fee AS FEE_AMOUNT,
    REG.reg_showup_flag AS SHOWUP_FLAG,
    REG.reg_deleted_date AS DELETED_DATE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = REG.per_id_deletor) AS DELETOR,
    REG.reg_participation_type AS PARTICIPATION_TYPE,
    CASE WHEN (REG.reg_type = 'REG_REGISTRATION_USER' OR REG.reg_type = 'REG_SERVICE_INDIVIDUAL_LANGUAGE') THEN 'EMPLOYEE' WHEN REG.reg_type = 'REG_GUEST' THEN 'GUEST' ELSE 'UNKNOWN' END AS REG_TYPE,
    REG.reg_flow_status_code AS STATUS_CODE,
    -- INDIVIDUAL LANGUAGE
    rsl.rsl_duration AS DURATION
from Reg_Registration_tb reg,
    Rsl_Service_Individual_Language_tb rsl,
    Usr_User_tb usr,
    Per_Person_tb per,
    Unt_Unit_tb unt,
    Dep_Department_tb dep
where reg.reg_id = rsl.reg_id
    and rsl.usr_id_user = usr.usr_id
    and usr.unt_id_unit = unt.unt_id
    and usr.per_id_person = per.per_id
    and unt.dep_id_department = dep.dep_id
    and reg.reg_type = 'REG_SERVICE_INDIVIDUAL_LANGUAGE'",
dbo,REG_REGISTRATION_USER_VW,2011-04-20 09:07:32.233,2016-02-16 13:21:31.540,"CREATE VIEW [dbo].[REG_REGISTRATION_USER_VW]
AS 
select reg.out_id_outcome AS OUT_ID,
    REG.reg_id AS REG_ID,
    -- PERSON
    PER.per_first_name AS FIRST_NAME,
    PER.per_middle_name AS MIDDLE_NAME,
    PER.per_last_name AS LAST_NAME,
    PER.per_email AS EMAIL,
    PER.per_gender AS GENDER,
    -- USER
    USR.USR_ID AS USER_ID,
    USR.USR_PCMAIL AS PCMAIL,
    USR.usr_employee_id AS EMPLOYEE_ID,
    USR.usr_left_date AS LEFT_DATE,
    CASE WHEN USR.usr_type = 'STF' THEN 'STAFF' ELSE 'OTHER' END AS EMPLOYEE_TYPE,
    CASE WHEN USR.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END AS WORK_LOCATION,
    CASE WHEN USR.usr_work_location = 'HQ' THEN 'USA' ELSE USR.USR_WORK_LOCATION END AS WORK_COUNTRY,
    USR.usr_title AS TITLE,
    USR.USR_CAREER_TRACK AS CAREER_TRACK,
    USR.usr_career_path as CAREER_PATH,
    USR.usr_work_role as WORK_ROLE,
    USR.usr_payment_type AS PAYMENT_TYPE,
    USR.usr_grade AS GRADE,
    USR.usr_contract_type AS CONTRACT_TYPE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = USR.per_id_supervisor) AS SUPERVISOR,
    -- UNIT
    UNT.unt_name AS UNIT,
    UNT.unt_id AS UNIT_ID,
    -- DEPARTMENT
    DEP.dep_name AS DEPARTMENT,
    DEP.dep_id as DEPT_ID,
    -- REGISTRATION
    REG.reg_created_date AS CREATED_DATE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = REG.per_id_registrator) AS REGISTRATOR,
    REG.reg_cofinancing AS COFINANCING_AMOUNT,
    REG.reg_fee AS FEE_AMOUNT,
    REG.reg_showup_flag AS SHOWUP_FLAG,
    REG.reg_deleted_date AS DELETED_DATE,
    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P WHERE P.per_id = REG.per_id_deletor) AS DELETOR,
    REG.reg_participation_type AS PARTICIPATION_TYPE,
    CASE WHEN (REG.reg_type = 'REG_REGISTRATION_USER' OR REG.reg_type = 'REG_SERVICE_INDIVIDUAL_LANGUAGE') THEN 'EMPLOYEE' WHEN REG.reg_type = 'REG_GUEST' THEN 'GUEST' ELSE 'UNKNOWN' END AS REG_TYPE,
    REG.reg_flow_status_code AS STATUS_CODE    
from Reg_Registration_tb reg,
    Reu_Registration_User_tb reu,
    Usr_User_tb usr,
    Per_Person_tb per,
    Unt_Unit_tb unt,
    Dep_Department_tb dep
where reg.reg_id = reu.reg_id
    and reu.usr_id = usr.usr_id
    and usr.unt_id_unit = unt.unt_id
    and usr.per_id_person = per.per_id
    and unt.dep_id_department = dep.dep_id
    and reg.reg_type = 'REG_REGISTRATION_USER'",
dbo,REG_REGISTRATIONS_VW,2015-12-04 18:09:12.570,2015-12-05 04:37:26.137,"CREATE VIEW [dbo].[REG_REGISTRATIONS_VW]
AS 
select 
    r.reg_id,
    r.out_id_outcome as out_id,
    per.per_first_name as emp_first_name,
    per.per_last_name as emp_last_name, 
    per.per_middle_name as emp_middle_name,
    usr.usr_title as emp_title,
    CASE WHEN usr.usr_type = 'STF' THEN 'STAFF' ELSE 'CWF' END AS emp_type,
    per.per_gender as emp_gender,
    per.per_email as emp_email,
    (
        case when usr.usr_career_track in ('Technical','Professional') then 'Technical'
             when usr.usr_career_track in ('Administrative','Support') then 'Support'
             when usr.usr_type <> 'STF' then 'CWF'
             else usr.usr_career_track
        end
    )as emp_career_track,
    usr.usr_career_path as emp_career_path,
    usr.usr_work_role as emp_work_role,
    CASE WHEN usr.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END AS emp_work_location,
    CASE WHEN usr.usr_work_location = 'HQ' THEN 'USA' ELSE usr.USR_WORK_LOCATION END AS emp_work_country,
    unt.unt_name as emp_unit,
    dep.dep_name as emp_department,
    sec.sec_name as emp_section,
    (select count(*) from Usr_User_tb usr2 where usr2.usr_pcmail = usr.usr_pcmail and usr2.usr_active_flag = 1 ) as emp_active_flag,
    'EMPLOYEE' as reg_type,
    NULL AS guest_institution,
    NULL AS guest_institution_type,
    NULL AS guest_country,
    r.reg_created_date AS reg_created_date,
    month(r.reg_created_date) AS reg_month
from Reg_Registration_tb r,
    Rsl_Service_Individual_Language_tb rsl,
    Usr_User_tb usr,
    Per_Person_tb per,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec
where r.reg_id = rsl.reg_id
    and unt.unt_id = usr.unt_id_unit
    and sec.sec_id = dep.sec_id_section
    and dep.dep_id = unt.dep_id_department
    and usr.usr_id = rsl.usr_id_user
    and usr.per_id_person = per.per_id   
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
union all
select
    r.reg_id,
    r.out_id_outcome as out_id,
    per.per_first_name as emp_first_name,
    per.per_last_name as emp_last_name, 
    per.per_middle_name as emp_middle_name,
    usr.usr_title as emp_title,
    CASE WHEN usr.usr_type = 'STF' THEN 'STAFF' ELSE 'CWF' END AS emp_type,
    per.per_gender as emp_gender,
    per.per_email as emp_email,
    (
        case when usr.usr_career_track in ('Technical','Professional') then 'Technical'
             when usr.usr_career_track in ('Administrative','Support') then 'Support'
             when usr.usr_type <> 'STF' then 'CWF'
             else usr.usr_career_track
        end
    )as emp_career_track,
    usr.usr_career_path as emp_career_path,
    usr.usr_work_role as emp_work_role,
    CASE WHEN usr.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END AS emp_work_location,
    CASE WHEN usr.usr_work_location = 'HQ' THEN 'USA' ELSE usr.USR_WORK_LOCATION END AS emp_work_country,
    unt.unt_name as emp_unit,
    dep.dep_name as emp_department,
    sec.sec_name as emp_section,
    (select count(*) from Usr_User_tb usr2 where usr2.usr_pcmail = usr.usr_pcmail and usr2.usr_active_flag = 1 ) as emp_active_flag,
    'EMPLOYEE' as reg_type,
    NULL AS guest_institution,
    NULL AS guest_institution_type,
    NULL AS guest_country,
    r.reg_created_date,
    month(r.reg_created_date) AS reg_month
from Reg_Registration_tb r,
    Reu_Registration_User_tb reu,
    Usr_User_tb usr,
    Per_Person_tb per,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec
where r.reg_id = reu.reg_id
    and unt.unt_id = usr.unt_id_unit
    and sec.sec_id = dep.sec_id_section
    and dep.dep_id = unt.dep_id_department
    and usr.usr_id = reu.usr_id
    and usr.per_id_person = per.per_id
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
UNION ALL
SELECT 
    reg.reg_id,
    reg.out_id_outcome as out_id,
    per.per_first_name as emp_first_name,
    per.per_last_name as emp_last_name, 
    per.per_middle_name as emp_middle_name,
    gst.gst_title as emp_title,
    'GUEST' AS emp_type,
    per.per_gender as emp_gender,
    per.per_email as emp_email,
    NULL as emp_career_track,
    NULL as emp_career_path,
    NULL as emp_work_role,
    NULL AS emp_work_location,
    NULL AS emp_work_country,
    NULL as emp_unit,
    NULL as emp_department,
    NULL as emp_section,
    1 as emp_active_flag,
    'GUEST' as reg_type,
    isnull((SELECT ins.ins_name FROM Ins_Institution_tb ins where ins.ins_id = gst.ins_id_instituion),'') AS guest_institution,
    isnull((select t.tal_description from Ins_Institution_tb i, Tal_Taxonomy_Language_tb t where i.ins_id = 5069 and i.tax_id_type =t.tax_id    and t.lng_id = 1),'') AS guest_institution_type,
    isnull((SELECT ctr.ctr_name FROM Ctr_Country_tb ctr where ctr.ctr_id = gst.ctr_id_country),'') AS guest_country,
    reg.reg_created_date  AS reg_created_date,
    month(reg.reg_created_date) AS reg_month
from Reg_Registration_tb reg,
    Rgt_Registration_Guest_tb rgt,
    Gst_Guest_tb gst,
    Per_Person_tb per
where reg.reg_id = rgt.reg_id
    and rgt.per_id = per.per_id
    and gst.per_id = per.per_id
    and reg.reg_type = 'REG_GUEST'",
dbo,reportEmployees_1_2014_2016_vw,2017-02-16 15:24:01.320,2017-02-16 15:24:01.320,"CREATE VIEW [dbo].[reportEmployees_1_2014_2016_vw]
AS 

select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType, iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode, opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    evt.evt_start_date as eventStartDate, evt.evt_end_date as eventEndDate, year(evt.evt_end_date) as eventYear,
    evt.evt_total_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Evt_Event_tb evt,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb OPS,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Reu_Registration_User_tb reu,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
       -- and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = evt.out_id
    and aao.kna_id_activity = kna.kna_id   
    and o.ops_id_opus = ops.ops_id
    and kna.kpd_id_deliverable = kpd.kpd_id
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and reu.reg_id = r.reg_id
    and reu.usr_id = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0   
    and year(evt.evt_end_date) between 2014 and 2016
UNION ALL
select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType,iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode,  opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    srv.srv_start_date as eventStartDate, srv.srv_end_date as eventEndDate,year(srv.srv_end_date) as eventYear,
    srv.srv_total_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Srv_Service_tb srv,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb ops,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Reu_Registration_User_tb reu,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
      --  and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = srv.out_id
    and aao.kna_id_activity = kna.kna_id   
    and kna.kpd_id_deliverable = kpd.kpd_id
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and o.ops_id_opus = ops.ops_id
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and reu.reg_id = r.reg_id
    and reu.usr_id = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1   
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0
    and year(srv.srv_end_date) between 2014 and 2016  
UNION ALL
select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType, iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode,  opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    srv.srv_start_date as eventStartDate, srv.srv_end_date as eventEndDate,year(srv.srv_end_date) as eventYear,
    rsl.rsl_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Srv_Service_tb srv,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb ops,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Rsl_Service_Individual_Language_tb rsl,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
     --   and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = srv.out_id
    and aao.kna_id_activity = kna.kna_id   
    and kna.kpd_id_deliverable = kpd.kpd_id
    and ops.ops_id = o.ops_id_opus
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and rsl.reg_id = r.reg_id
    and rsl.usr_id_user = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0  
    and year(srv.srv_end_date) between 2014 and 2016
UNION ALL
select depUser.dep_name as oldUserDept, untUser.unt_name as oldUserUnit, 
    usr.usr_type as oldUserType, usr.usr_title as oldUserTitle, 
    per.per_first_name as employeeFirstName, per.per_last_name as employeeLastName, per.per_email as employeeEmail,
    usr.usr_work_location as oldUserLocation, usr.usr_career_track as oldUserCareerTrack, usr.usr_career_path as oldUserCareerPath, usr.usr_work_role as oldUserWorkrole, 
    usr.usr_contract_type as oldUserContractType, iicUser.iicnewContractType as newUserContractType, iicUser.iicUnit as newUserUnit, iicUser.iicDep as newUserDept, iicUser.iicTitle as newUserTitle, iicUser.currentLocation,
    iicUser.currentCareerPath, iicUser.currentCareerTrack, iicUser.currentWorkRole,
    r.reg_id as regId, o.out_id as outId, o.out_objectives as eventObjectives, ops.ops_activity_code as eventOPUSCode,  opl.opl_description as eventOPUSCodeName,
    (select tal.tal_description from KNLSYSTEM_DB.dbo.Tal_Taxonomy_Language_tb tal where tal.tax_id = o.tax_id_presentation_type and tal.lng_id = 1) as eventPresentationType,
    ext.ext_start_date as eventStartDate, ext.ext_end_date as eventEndDate, year(ext.ext_end_date) as eventYear,
    ext.ext_duration as eventDuration, 
    o.out_name as outName, dep.dep_name as organizerDeptName, unt.unt_name organizerUnit,
    KNLSYSTEM_DB.dbo.getFacilitatorsCompleteInformationByOutputIdAndRole(o.out_id) AS FACILITATORS
from KNLSYSTEM_DB.dbo.Out_Outcome_tb o,
    KNLSYSTEM_DB.dbo.Ext_External_Event_tb ext,
    KNLSYSTEM_DB.dbo.Reg_Registration_tb r,
    KNLSYSTEM_DB.dbo.Aao_Available_Activity_Outcome_tb aao,
    KNLSYSTEM_DB.dbo.Kna_Knl_Plan_Activity_tb kna,
    KNLSYSTEM_DB.dbo.Kpd_Knl_Plan_Deliverable_tb kpd,
    KNLSYSTEM_DB.dbo.Knd_Knl_Plan_Division_tb knd,
    KNLSYSTEM_DB.dbo.Knp_Knl_Plan_Department_tb knp,
    KNLSYSTEM_DB.dbo.Dep_Department_tb dep,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
    KNLSYSTEM_DB.dbo.Ops_Opus_tb OPS,
    KNLSYSTEM_DB.dbo.Opl_Opus_Language_tb opl,
    KNLSYSTEM_DB.dbo.Reu_Registration_User_tb reu,
    KNLSYSTEM_DB.dbo.Usr_User_tb usr,
    KNLSYSTEM_DB.dbo.Per_Person_tb per,
    KNLSYSTEM_DB.dbo.Unt_Unit_tb untUser,
    KNLSYSTEM_DB.dbo.Dep_Department_tb depUser,
    (select usr.usr_pcmail as iicPcmail, usr.usr_contract_type as iicnewContractType, unt.unt_name as iicUnit, dep.dep_name as iicDep, usr.usr_title as iicTitle, usr.usr_work_location as currentLocation,
        usr.usr_career_path as currentCareerPath, usr.usr_career_track as currentCareerTrack, usr.usr_work_role as currentWorkRole
    from KNLSYSTEM_DB.dbo.Usr_User_tb usr,
        KNLSYSTEM_DB.dbo.Unt_Unit_tb unt,
        KNLSYSTEM_DB.dbo.Dep_Department_tb dep
    where usr.unt_id_unit = unt.unt_id
        and unt.dep_id_department = dep.dep_id
     --   and dep.sec_id_section = 8
        and usr.usr_active_flag = 1) as iicUser
where o.out_id = r.out_id_outcome
    and o.out_id = aao.out_id_outcome
    and o.out_id = ext.out_id
    and aao.kna_id_activity = kna.kna_id   
    and o.ops_id_opus = ops.ops_id
    and kna.kpd_id_deliverable = kpd.kpd_id
    and per.per_id = usr.per_id_person
    and kpd.knd_id_division = knd.knd_id
    and knd.knp_id_plan_department = knp.knp_id
    and knp.dep_id_department = dep.dep_id
    and knd.unt_id_unit = unt.unt_id
    and reu.reg_id = r.reg_id
    and reu.usr_id = usr.usr_id
    and usr.unt_id_unit = untUser.unt_id
    and untUser.dep_id_department = depUser.dep_id
    and usr.usr_pcmail = iicUser.iicPcmail
    and opl.ops_id = ops.ops_id
    and opl.lng_id = 1
    and r.reg_deleted_flag = 0
    and r.reg_showup_flag = 1   
   -- and depUser.dep_name in ('INE','SCL','IFD','CSD','KNL','INT','RES','ESG', 'VPS')--,'ICF'
    and r.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'
    and o.out_deleted_flag = 0
    and year(ext.ext_end_date) between 2014 and 2016",
dbo,RET_REGISTRATION_FLAT_TABLE_VW,2013-09-05 16:05:34.087,2016-02-12 13:43:25.450,"CREATE VIEW [dbo].[RET_REGISTRATION_FLAT_TABLE_VW]
AS 
SELECT
	reg.REG_ID as REG_ID,
	reg.LAST_NAME+', '+ reg.FIRST_NAME + ' ' + reg.MIDDLE_NAME as PAR_NAME,
    reg.EMAIL as PAR_EMAIL_ID,
    reg.EMPLOYEE_ID as REG_EMP_ID,
	reg.EMPLOYEE_TYPE as REG_EMP_TYPE,
    reg.WORK_LOCATION AS REG_EMP_WORK_LOCATION,
	reg.UNIT as REG_EMP_UNIT,
	reg.DEPARTMENT as REG_EMP_DEPT,
    sec.sec_name as REG_EMP_VP,
	OUT.OUT_ID as OUT_ID,
	OUT.NAME as OUT_NAME,
    OUT.OPUS_CODE as OUT_OPUS_CODE,
	OUT.START_DATE as OUT_START_DATE,
    CASE
        WHEN out.LOCATION_TYPE = 'LOC_BANK_FACILITY'
        THEN 'HQ'
        WHEN out.LOCATION_TYPE = 'LOC_EXTERNAL_FACILITY'
        THEN 'COF'
        WHEN out.LOCATION_TYPE = 'LOC_URL'
        THEN 'VIRTUAL'
    END as OUT_LOCATION_TYPE,
    MONTH(OUT.START_DATE) as OUT_START_DATE_MONTH,
    YEAR(OUT.START_DATE) as OUT_START_DATE_YEAR,
	OUT.END_DATE as OUT_END_DATE,
    MONTH(OUT.END_DATE) as OUT_END_DATE_MONTH,
    YEAR(OUT.END_DATE) as OUT_END_DATE_YEAR,
	OUT.TOTAL_DURATION as OUT_DURATION,
	CASE 
		WHEN OUT.OPUS_CODE IN ('BK-C1011','BK-C1117','BK-C1015') 
		THEN 'Core Competencies' 
		ELSE 'Technical Competencies'
	END AS OUT_CONTENT_MATTER  
FROM
	OUT_OUTPUT_VW OUT,
	REG_REGISTRATION_USER_VW reg,
	Dep_Department_tb dep,
    Sec_Section_tb sec
WHERE
	OUT.OUT_ID = reg.OUT_ID AND
	reg.dept_id = dep.dep_id AND
    dep.sec_id_section = sec.sec_id AND 
    reg.DELETED_DATE IS NULL
UNION ALL
SELECT
	reg.REG_ID as REG_ID,
	reg.LAST_NAME+', '+ reg.FIRST_NAME + ' ' + reg.MIDDLE_NAME as PAR_NAME,
    reg.EMAIL as PAR_EMAIL_ID,
    reg.EMPLOYEE_ID as REG_EMP_ID,
	reg.EMPLOYEE_TYPE as REG_EMP_TYPE,
    reg.WORK_LOCATION AS REG_EMP_WORK_LOCATION,
	reg.UNIT as REG_EMP_UNIT,
	reg.DEPARTMENT as REG_EMP_DEPT,
    sec.sec_name as REG_EMP_VP,
	OUT.OUT_ID as OUT_ID,
	OUT.NAME as OUT_NAME,
    OUT.OPUS_CODE as OUT_OPUS_CODE,
	OUT.START_DATE as OUT_START_DATE,
    CASE
        WHEN out.LOCATION_TYPE = 'LOC_BANK_FACILITY'
        THEN 'HQ'
        WHEN out.LOCATION_TYPE = 'LOC_EXTERNAL_FACILITY'
        THEN 'COF'
        WHEN out.LOCATION_TYPE = 'LOC_URL'
        THEN 'VIRTUAL'
    END as OUT_LOCATION_TYPE,
    MONTH(OUT.START_DATE) as OUT_START_DATE_MONTH,
    YEAR(OUT.START_DATE) as OUT_START_DATE_YEAR,
	OUT.END_DATE as OUT_END_DATE,
    MONTH(OUT.END_DATE) as OUT_END_DATE_MONTH,
    YEAR(OUT.END_DATE) as OUT_END_DATE_YEAR,
	OUT.TOTAL_DURATION as OUT_DURATION,
	CASE 
		WHEN OUT.OPUS_CODE IN ('BK-C1011','BK-C1117','BK-C1015') 
		THEN 'Core Competencies' 
		ELSE 'Technical Competencies'
	END AS OUT_CONTENT_MATTER  
FROM
	OUT_OUTPUT_VW OUT,
	REG_LANGUAGE_USER_VW reg,
	Dep_Department_tb dep,
    Sec_Section_tb sec
WHERE
	OUT.OUT_ID = reg.OUT_ID AND
	reg.dept_id = dep.dep_id AND
    dep.sec_id_section = sec.sec_id AND 
	reg.DELETED_DATE IS NULL",
dbo,REU_ALL_EMPLOYEE_REGISTRATIONS,2017-04-24 14:53:38.620,2017-11-28 11:10:41.307,"CREATE VIEW [dbo].[REU_ALL_EMPLOYEE_REGISTRATIONS]
AS 
SELECT
	REG.REG_ID                                                     AS registrationID,
    USR.USR_PCMAIL                                                 AS PCMAIL,
    REG.reg_created_date                                           AS createdDate,
    REG.OUT_ID_OUTCOME                                             AS outputID,
    OUT1.OUT_NAME                                                  AS outputName,
    YEAR(REG.REG_CREATED_DATE)                                     AS 'year',
    DBO.KNLPORTALSERVICES_GETSTARTDATEBYOUTID(REG.OUT_ID_OUTCOME)  AS eventStartDate,
	DBO.KNLPORTALSERVICES_GETENDDATEBYOUTID(REG.OUT_ID_OUTCOME)    AS eventEndDate,
    DBO.KNLPORTALSERVICES_GETOUTTYPEBYOUTPUTID(REG.OUT_ID_OUTCOME) AS outputType,
    dbo.knlPortalServices_getModalityByOutId(reg.out_id_outcome)   AS modality,
    REG.REG_PARTICIPATION_TYPE                                     AS PARTICIPATIONTYPE,
    DBO.knlPortalServices_getPersonNameByPerId(per.per_id)         AS name,
    DBO.KNLPORTALSERVICES_GETDURATIONBYOUTID(REG.OUT_ID_OUTCOME)   AS DURATION,
    dbo.knlPortalServices_IntegerToBoolean(reg.reg_showup_flag)    AS SHOWUPFLAG,
    usr.usr_employee_id                                            AS employeeNumber,
    per.per_email                                                  AS employeeEmail,
    dbo.knlPortalServices_getUnitNameByUntId(usr.unt_id_unit)      AS employeeUnit,
    dbo.knlPortalServices_getSrvTypeByOutId(reg.out_id_outcome)    AS serviceType,
    dbo.knlPortalServices_getEvtTypeByOutId(reg.out_id_outcome)    AS eventType
    
FROM
	REU_REGISTRATION_USER_TB REU,
	REG_REGISTRATION_TB REG ,
	USR_USER_TB USR,
	PER_PERSON_TB PER,
    Out_Outcome_tb OUT1
WHERE
	REU.REG_ID = REG.REG_ID AND
    REG.out_id_outcome  = OUT1.OUT_ID AND
	REU.USR_ID = USR.USR_ID AND
	USR.PER_ID_PERSON = PER.PER_ID AND
	REG.REG_DELETED_FLAG=0 and reg.reg_deleted_date is null",
dbo,SOF_BY_OUT_VW,2012-07-03 12:33:36.673,2014-08-28 10:22:49.703,"CREATE VIEW [dbo].[SOF_BY_OUT_VW]
AS 
select a.*, sof.sof_amount as ESTIMATED_AMOUNT, sof.sof_executed_amount as DISBURSED_AMOUNT , sof.sof_type, sat.kna_id_knl_administrative_plan as KNA, adc.adc_code as ADMIN_ACCT, bou.bou_name as BUDG_ORG_UNIT, ops.ops_activity_code as OPUS_CODE, sof.sof_comments 
from
(
select  out.OUT_ID,  out.START_DATE,  out.END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_EXTERNAL_EVENT_VW out
UNION
select  out.OUT_ID,  out.START_DATE,  out.END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_GENERAL_EVENT_VW out
UNION
select  out.OUT_ID,  out.START_DATE AS START_DATE,  out.END_DATE AS END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_GENERAL_SERVICE_VW out
UNION
select  out.OUT_ID,  '' AS START_DATE,  '' AS END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_KNOWLEDGE_PRODUCT_VW out
UNION
select  out.OUT_ID,  out.START_DATE,  out.END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_LANGUAGE_GROUP_EVENT_VW out
UNION
select  out.OUT_ID,  out.START_DATE,  out.END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_LANGUAGE_SERVICE_VW out
UNION
select  out.OUT_ID,  out.START_DATE,  out.END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_MOODLE_EVENT_VW out
UNION
select  out.OUT_ID,  out.START_DATE AS START_DATE,  out.END_DATE AS END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_MOODLE_SERVICE_VW out
UNION
select  out.OUT_ID,  out.START_DATE AS START_DATE,  out.END_DATE AS END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_COLLABORATIVE_LEARNING_VW out
UNION
select  out.OUT_ID,  '' AS START_DATE,  '' AS END_DATE,  out.BUDGET_STATUS_CODE, out.BUDGET_OFFICER_CLOSED_DATE from OUT_FHL_PRODUCT_VW out
) a 
left join Sof_Source_Of_Funding_tb sof on a.out_id=sof.out_id_outcome
left join Sac_Source_Of_Funding_Account_tb sac on sof.sof_id=sac.sof_id
left join Sat_Source_Of_Funding_Activity_tb sat on sof.sof_id=sat.sof_id
left join Adc_Administrative_Account_tb adc on sac.adc_id_administrative_account=adc.adc_id
left join Bou_Budget_Org_Unit_tb bou on sac.bou_id_budget_org_unit=bou.bou_id
left join Ops_Opus_tb ops on sac.ops_id_opus=ops.ops_id
where sof_deleted_flag=0",
dbo,SUC_SUPER_UNIT_COORDINATOR_VW,2015-08-18 10:42:27.437,2015-08-18 14:22:18.170,"CREATE VIEW [dbo].[SUC_SUPER_UNIT_COORDINATOR_VW]
AS 
SELECT sec.sec_name, dep.dep_name, unt.unt_name, uap.unt_id, unt.unt_active_date,
    uap.contactName, uap.contactUserName, uap.contactUnit, uap.contactType
FROM Dep_Department_tb dep,
    Sec_Section_tb sec,
    Unt_Unit_tb unt left outer join 
        (select unt.unt_id,
            per.per_first_name + ' '+ isNull(per.per_middle_name,'') + ' ' + per.per_last_name as contactName, 
            usr.usr_pcmail as contactUserName, usr.usr_title as contactTitle, unt2.unt_name as contactUnit, 
            case when uap.uap_person_type = 0 then 'No Contact (Only KnlSystem Access)'
                 when uap.uap_person_type = 1 then 'Business Partner Senior'
                 when uap.uap_person_type = 2 then 'Business Partner Junior'
                 when uap.uap_person_type = 3 then 'Coordinator Contact 1'
                 when uap.uap_person_type = 4 then 'Coordinator Contact 2'
                 when uap.uap_person_type = 5 then 'Coordinator Contact (For more than two coordinators)'
            end as contactType
        from Uap_Unit_Assigned_Person_tb uap,
            Per_Person_tb per,
            Unt_Unit_tb unt,
            Usr_User_tb usr,
            Unt_Unit_tb unt2
        where uap.per_id_person = per.per_id
            and unt.unt_id = uap.unt_id
            and usr.per_id_person = per.per_id
            and unt2.unt_id = usr.unt_id_unit
            and uap.uap_active_flag = 1
            and uap.tax_id_type = 1068
            and unt.unt_active_flag = 1
            and usr.usr_active_flag = 1) as uap on uap.unt_id = unt.unt_id
where unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    and unt.unt_active_flag = 1",
dbo,SuccessFactors_history_view,2017-06-02 11:42:00.573,2017-06-14 10:11:41.920,"CREATE VIEW SuccessFactors_history_view
AS 
SELECT
    usr.usr_employee_id as STUD_ID,
    'HISTORICAL' as CPNT_TYP_ID,
    reg.out_id_outcome as CPNT_ID,
    'HISTORICAL_COMPLETE' as CMPL_STAT_ID,
    dbo.knlPortalServices_formatDatetimeSuccessFactors(
    dbo.knlPortalServices_getEndDateByOutId(reg.out_id_outcome)
    ) as COMPL_DTE,
   100 as GRADE,
   dbo.knlPortalServices_getDurationByOutId(reg.out_id_outcome) as CONTACT_HRS,
   isNull(
   dbo.knlPortalServices_isEmpty(
   dbo.knlPortalServices_getExternalFacilitatorsByOutId(reg.out_id_outcome)
   ),'KNLSystem_Instructor') as INST_NAME
FROM
	REU_REGISTRATION_USER_TB REU,
	REG_REGISTRATION_TB REG ,
	USR_USER_TB USR,
	PER_PERSON_TB PER 
WHERE
	REU.REG_ID = REG.REG_ID AND
	REU.USR_ID = USR.USR_ID AND
	USR.PER_ID_PERSON = PER.PER_ID AND
	REG.REG_DELETED_FLAG=0 and reg.reg_deleted_date is null",
dbo,SuccessFactors_history_view_vw,2017-06-14 14:50:07.563,2017-06-14 15:03:36.883,"CREATE view dbo.SuccessFactors_history_view_vw
as
SELECT
    REG_ID,
	STUD_ID,
	CPNT_TYP_ID,
	CPNT_ID,
	CMPL_STAT_ID,
	dbo.knlPortalServices_formatDatetimeSuccessFactors( COMPL_DTE ) AS COMPL_DTE,
	GRADE,
	CONTACT_HRS,
	INST_NAME 
FROM
	SUCCESS_FACTORS_HISTORY_TB",
dbo,SuccessFactors_Items_view,2017-05-31 12:51:29.330,2017-12-28 13:02:44.630,"CREATE VIEW [dbo].[SuccessFactors_Items_view]
AS 
SELECT
    OUT.OUT_ID     AS  CPNT_ID,
    'HISTORY'   AS  CPNT_TYP_ID,
    dbo.knlPortalServices_formatDatetimeSuccessFactors(dbo.knlPortalServices_getStartDateByOutId(out.out_id)) as REV_DTE,
    'PUBLIC' as DMN_ID,
    'Y' as NOTACTIVE,
    left(
replace( replace(replace(out.out_name,'|','-') , '''','-'),'""','-') ,300) as CPNT_TITLE,
    'KNL Legacy System' as DEL_MTH_ID,
    left(
    replace(
    replace(
    replace(cast(out.out_id as varchar)+','+dbo.knlPortalServices_getModalityForLPi18n(out.out_modality,1) 
    +','+dbo.knlPortalServices_getOpsActivityCodeByOpsIdOpus(out.ops_id_opus)
    +','+dbo.knlPortalServices_getPresentationType(out.tax_id_presentation_type,1)
    +','+dbo.knlPortalServices_getLocationCityByLocId(out.loc_id_location)
    +','+dbo.knlPortalServices_getTopicsByOutId(out.out_id),'|','-'),'''','-'),'""','-')

,4000)  as CPNT_DESC,
    'HISTORICAL_COMPLETE' as CMPL_STAT_ID,
    'LEGACY' as CPNT_SRC_ID,
    dbo.knlPortalServices_getDurationByOutId(out.out_id) as CONTACT_HRS,
    dbo.knlPortalServices_getStartDateByOutId(out.out_id) as START_DATE
	
FROM
	OUT_OUTCOME_TB OUT
WHERE
	
	OUT.OUT_DELETED_FLAG=0 AND
	OUT.OUT_DELETED_DATE IS NULL AND
    dbo.knlPortalServices_getStartDateByOutId(out.out_id) <= getDate()",
dbo,TAL_TIME_AND_LABOR_VW,2017-11-28 12:03:10.557,2017-11-28 12:03:10.557,"CREATE VIEW [dbo].[TAL_TIME_AND_LABOR_VW]
AS
SELECT
--   dbo.knlPortalServices_getSrvTypeByOutId(OUT1.out_id),
--   dbo.knlPortalServices_getEvtTypeByOutId (OUT1.out_id),
  OUT1.out_id,
  usr.usr_employee_id                                          AS employee_id,
  DBO.KNLPORTALSERVICES_GETENDDATEBYOUTID(REG.OUT_ID_OUTCOME)  AS date,
  REG.reg_created_date                                         AS created_date,
  op.ops_activity_code                                         AS opus_code,
  op.ops_wbs_element                                           AS wbs_code,
  '0100'                                                       AS fund,
  USR.usr_type                                                 AS employee_type,
  dbo.knlPortalServices_getDepNameByUntId(usr.unt_id_unit)     AS employee_department,
  reg.reg_participation_type                                   AS attendance_type,
  DBO.KNLPORTALSERVICES_GETDURATIONBYOUTID(REG.OUT_ID_OUTCOME) AS hours
FROM
  REU_REGISTRATION_USER_TB REU,
  REG_REGISTRATION_TB REG,
  USR_USER_TB USR,
  PER_PERSON_TB PER,
  Out_Outcome_tb OUT1
  LEFT JOIN
  Ops_opus_tb op ON OUT1.ops_id_opus = op.ops_id
WHERE
  REU.REG_ID = REG.REG_ID AND
  REG.out_id_outcome = OUT1.OUT_ID AND
  REU.USR_ID = USR.USR_ID AND
  USR.PER_ID_PERSON = PER.PER_ID AND
  REG.REG_DELETED_FLAG = 0 AND reg.reg_deleted_date IS NULL
  AND dbo.knlPortalServices_getEvtTypeByOutId (OUT1.out_id) !='EVT_LANGUAGE'
 AND dbo.knlPortalServices_getSrvTypeByOutId(OUT1.out_id) !='SRV_LANGUAGE'",
dbo,TAL_TIME_AND_LABOR_VW_OLD,2017-07-28 14:23:31.270,2017-07-28 14:23:31.270,"CREATE VIEW [dbo].[TAL_TIME_AND_LABOR_VW_OLD]
AS 
			select 
                out.out_id,
                CASE WHEN reg.reg_type = 'REG_SERVICE_INDIVIDUAL_LANGUAGE' THEN usrStaff2.usr_employee_id ELSE usrStaff.usr_employee_id END as employee_id,
                COALESCE(evt.evt_start_date,srv.srv_end_date,ext.ext_start_date) as date,
                reg.reg_created_date as created_date,
                op.ops_activity_code as opus_code,
                op.ops_wbs_element as wbs_code,
                '0100' as fund,
                CASE WHEN reg.reg_type = 'REG_SERVICE_INDIVIDUAL_LANGUAGE' THEN usrStaff2.usr_type ELSE usrStaff.usr_type END as employee_type,
                CASE WHEN reg.reg_type = 'REG_SERVICE_INDIVIDUAL_LANGUAGE' THEN dep2.dep_name ELSE dep.dep_name END as employee_department,
                reg.reg_participation_type as attendance_type,
                COALESCE(evt.evt_total_duration,srv.srv_total_duration,ext.ext_duration) as hours
               
			from
				Reg_Registration_tb reg LEFT JOIN
				Reu_Registration_User_tb reu ON reg.reg_id = reu.reg_id LEFT JOIN 
                Rsl_Service_Individual_Language_tb rsl ON reg.reg_id = rsl.reg_id LEFT JOIN 
				Usr_User_tb usrStaff ON reu.usr_id = usrStaff.usr_id LEFT JOIN
                Usr_User_tb usrStaff2 ON rsl.usr_id_user = usrStaff2.usr_id LEFT JOIN
				Per_Person_tb perStaff ON perStaff.per_id = usrStaff.per_id_person LEFT JOIN
                Per_Person_tb perStaff2 ON perStaff2.per_id = usrStaff2.per_id_person LEFT JOIN
				Out_Outcome_tb out ON out.out_id = reg.out_id_outcome LEFT JOIN
                Unt_Unit_tb unt ON unt.unt_id = usrStaff.unt_id_unit LEFT JOIN
                Dep_Department_tb dep ON dep.dep_id = unt.dep_id_department LEFT JOIN
                Unt_Unit_tb unt2 ON unt2.unt_id = usrStaff2.unt_id_unit LEFT JOIN
                Dep_Department_tb dep2 ON dep2.dep_id = unt2.dep_id_department LEFT JOIN
                Evt_Event_tb evt ON out.out_id = evt.out_id LEFT JOIN
                Ext_External_Event_tb ext ON out.out_id = ext.out_id LEFT JOIN
                Srv_Service_tb srv ON out.out_id = srv.out_id LEFT JOIN
                Ops_opus_tb op ON out.ops_id_opus = op.ops_id
			where
				reg.reg_deleted_flag = 0 and
                out.out_deleted_flag = 0 and
                reg.reg_type != 'REG_GUEST' and
                COALESCE(evt.evt_end_date,srv.srv_end_date,ext.ext_end_date) < getDate() and
                reg.reg_showup_flag = 1 and
                reg.reg_flow_status_code = 'REG_SUPERVISOR_APPROVED'",
dbo,TCL_Ticket_Closed_vw,2015-06-16 10:28:58.867,2015-06-16 10:45:06.497,"CREATE VIEW [dbo].[TCL_Ticket_Closed_vw]
AS 
select tck.tck_id as Tck_ID,
			    tal2.tal_description as Ticket_Priority,
                tig.tig_description as Ticket_Group,
			    tal1.tal_description as Ticket_Class,
			    tck.tck_subject as Ticket_Subject,
			    tck.tck_status as Ticket_Status,
				dbo.udf_StripHTML(tth.tth_description) as Description,
                per1.per_first_name + ' ' + per1.per_last_name as Ticket_creator,
			    tck.tck_created_date as Ticket_Created_Date,
			    per2.per_first_name + ' ' + per2.per_last_name as Ticket_Assigner,
			    tck.tck_assigned_date as Ticket_Assigned_Date,
			    per3.per_first_name + ' ' + per3.per_last_name as Ticket_Assigned,
                tck.tck_closed_date as Ticket_Closed_Date,
                per4.per_first_name + ' ' + per4.per_last_name as Ticket_Closer,
                (tck.tck_duration / 60) as duration_hours
			from Tck_Ticket_tb tck,
			    Tig_Ticket_Group_tb tig,
				Tth_Ticket_Thread_tb tth,
                Tal_Taxonomy_Language_tb tal1,
                Tal_Taxonomy_Language_tb tal2,
                Per_Person_tb per1,
                Per_Person_tb per2,
                Per_Person_tb per3,
                Per_Person_tb per4
			where tck.tck_status = 'TCK_CLOSED'
			    and tck.tig_id = tig.tig_id
				and tck.tck_id = tth.tck_id_ticket
				and tth.tth_order = 0
                and tal1.tax_id = tck.tax_id_class
                and tal2.tax_id = tck.tax_id_priority
                and tal1.lng_id = 1
                and tal2.lng_id = 1
                and per1.per_id = tck.per_id_creator
                and per2.per_id = tck.per_id_assigner
                and per3.per_id = tck.per_id_assigned
                and per4.per_id = tck.per_id_closer
                and year(tck.tck_closed_date) = year(getDate())",
dbo,TOG_Ticket_OnGoing_vw,2015-06-16 10:25:04.543,2015-06-16 10:36:00.953,"CREATE VIEW [dbo].[TOG_Ticket_OnGoing_vw]
AS 
select tck.tck_id as Tck_ID,
			    tal2.tal_description as Ticket_Priority,
                tig.tig_description as Ticket_Group,
			    tal1.tal_description as Ticket_Class,
			    tck.tck_subject as Ticket_Subject,
			    tck.tck_status as Ticket_Status,
				dbo.udf_StripHTML(tth.tth_description) as Description,
                per1.per_first_name + ' ' + per1.per_last_name as Ticket_creator,
			    tck.tck_created_date as Ticket_Created_Date,
			    (select p.per_first_name + ' ' + p.per_last_name from Per_Person_tb p where p.per_id = tck.per_id_assigner) as Ticket_Assigner,
			    tck.tck_assigned_date as Ticket_Assigned_Date,
			    (select p.per_first_name + ' ' + p.per_last_name from Per_Person_tb p where p.per_id = tck.per_id_assigned) as Ticket_Assigned
			from Tck_Ticket_tb tck,
			    Tig_Ticket_Group_tb tig,
				Tth_Ticket_Thread_tb tth,
                Tal_Taxonomy_Language_tb tal1,
                Tal_Taxonomy_Language_tb tal2,
                Per_Person_tb per1
			where tck.tck_status != 'TCK_CLOSED'
			    and tck.tig_id = tig.tig_id
				and tck.tck_id = tth.tck_id_ticket
				and tth.tth_order = 0
                and tal1.tax_id = tck.tax_id_class
                and tal2.tax_id = tck.tax_id_priority
                and tal1.lng_id = 1
                and tal2.lng_id = 1
                and per1.per_id = tck.per_id_creator",
dbo,UCV_UNIT_COORDINATORS_VW,2015-08-18 10:24:12.260,2015-08-18 14:22:56.637,"CREATE VIEW [dbo].[UCV_UNIT_COORDINATORS_VW]
AS 
SELECT sec.sec_name, dep.dep_name, unt.unt_name, uap.unt_id, unt.unt_active_date,
    uap.contactName, uap.contactUserName, uap.contactUnit, uap.contactType
FROM Dep_Department_tb dep,
    Sec_Section_tb sec,
    Unt_Unit_tb unt left outer join 
        (select unt.unt_id,
            per.per_first_name + ' '+ isNull(per.per_middle_name,'') + ' ' + per.per_last_name as contactName, 
            usr.usr_pcmail as contactUserName, usr.usr_title as contactTitle, unt2.unt_name as contactUnit, 
            case when uap.uap_person_type = 0 then 'No Contact (Only KnlSystem Access)'
                 when uap.uap_person_type = 1 then 'Business Partner Senior'
                 when uap.uap_person_type = 2 then 'Business Partner Junior'
                 when uap.uap_person_type = 3 then 'Coordinator Contact 1'
                 when uap.uap_person_type = 4 then 'Coordinator Contact 2'
                 when uap.uap_person_type = 5 then 'Coordinator Contact (For more than two coordinators)'
            end as contactType
        from Uap_Unit_Assigned_Person_tb uap,
            Per_Person_tb per,
            Unt_Unit_tb unt,
            Usr_User_tb usr,
            Unt_Unit_tb unt2
        where uap.per_id_person = per.per_id
            and unt.unt_id = uap.unt_id
            and usr.per_id_person = per.per_id
            and unt2.unt_id = usr.unt_id_unit
            and uap.uap_active_flag = 1
            and uap.tax_id_type = 74
            and unt.unt_active_flag = 1
            and usr.usr_active_flag = 1) as uap on uap.unt_id = unt.unt_id
where unt.dep_id_department = dep.dep_id
    and dep.sec_id_section = sec.sec_id
    and unt.unt_active_flag = 1",
dbo,USR_ACTIVE_EMPLOYEES_VW,2013-03-01 15:08:36.670,2016-03-28 10:49:59.683,"CREATE VIEW [dbo].[USR_ACTIVE_EMPLOYEES_VW]
AS 
select u.usr_id, u.usr_employee_id, u.usr_pcmail, unt.unt_name, unt.unt_id, dep.dep_name, dep.dep_id, 
    p.per_first_name, p.per_middle_name, p.per_last_name, 
    p.per_first_name + case when p.per_middle_name = '' or p.per_middle_name is null then ' ' else ' ' + p.per_middle_name + ' ' end + p.per_last_name as complete_name,
    u.usr_type, u.usr_entry_date, u.usr_work_location, u.usr_title, u.usr_career_track, u.usr_career_path, u.usr_work_role, u.usr_contract_type,
    (select p2.per_first_name + ' ' + p2.per_last_name from per_person_tb p2 where p2.per_id = u.per_id_supervisor) as supervisor,
    p.per_id, p.per_email, sec.sec_name
from Usr_User_tb u,
    Per_Person_tb p,
    Unt_Unit_tb unt,
    Dep_Department_tb dep,
    Sec_Section_tb sec
where u.per_id_person = p.per_id
    and unt.unt_id = u.unt_id_unit
    and unt.dep_id_department  = dep.dep_id
    and u.usr_active_flag = 1
    and sec.sec_id = dep.sec_id_section
    and p.per_type = 'U'",
dbo,vw_data_registration,2017-07-19 13:30:04.630,2017-07-19 13:30:04.630,"create view vw_data_registration as
select 
				AAO.kna_id_activity, act.depName, act.unit, act.yea_year, act.kpd_id,
			    act.componentType, act.deliverableName, act.activityName, 
			    a.OUT_ID, a.NAME, a.OBJECTIVES, a.COMMENTS, a.MODALITY, a.PRESENTATION_TYPE, a.SUBJECT_TYPE, a.OPUS_CODE, a.OUT_CREATED_DATE, a.OUT_CREATOR, a.OUT_DELETED_DATE, a.OUT_DELETOR,
			    a.PUBLISHED_DATE, a.OUT_TYPE, a.LOCATION_NAME, a.LOCATION_TYPE, a.LOCATION_CITY, a.LOCATION_COUNTRY, a.OUT_STATUS_CODE, a.BUDGET_STATUS_CODE, a.BUDGET_OFFICER_CLOSED_DATE,
			    a.CLOSER, a.LOGISTICS_FLAG, a.START_DATE, DATENAME(month, case when a.START_DATE is null then a.OUT_CREATED_DATE else a.START_DATE end) AS START_DATE_MONTH,
			    a.END_DATE, DATENAME(month, case when a.END_DATE is null then a.OUT_CREATED_DATE else a.END_DATE end) AS END_DATE_MONTH,
			    a.DEADLINE, a.MAX_PARTICIPANTS, a.PRIVATE_REGISTRATION, a.TOTAL_DURATION, 
			    CASE WHEN a.total_duration >= 0 AND a.total_duration < 4 THEN '0 - 3.99'
			         WHEN a.total_duration  >=4 AND a.total_duration < 24 THEN '4 - 23.99'
			         WHEN a.total_duration >=24 THEN '>= 24'
			    END AS DURATION_TYPE,
			    a.ONLINE_FLAG, a.FLOW_CODE, a.TEACHER, a.MOODLE_ID, a.SERVICE_ACTIVE_FLAG,
			    a.REG_ID, DATENAME(month,a.REG_CREATED_DATE) AS REGISTRATION_MONTH, a.REG_CREATED_DATE,
			    a.REGISTRATOR, a.SHOWUP_FLAG, a.REG_DELETED_DATE, a.REG_DELETOR, a.PARTICIPATION_TYPE, a.REG_STATUS_CODE,
			    a.FIRST_NAME, a.MIDDLE_NAME, a.LAST_NAME, a.first_name + ' ' + isnull(a.middle_name,'') + ' ' + a.last_name AS EMPLOYEE_NAME,
			    a.EMAIL, a.PCMAIL, a.EMPLOYEE_ID, a.LEFT_DATE, a.EMPLOYEE_TYPE, a.CAREER_TRACK, a.CAREER_PATH, a.WORK_ROLE, a.WORK_LOCATION, a.WORK_COUNTRY,
			    a.TITLE, a.GUEST_INSTITUTION, a.GUEST_INSTITUTION_TYPE, a.GUEST_COUNTRY, a.SUPERVISOR, a.UNIT unit2, a.DEPARTMENT, a.REG_TYPE,
			    case when substring(a.UNIT,5,1) = 'C' and a.WORK_COUNTRY <> 'USA' then substring(a.UNIT,6,2)
			         else a.WORK_COUNTRY 
			    END as COF_COUNTRY,
			    (SELECT DEP.dep_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT,
			    (SELECT UNT.unt_name FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT,
			    (SELECT USR2.usr_title FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TITLE,
			    (SELECT P.per_first_name +' '+ P.per_last_name FROM Per_Person_tb P, Usr_User_tb USR2 WHERE P.per_id = USR2.per_id_supervisor AND USR2.USR_ID = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_SUPERVISOR,
			    (SELECT USR2.usr_type FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_EMPLOYEE_TYPE,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'HQ' ELSE 'COF' END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_LOCATION,
			    (SELECT CASE WHEN USR2.usr_work_location = 'HQ' THEN 'USA' ELSE USR2.USR_WORK_LOCATION END FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_COUNTRY,
			    (SELECT USR2.usr_career_track FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_TRACK,
			    (SELECT USR2.usr_career_path FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_CAREER_PATH,
			    (SELECT USR2.usr_work_role FROM USR_USER_TB USR2 WHERE USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL  ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_WORK_ROLE,
			    1 as DATA_COUNT,
    			7 AS DATA_MONTH,
				2017 AS DATA_YEAR,
				getdate() as DATA_CREATED_DATE,
			    A.UNIT_ID,
			    A.DEPT_ID,
			    act.depId  AS plan_dept_id,
			    act.unitId AS plan_unit_id,
			    (SELECT DEP.dep_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT, Dep_Department_tb DEP WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND UNT.dep_id_department = DEP.dep_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_DEPT_ID,
			    (SELECT UNT.unt_id FROM USR_USER_TB USR2, Unt_Unit_tb UNT WHERE USR2.UNT_ID_UNIT = UNT.unt_id AND USR2.usr_id = (SELECT TOP 1 USR.usr_id FROM Usr_User_tb USR WHERE USR.usr_pcmail = A.PCMAIL ORDER BY isnull(usr.usr_left_date,getdate()) DESC)) AS ACTUAL_UNIT_ID
			from (
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE, NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR  AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, NULL AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID,  NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE, R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE, R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0, 0,  R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_GENERAL_EVENT_VW O,
			    REG_GUEST_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, O.TEACHER, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_GROUP_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, O.LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, O.DEADLINE, O.MAX_PARTICIPANTS, O.REGISTRATION_COFINANCING, O.REGISTRATION_FEE, O.PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, O.ONLINE_FLAG, O.FLOW_CODE, NULL, O.MOODLE_ID, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL, NULL, NULL AS EMPLOYEE_ID, NULL AS LEFT_DATE, 'GUEST' AS EMPLOYEE_TYPE, NULL AS CAREER_TRACK, NULL AS CAREER_PATH, NULL AS WORK_ROLE,
			    NULL AS WORK_LOCATION, NULL AS WORK_COUNTRY, R.TITLE,  R.INSTITUTION as GUEST_INSTITUTION, R.INSTITUTION_TYPE AS GUEST_INSTITUTION_TYPE,  R.COUNTRY AS GUEST_COUNTRY,
			    NULL AS PAYMENT_TYPE, NULL AS GRADE, NULL AS SUPERVISOR, 'GUEST' AS UNIT, 'GUEST' AS DEPARTMENT, 0,0, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_MOODLE_EVENT_VW O,
			    REG_GUEST_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, 
			    O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, NULL,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_EXTERNAL_EVENT_VW O,
			    REG_REGISTRATION_USER_VW R  
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    O.TOTAL_DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_GENERAL_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL as LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL as DEADLINE, NULL as MAX_PARTICIPANTS, NULL as REGISTRATION_COFINANCING, NULL as REGISTRATION_FEE, NULL as PRIVATE_REGISTRATION,
			    O.TOTAL_DURATION, NULL as ONLINE_FLAG, NULL as FLOW_CODE, NULL as TEACHER, O.MOODLE_ID, O.ACTIVE_FLAG as SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_MOODLE_SERVICE_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE AS OUT_CREATED_DATE, O.CREATOR AS OUT_CREATOR, O.DELETED_DATE  AS OUT_DELETED_DATE, O.DELETOR AS OUT_DELETOR, 
			    O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE AS OUT_STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL AS LOGISTICS_FLAG, O.START_DATE,
			    O.END_DATE, NULL AS DEADLINE, NULL AS MAX_PARTICIPANTS, NULL AS REGISTRATION_COFINANCING, NULL AS REGISTRATION_FEE, NULL AS PRIVATE_REGISTRATION, 
			    O.TOTAL_DURATION, NULL AS ONLINE_FLAG, NULL AS FLOW_CODE, NULL AS TEACHER, NULL AS MOODLE_ID, O.ACTIVE_FLAG AS SERVICE_ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE as REG_CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE AS REG_DELETED_DATE, R.DELETOR AS REG_DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE AS REG_STATUS_CODE
			FROM OUT_COLLABORATIVE_LEARNING_VW O,
			    REG_REGISTRATION_USER_VW R 
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
			UNION ALL
			SELECT O.OUT_ID, O.NAME, O.OBJECTIVES, O.COMMENTS, O.MODALITY, O.PRESENTATION_TYPE, O.SUBJECT_TYPE, O.OPUS_CODE,
			    O.CREATED_DATE, O.CREATOR, O.DELETED_DATE, O.DELETOR, O.PUBLISHED_DATE, O.OUT_TYPE, O.LOCATION_NAME, O.LOCATION_TYPE, O.LOCATION_CITY, O.LOCATION_COUNTRY,
			    O.STATUS_CODE, O.BUDGET_STATUS_CODE, O.BUDGET_OFFICER_CLOSED_DATE, O.CLOSER, NULL, O.START_DATE,
			    O.END_DATE, NULL, NULL, NULL, NULL, NULL,
			    R.DURATION, NULL, NULL, NULL, NULL, O.ACTIVE_FLAG,
			    R.REG_ID, R.FIRST_NAME, R.MIDDLE_NAME, R.LAST_NAME, R.EMAIL,R.PCMAIL, R.EMPLOYEE_ID, R.LEFT_DATE, R.EMPLOYEE_TYPE, R.CAREER_TRACK, R.CAREER_PATH, R.WORK_ROLE,
			    R.WORK_LOCATION, R.WORK_COUNTRY, R.TITLE,  NULL as GUEST_INSTITUTION, NULL AS GUEST_INSTITUTION_TYPE, NULL AS GUEST_COUNTRY,
			    R.PAYMENT_TYPE, R.GRADE, R.SUPERVISOR, R.UNIT, R.DEPARTMENT, R.UNIT_ID, R.DEPT_ID, R.CREATED_DATE,
			    R.REGISTRATOR, R.COFINANCING_AMOUNT, R.FEE_AMOUNT, R.SHOWUP_FLAG, R.DELETED_DATE, R.DELETOR,
			    R.PARTICIPATION_TYPE, R.REG_TYPE, R.STATUS_CODE
			FROM OUT_LANGUAGE_SERVICE_VW O,
			    REG_LANGUAGE_USER_VW R
			WHERE R.OUT_ID = O.OUT_ID
			    AND YEAR(O.END_DATE) = 2017
				) a LEFT OUTER JOIN Aao_Available_Activity_Outcome_tb aao ON aao.out_id_outcome = a.OUT_ID LEFT OUTER JOIN ACT_ACTIVITIES_VW act ON act.activityID = aao.kna_id_activity",
dbo,vw_rej_records_jobs_execute,2016-07-07 17:13:45.183,2016-07-07 17:13:45.183,"
create  view vw_rej_records_jobs_execute as
select dbo.Rej_Records_Jobs.* from dbo.Rej_Records_Jobs 
where id_records_job in 
(select tbl1.id_records_job from (select MAX(id_records_job) id_records_job, caj_id_job FROM dbo.Rej_Records_Jobs GROUP by  caj_id_job) tbl1)",
dbo,YDA_YEAR_DEPARTMENT_ALLOCATION_VW,2014-09-26 11:30:27.650,2014-12-09 09:46:49.730,"CREATE VIEW [dbo].[YDA_YEAR_DEPARTMENT_ALLOCATION_VW]
AS 
select kpa.yea_year AS YEAR, dep.dep_name AS DEPARTMENT, 
    kai.kai_amount AS AMOUNT, kai.kai_comment AS COMMENT, 
    per.per_first_name + ' ' + per.per_last_name AS CREATOR, 
    kai.kai_created_date AS CREATED_DATE,
    kai.kai_component AS COMPONENT,
    kai.kai_entry_date AS ENTRY_DATE,
    kai.kai_updated_date AS UPDATED_DATE, 
    ops.ops_activity_code AS OPUS_CODE,
    kai.kai_allocation_type AS ALLOCATION_TYPE
from Kai_Knl_Plan_Allocation_Item_tb kai
    inner join Kpa_Knl_Plan_Allocation_tb kpa on kpa.kpa_id = kai.kpa_id_allocation
    inner join Dep_Department_tb dep on kpa.dep_id_department = dep.dep_id
    inner join Per_Person_tb per on per.per_id = kai.per_id_creator
    left outer join Ops_Opus_tb ops on ops.ops_id = kai.ops_id",
